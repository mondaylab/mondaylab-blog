(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{612:function(t,s,a){"use strict";a.r(s);var n=a(13),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"å‰è¨€"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å‰è¨€"}},[t._v("#")]),t._v(" å‰è¨€")]),t._v(" "),a("p",[t._v("ä¼—æ‰€å‘¨çŸ¥ï¼Œåœ¨å‰ç«¯çš„é¢è¯•ä¸­ï¼Œé¢è¯•å®˜éå¸¸çˆ±è€ƒ vdom å’Œ diff ç®—æ³•ã€‚æ¯”å¦‚ï¼Œå¯èƒ½ä¼šå‡ºç°åœ¨ä»¥ä¸‹åœºæ™¯ ğŸ¤")]),t._v(" "),a("p",[t._v("æ»´æ»´æ»´ï¼Œé¢è¯•å®˜å‘æ¥ä¸€ä¸ªé¢è¯•é‚€è¯·ã€‚æ¥å—é‚€è¯· ğŸ“")]),t._v(" "),a("p",[t._v("ğŸ§‘ é¢è¯•å®˜ï¼šä½ çŸ¥é“ "),a("code",[t._v("key")]),t._v(" çš„ä½œç”¨å—ï¼Ÿ")]),t._v(" "),a("p",[t._v("ğŸ™ æˆ‘ï¼š"),a("code",[t._v("key")]),t._v(" çš„ä½œç”¨æ˜¯ä¿è¯æ•°æ®çš„å”¯ä¸€æ€§ã€‚")]),t._v(" "),a("p",[t._v("ğŸ§‘ é¢è¯•å®˜ï¼šæ€ä¹ˆä¿è¯æ•°æ®çš„å”¯ä¸€æ€§ï¼Ÿ")]),t._v(" "),a("p",[t._v("ğŸ™ æˆ‘ï¼šå°±....")]),t._v(" "),a("p",[t._v("ğŸ§‘ é¢è¯•å®˜ï¼šä½ çŸ¥é“è™šæ‹Ÿ dom å—ï¼Ÿ")]),t._v(" "),a("p",[t._v("ğŸ™ æˆ‘ï¼šè™šæ‹Ÿ dom å°±æ˜¯â€¦â€¦balabala")]),t._v(" "),a("p",[t._v("ğŸ§‘ é¢è¯•å®˜ï¼šï¼ˆå¥½åƒæœ‰ç‚¹é“ç†ï¼‰é‚£ä½ çŸ¥é“ diff ç®—æ³•å—ï¼Ÿ")]),t._v(" "),a("p",[t._v("ğŸ™ æˆ‘ï¼šï¼ˆå¿ƒé‡Œï¼šwhatâ€¦â€¦diff ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿï¼‰")]),t._v(" "),a("p",[t._v("ğŸ§‘ é¢è¯•å®˜ï¼šæœ¬æ¬¡é¢è¯•ç»“æŸï¼Œå›å»ç­‰é¢è¯•ç»“æœé€šçŸ¥ã€‚")]),t._v(" "),a("p",[t._v("ğŸ™‹ğŸ™‹ğŸ™‹")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ "),a("code",[t._v("key")]),t._v(" çš„ä½œç”¨åœ¨å‰ç«¯çš„é¢è¯•æ˜¯ä¸€é“å¾ˆæ™®éçš„é¢˜ç›®ï¼Œä½†æ˜¯å‘¢ï¼Œå¾ˆå¤šæ—¶å€™æˆ‘ä»¬éƒ½åªæµ®äºçŸ¥è¯†çš„è¡¨é¢ï¼Œè€Œæ²¡æœ‰å»æ·±æŒ–å…¶åŸç†æ‰€åœ¨ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„ç«äº‰åŠ›å°±åœ¨è¿™è¢«æ‹‰ä¸‹äº†ã€‚æ‰€ä»¥å‘¢ï¼Œæ·±å…¥å­¦ä¹ åŸç†å¯¹äºæå‡è‡ªèº«çš„æ ¸å¿ƒç«äº‰åŠ›æ˜¯ä¸€ä¸ªå¿…ä¸å¯å°‘çš„è¿‡ç¨‹ã€‚")]),t._v(" "),a("p",[t._v("åœ¨æ¥ä¸‹æ¥çš„è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†è®²è§£é¢è¯•ä¸­å¾ˆçˆ±è€ƒçš„è™šæ‹Ÿ DOM ä»¥åŠå…¶èƒŒåçš„ diff ç®—æ³•ã€‚")]),t._v(" "),a("h1",{attrs:{id:"ä¸€ã€è™šæ‹Ÿ-dom-vitual-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€è™šæ‹Ÿ-dom-vitual-dom"}},[t._v("#")]),t._v(" ä¸€ã€è™šæ‹Ÿ DOMï¼ˆVitual DOMï¼‰")]),t._v(" "),a("h2",{attrs:{id:"_1ã€è™šæ‹Ÿ-dom-vitual-dom-å’Œ-diff-çš„å…³ç³»"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€è™šæ‹Ÿ-dom-vitual-dom-å’Œ-diff-çš„å…³ç³»"}},[t._v("#")]),t._v(" 1ã€è™šæ‹Ÿ DOMï¼ˆVitual DOMï¼‰å’Œ diff çš„å…³ç³»")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬éƒ½çŸ¥é“ "),a("code",[t._v("DOM")]),t._v(" æ“ä½œæ˜¯éå¸¸è€—è´¹æ€§èƒ½çš„ï¼Œæ—©æœŸæˆ‘ä»¬ç”¨ "),a("code",[t._v("JQuery")]),t._v(" æ¥è‡ªè¡Œæ§åˆ¶ "),a("code",[t._v("DOM")]),t._v(" æ“ä½œçš„æ—¶æœºï¼Œä¹Ÿå°±æ˜¯æ‰‹åŠ¨è°ƒæ•´ï¼Œè¿™æ ·å­å…¶å®ä¹Ÿä¸æ˜¯ç‰¹åˆ«æ–¹ä¾¿ã€‚å› æ­¤å°±å‡ºç°äº†è™šæ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" ï¼Œå³ "),a("code",[t._v("Vitual DOM")]),t._v(" ï¼ˆä¸‹æ–‡ç®€ç§°ä¸º "),a("code",[t._v("vdom")]),t._v(" ï¼‰ï¼Œæ¥è§£å†³ "),a("code",[t._v("DOM")]),t._v(" æ“ä½œçš„é—®é¢˜ã€‚ "),a("code",[t._v("vdom")]),t._v(" æ˜¯ç°å¦‚ä»Šçš„ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼Œä¹Ÿæ˜¯é¢è¯•ä¸­çš„çƒ­é—¨è¯é¢˜ï¼ŒåŸºæœ¬ä¸Šåœ¨å‰ç«¯çš„é¢è¯•ä¸­éƒ½ä¼šé—®åˆ° "),a("code",[t._v("è™šæ‹ŸDOM")]),t._v(" çš„é—®é¢˜ã€‚")]),t._v(" "),a("p",[t._v("è€Œä¸ºä»€ä¹ˆä¼šé—®åˆ° "),a("code",[t._v("vdom")]),t._v(" çš„é—®é¢˜å‘¢ï¼ŒåŸå› åœ¨äºç°åœ¨æµè¡Œçš„ "),a("code",[t._v("vue")]),t._v(" å’Œ "),a("code",[t._v("react")]),t._v(" æ¡†æ¶ï¼Œéƒ½æ˜¯æ•°æ®é©±åŠ¨è§†å›¾ï¼Œå¹¶ä¸”æ˜¯åŸºäº "),a("code",[t._v("vdom")]),t._v(" å®ç°çš„ï¼Œå¯ä»¥è¯´ "),a("code",[t._v("vdom")]),t._v(" æ˜¯å®ç° "),a("code",[t._v("vue")]),t._v(" å’Œ "),a("code",[t._v("react")]),t._v(" çš„é‡è¦åŸºçŸ³ã€‚")]),t._v(" "),a("p",[t._v("è°ˆåˆ° "),a("code",[t._v("vdom")]),t._v(" ï¼Œæˆ‘ä»¬ä¸æ˜è§‰å‰çš„è¿˜ä¼šæƒ³åˆ° "),a("strong",[t._v("diff ç®—æ³•")]),t._v(" ã€‚é‚£ "),a("strong",[t._v("diff ç®—æ³•")]),t._v(" å’Œ "),a("strong",[t._v("vdom")]),t._v(" æ˜¯ä»€ä¹ˆå…³ç³»å‘¢ï¼Ÿ")]),t._v(" "),a("p",[t._v("å…¶å®ï¼Œ "),a("code",[t._v("vdom")]),t._v(" æ˜¯ä¸€ä¸ªå¤§çš„æ¦‚å¿µï¼Œè€Œ "),a("code",[t._v("diffç®—æ³•")]),t._v(" æ˜¯ "),a("code",[t._v("vdom")]),t._v(" çš„ä¸€éƒ¨åˆ†ï¼Œ "),a("code",[t._v("vdom")]),t._v(" çš„æ ¸å¿ƒä»·å€¼åœ¨äº"),a("strong",[t._v("æœ€å¤§ç¨‹åº¦çš„å‡å°‘ DOM çš„ä½¿ç”¨èŒƒå›´")]),t._v("ï¼Œ "),a("code",[t._v("vdom")]),t._v(" é€šè¿‡æŠŠ "),a("code",[t._v("DOM")]),t._v(" "),a("strong",[t._v("ç”¨ JS çš„æ–¹å¼")]),t._v("è¿›è¡Œæ¨¡æ‹Ÿï¼Œä¹‹åè¿›è¡Œè®¡ç®—å’Œå¯¹æ¯”ï¼Œæœ€åæ‰¾å‡ºæœ€å°çš„æ›´æ–°èŒƒå›´å»æ›´æ–°ã€‚é‚£ä¹ˆè¿™ä¸ªå¯¹æ¯”çš„è¿‡ç¨‹å°±æ˜¯ "),a("strong",[t._v("diff ç®—æ³•")]),t._v(" ã€‚ä¹Ÿå°±æ˜¯è¯´ä»–ä»¬ä¸¤è€…æ˜¯"),a("strong",[t._v("åŒ…å«å…³ç³»")]),t._v("ï¼Œ"),a("strong",[t._v("å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605140824982.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic_center",alt:"vdomå’Œdiffç®—æ³•"}})]),t._v(" "),a("p",[t._v("å¯ä»¥è¯´ï¼Œdiff ç®—æ³•æ˜¯ "),a("code",[t._v("vdom")]),t._v(" ä¸­æœ€æ ¸å¿ƒã€æœ€å…³é”®çš„éƒ¨åˆ†ï¼Œæ•´ä¸ª "),a("code",[t._v("vdom")]),t._v(" çš„æ ¸å¿ƒåŒ…å›´ç€å¤§é‡çš„ "),a("strong",[t._v("diff ç®—æ³•")]),t._v(" ã€‚")]),t._v(" "),a("p",[t._v("æœ‰äº†è¿™å‡ ä¸ªæ¦‚å¿µçš„åŸºç¡€é“ºå«ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥å¼€å§‹äº†è§£ "),a("strong",[t._v("è™šæ‹Ÿ DOM")]),t._v(" æ˜¯ä»€ä¹ˆã€‚")]),t._v(" "),a("h2",{attrs:{id:"_2ã€çœŸå®-dom-çš„æ¸²æŸ“è¿‡ç¨‹"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€çœŸå®-dom-çš„æ¸²æŸ“è¿‡ç¨‹"}},[t._v("#")]),t._v(" 2ã€çœŸå® DOM çš„æ¸²æŸ“è¿‡ç¨‹")]),t._v(" "),a("p",[t._v("åœ¨å¼€å§‹è®²è§£ "),a("code",[t._v("è™šæ‹ŸDOM")]),t._v(" ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£çœŸå®çš„ "),a("code",[t._v("DOM")]),t._v(" åœ¨æµè§ˆå™¨ä¸­æ˜¯æ€ä¹ˆè§£æçš„ã€‚æµè§ˆå™¨æ¸²æŸ“å¼•æ“å·¥ä½œæµç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹"),a("strong",[t._v("4 ä¸ªæ­¥éª¤ï¼š")])]),t._v(" "),a("p",[a("strong",[t._v("åˆ›å»º DOM æ ‘")]),t._v(" â†’ "),a("strong",[t._v("åˆ›å»º CSSOM æ ‘")]),t._v(" â†’ "),a("strong",[t._v("ç”Ÿæˆ render æ ‘")]),t._v(" â†’ "),a("strong",[t._v("å¸ƒå±€ render æ ‘")]),t._v(" â†’ "),a("strong",[t._v("ç»˜åˆ¶ render æ ‘")]),t._v(" ã€‚")]),t._v(" "),a("ul",[a("li",[t._v("ç¬¬ä¸€æ­¥ï¼šåˆ›å»º "),a("code",[t._v("DOM")]),t._v(" æ ‘ã€‚æ¸²æŸ“å¼•æ“é¦–å…ˆè§£æ "),a("code",[t._v("HTML")]),t._v(" ä»£ç ï¼Œå¹¶ç”Ÿæˆ "),a("code",[t._v("DOM")]),t._v(" æ ‘ã€‚")]),t._v(" "),a("li",[t._v("ç¬¬äºŒæ­¥ï¼šåˆ›å»º "),a("code",[t._v("CSSOM")]),t._v(" æ ‘ã€‚æµè§ˆä¸ºè·å¾—å¤–éƒ¨ "),a("code",[t._v("css")]),t._v(" æ–‡ä»¶çš„æ•°æ®åï¼Œå°±ä¼šåƒæ„å»º "),a("code",[t._v("DOM")]),t._v(" æ ‘ä¸€æ ·å¼€å§‹æ„å»º "),a("code",[t._v("CSSOM")]),t._v(" æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸ç¬¬ä¸€æ­¥æ²¡ä»€ä¹ˆå·®åˆ«ã€‚")]),t._v(" "),a("li",[t._v("ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆ "),a("code",[t._v("Render")]),t._v(" æ ‘ã€‚å°† "),a("code",[t._v("DOM")]),t._v(" æ ‘å’Œ "),a("code",[t._v("CSSOM")]),t._v(" æ ‘å…³è”èµ·æ¥ï¼Œç”Ÿæˆä¸€æ£µ "),a("code",[t._v("Render")]),t._v(" ï¼ˆæ¸²æŸ“ï¼‰æ ‘ã€‚")]),t._v(" "),a("li",[t._v("ç¬¬å››æ­¥ï¼šå¸ƒå±€ "),a("code",[t._v("Render")]),t._v(" æ ‘ã€‚æœ‰äº† "),a("code",[t._v("Render")]),t._v(" æ ‘ä¹‹åï¼Œæµè§ˆå™¨å¼€å§‹å¯¹æ¸²æŸ“æ ‘çš„æ¯ä¸ªèŠ‚ç‚¹è¿›è¡Œå¸ƒå±€å¤„ç†ï¼Œç¡®å®šå…¶"),a("strong",[t._v("åœ¨å±å¹•ä¸Šçš„æ˜¾ç¤ºä½ç½®")]),t._v("ã€‚")]),t._v(" "),a("li",[t._v("ç¬¬äº”æ­¥ï¼šç»˜åˆ¶ "),a("code",[t._v("Render")]),t._v(" æ ‘ã€‚å°†"),a("strong",[t._v("æ¯ä¸ªèŠ‚ç‚¹")]),t._v("ç»˜åˆ¶åˆ°å±å¹•ä¸Šã€‚")])]),t._v(" "),a("p",[t._v("å¼•ç”¨ç½‘ä¸Šçš„ä¸€å¼ å›¾æ¥å‘ˆç°"),a("strong",[t._v("çœŸå® DOM çš„æ¸²æŸ“è¿‡ç¨‹ï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605140852475.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic",alt:"çœŸå®DOMçš„æ¸²æŸ“è¿‡ç¨‹"}})]),t._v(" "),a("h2",{attrs:{id:"_3ã€è™šæ‹Ÿ-dom-æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€è™šæ‹Ÿ-dom-æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" 3ã€è™šæ‹Ÿ DOM æ˜¯ä»€ä¹ˆï¼Ÿ")]),t._v(" "),a("p",[t._v("å½“ç”¨åŸç”Ÿ "),a("code",[t._v("js")]),t._v(" æˆ–è€… "),a("code",[t._v("jq")]),t._v(" å»æ“ä½œçœŸå® "),a("code",[t._v("DOM")]),t._v(" çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼š"),a("strong",[t._v("ä»æ„å»º DOM æ ‘å¼€å§‹")]),t._v("ï¼Œ"),a("strong",[t._v("ä»å¤´åˆ°å°¾æ‰§è¡Œä¸€éæµç¨‹")]),t._v("ã€‚é‚£è¿™æ ·çš„è¯ï¼Œå°±å¾ˆæœ‰å¯èƒ½å¯¼è‡´"),a("strong",[t._v("æ“ä½œæ¬¡æ•°è¿‡å¤š")]),t._v("ã€‚å½“æ“ä½œæ¬¡æ•°è¿‡å¤šæ—¶ï¼Œä¹‹å‰è®¡ç®—çš„ä¸ "),a("code",[t._v("DOM")]),t._v(" èŠ‚ç‚¹ç›¸å…³çš„åæ ‡å€¼ç­‰å„ç§å€¼å°±......ä¸çŸ¥ä¸è§‰çš„æµªè´¹æ‰äº†å…¶æ€§èƒ½ï¼Œå› æ­¤å‘¢ï¼Œ"),a("strong",[t._v("è™šæ‹Ÿ DOM ç”±æ­¤äº§ç”Ÿ")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_4ã€è§£å†³æ–¹æ¡ˆ-vdom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€è§£å†³æ–¹æ¡ˆ-vdom"}},[t._v("#")]),t._v(" 4ã€è§£å†³æ–¹æ¡ˆ - vdom")]),t._v(" "),a("h3",{attrs:{id:"_1-é—®é¢˜å¼•å‡º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-é—®é¢˜å¼•å‡º"}},[t._v("#")]),t._v(" ï¼ˆ1ï¼‰é—®é¢˜å¼•å‡º")]),t._v(" "),a("p",[t._v("å¤§å®¶éƒ½çŸ¥é“ï¼Œ "),a("code",[t._v("DOM")]),t._v(" æ ‘æ˜¯å…·æœ‰ä¸€å®šçš„å¤æ‚åº¦çš„ï¼Œæ‰€ä»¥ï¼Œåœ¨ç”Ÿæˆ "),a("code",[t._v("DOM")]),t._v(" æ ‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä¸æ–­çš„è¿›è¡Œè®¡ç®—æ“ä½œï¼Œä½†éš¾å°±éš¾åœ¨ï¼Œæƒ³è¦"),a("strong",[t._v("å‡å°‘è®¡ç®—æ¬¡æ•°")]),t._v("å…¶å®è¿˜æ˜¯æ¯”è¾ƒéš¾çš„ã€‚")]),t._v(" "),a("p",[t._v("é‚£æ¢ä¸ªæ€è·¯è€ƒè™‘ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œ"),a("code",[t._v("JS")]),t._v(" çš„æ‰§è¡Œé€Ÿåº¦"),a("strong",[t._v("å¾ˆå¿«å¾ˆå¿«")]),t._v("ï¼Œé‚£èƒ½ä¸èƒ½å°è¯•ç€æŠŠè¿™ä¸ª"),a("strong",[t._v("è®¡ç®—")]),t._v("ï¼Œæ›´å¤šçš„è½¬ä¸º"),a("strong",[t._v("JS è®¡ç®—")]),t._v("å‘¢ï¼Ÿ"),a("strong",[t._v("ç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"_2-vdom-å¦‚ä½•è§£å†³é—®é¢˜-å°†çœŸå®-dom-è½¬ä¸º-js-å¯¹è±¡çš„è®¡ç®—"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-vdom-å¦‚ä½•è§£å†³é—®é¢˜-å°†çœŸå®-dom-è½¬ä¸º-js-å¯¹è±¡çš„è®¡ç®—"}},[t._v("#")]),t._v(" ï¼ˆ2ï¼‰vdom å¦‚ä½•è§£å†³é—®é¢˜ï¼šå°†çœŸå® DOM è½¬ä¸º JS å¯¹è±¡çš„è®¡ç®—")]),t._v(" "),a("p",[t._v("å‡è®¾åœ¨ä¸€æ¬¡æ“ä½œä¸­æœ‰"),a("strong",[t._v("1000 ä¸ªèŠ‚ç‚¹")]),t._v("éœ€è¦æ›´æ–° "),a("code",[t._v("DOM")]),t._v(" ï¼Œé‚£ä¹ˆ "),a("strong",[t._v("è™šæ‹Ÿ DOM")]),t._v(" ä¸ä¼šç«‹å³å» "),a("strong",[t._v("æ“ä½œ DOM")]),t._v(" ï¼Œè€Œæ˜¯å°†è¿™ 1000 æ¬¡æ›´æ–°çš„ "),a("code",[t._v("diff")]),t._v(" å†…å®¹ä¿å­˜åˆ°æœ¬åœ°çš„ä¸€ä¸ª "),a("code",[t._v("JS")]),t._v(" å¯¹è±¡å½“ä¸­ï¼Œä¹‹åå°†è¿™ä¸ª "),a("code",[t._v("JS")]),t._v("å¯¹è±¡ä¸€æ¬¡æ€§ "),a("strong",[t._v("attach")]),t._v(" åˆ° "),a("code",[t._v("DOM")]),t._v(" æ ‘ä¸Šï¼Œæœ€åå†è¿›è¡Œåç»­çš„æ“ä½œï¼Œè¿™æ ·å­å°±"),a("strong",[t._v("é¿å…äº†å¤§é‡æ²¡æœ‰å¿…è¦çš„è®¡ç®—")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æ‰€ä»¥ï¼Œ"),a("strong",[t._v("ç”¨ JS å¯¹è±¡æ¨¡æ‹Ÿ DOM èŠ‚ç‚¹çš„å¥½å¤„")]),t._v("æ˜¯ï¼Œå…ˆå°†é¡µé¢çš„æ›´æ–°å…¨éƒ¨åæ˜ åˆ°è™šæ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" ä¸Šï¼Œè¿™æ ·å­å°±å…ˆ**"),a("u",[t._v("æ“ä½œå†…å­˜ä¸­çš„ JS å¯¹è±¡")]),t._v("**ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ“ä½œå†…å­˜ä¸­ "),a("code",[t._v("JS")]),t._v(" å¯¹è±¡çš„é€Ÿåº¦æ˜¯ç›¸å½“å¿«çš„ã€‚å› æ­¤ï¼Œç­‰åˆ°å…¨éƒ¨ "),a("strong",[t._v("DOM èŠ‚ç‚¹")]),t._v(" æ›´æ–°å®Œæˆä¹‹åï¼Œå†å°† "),a("strong",[t._v("æœ€åçš„ JS å¯¹è±¡")]),t._v(" æ˜ å°„åˆ° "),a("strong",[t._v("çœŸå®çš„ DOM")]),t._v(" ä¸Šï¼Œäº¤ç”± "),a("strong",[t._v("æµè§ˆå™¨")]),t._v(" å»ç»˜åˆ¶ã€‚")]),t._v(" "),a("p",[t._v("è¿™æ ·ï¼Œå°±è§£å†³äº†çœŸå® "),a("code",[t._v("DOM")]),t._v(" "),a("strong",[t._v("æ¸²æŸ“é€Ÿåº¦æ…¢")]),t._v("ï¼Œ"),a("strong",[t._v("æ€§èƒ½æ¶ˆè€—å¤§")]),t._v("çš„é—®é¢˜ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_5ã€ç”¨-js-æ¨¡æ‹Ÿä¸€ä¸ª-dom-ç»“æ„"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5ã€ç”¨-js-æ¨¡æ‹Ÿä¸€ä¸ª-dom-ç»“æ„"}},[t._v("#")]),t._v(" 5ã€ç”¨ JS æ¨¡æ‹Ÿä¸€ä¸ª DOM ç»“æ„")]),t._v(" "),a("p",[t._v("æ ¹æ®ä¸‹æ–¹çš„ "),a("code",[t._v("html")]),t._v(" ä»£ç ï¼Œç”¨ "),a("code",[t._v("v-node")]),t._v(" æ¨¡æ‹Ÿå‡ºè¯¥ "),a("code",[t._v("html")]),t._v(" ä»£ç çš„ "),a("code",[t._v("DOM")]),t._v(" ç»“æ„ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("html ä»£ç ï¼š")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("div1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("vdom"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token special-attr"}},[a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),a("span",{pre:!0,attrs:{class:"token value css language-css"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v("font-size")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("20px"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("a"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[a("strong",[t._v("ç”¨ JS æ¨¡æ‹Ÿå‡ºä»¥ä¸Šä»£ç çš„ DOM ç»“æ„ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("className")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div1'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("chindren")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vdom'")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ul'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'font-size: 20px'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ....")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("é€šè¿‡ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥åˆ†æå‡ºï¼Œæˆ‘ä»¬ç”¨ "),a("code",[t._v("tag")]),t._v(" ï¼Œ "),a("code",[t._v("props")]),t._v(" å’Œ "),a("code",[t._v("children")]),t._v(" æ¥æ¨¡æ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" æ ‘ç»“æ„ã€‚ç”¨ "),a("code",[t._v("JS")]),t._v(" æ¨¡æ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" æ ‘çš„ç»“æ„ï¼Œè¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œå¯ä»¥è®¡ç®—å‡º"),a("strong",[t._v("æœ€å°çš„å˜æ›´")]),t._v("ï¼Œæ“ä½œ"),a("strong",[t._v("æœ€å°‘çš„ DOM")]),t._v("ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_6ã€é€šè¿‡-snabbdom-å­¦ä¹ -vdom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6ã€é€šè¿‡-snabbdom-å­¦ä¹ -vdom"}},[t._v("#")]),t._v(" 6ã€é€šè¿‡ snabbdom å­¦ä¹  vdom")]),t._v(" "),a("p",[a("code",[t._v("vue")]),t._v(" çš„ "),a("strong",[t._v("vdom")]),t._v(" å’Œ "),a("strong",[t._v("diff ç®—æ³•")]),t._v(" æ˜¯å‚è€ƒ "),a("code",[t._v("github")]),t._v(" ä¸Šçš„ä¸€ä¸ªå¼€æºåº“ "),a("a",{attrs:{href:"https://github.com/snabbdom/snabbdom",target:"_blank",rel:"noopener noreferrer"}},[t._v("snabbdom"),a("OutboundLink")],1),t._v(" æ”¹é€ è¿‡æ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ¥ä¸‹æ¥å°±ç”¨è¿™ä¸ªåº“ä¸ºä¾‹ï¼Œæ¥å­¦ä¹  "),a("code",[t._v("vdom")]),t._v(" çš„æ€æƒ³ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_1-snabbdom-æ˜¯ä»€ä¹ˆ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-snabbdom-æ˜¯ä»€ä¹ˆ"}},[t._v("#")]),t._v(" ï¼ˆ1ï¼‰snabbdom æ˜¯ä»€ä¹ˆ")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("snabbdom")]),t._v(" æ˜¯ä¸€ä¸ªç®€æ´åˆå¼ºå¤§çš„ "),a("code",[t._v("vdom")]),t._v(" åº“ï¼Œæ˜“å­¦æ˜“ç”¨ï¼›")]),t._v(" "),a("li",[a("code",[t._v("Vue")]),t._v(" å‚è€ƒå®ƒå®ç°çš„ "),a("code",[t._v("vdom")]),t._v(" å’Œ "),a("code",[t._v("diff")]),t._v(" ï¼›")]),t._v(" "),a("li",[a("code",[t._v("Vue3.0")]),t._v(" é‡å†™äº† "),a("code",[t._v("vdom")]),t._v(" çš„ä»£ç ï¼Œä¼˜åŒ–äº†æ€§èƒ½ã€‚")])]),t._v(" "),a("h3",{attrs:{id:"_2-snabbdom-æµ…æ"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-snabbdom-æµ…æ"}},[t._v("#")]),t._v(" ï¼ˆ2ï¼‰snabbdom æµ…æ")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å…ˆæ¥çœ‹ "),a("code",[t._v("snabbdom")]),t._v(" é¦–é¡µä¸Šçš„ "),a("code",[t._v("example")]),t._v(" ï¼Œå…ˆç®€å•äº†è§£å…¶æ€æƒ³ã€‚"),a("strong",[t._v("ä¸‹é¢å…ˆè´´ä¸Šä»£ç ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  init"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  classModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  propsModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  styleModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  eventListenersModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'snabbdom'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" patch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Init patch function with chosen modules")]),t._v("\n  classModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// makes it easy to toggle classes")]),t._v("\n  propsModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// for setting properties on DOM elements")]),t._v("\n  styleModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// handles styling on elements with support for animations")]),t._v("\n  eventListenersModule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// attaches event listeners")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" container "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//hå‡½æ•°è¾“å…¥ä¸€ä¸ªæ ‡ç­¾ï¼Œä¹‹åå†è¾“å…¥ä¸€ä¸ªdataï¼Œæœ€å‘¨è¾“å…¥ä¸€ä¸ªå­å…ƒç´ ")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div#container.two.classes'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("click")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" someFn "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fontWeight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bold'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'This is bold'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' and this is just normal text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/foo'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I\'ll take you places!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ç¬¬ä¸€ä¸ªpatchå‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Patch into empty DOM element â€“ this modifies the DOM as a side effect")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div#container.two.classes'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("on")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("click")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" anotherEventHandler "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("style")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fontWeight")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'normal'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("fontStyle")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'italic'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'This is now italic type'")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("' and this is still just normal text'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("href")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/bar'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"I\'ll take you places!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//ç¬¬äºŒä¸ªpatchå‡½æ•°")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Second `patch` invocation")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Snabbdom efficiently updates the old view to the new state")]),t._v("\n")])])]),a("p",[t._v("é€šè¿‡å®˜æ–¹çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œ "),a("code",[t._v("h")]),t._v(" å‡½æ•°è¾“å…¥ä¸€ä¸ªæ ‡ç­¾ï¼Œä¹‹åè¾“å…¥ä¸€ä¸ª "),a("code",[t._v("data")]),t._v(" ï¼Œæœ€åè¾“å…¥ä¸€ä¸ªå­å…ƒç´ ã€‚å¹¶ä¸” h å‡½æ•°æ˜¯ä¸€ä¸ª "),a("code",[t._v("vnode")]),t._v(" çš„ç»“æ„ï¼ˆ "),a("code",[t._v("vnode")]),t._v(" ç»“æ„è§ä¸Šè¿°ç¬¬ 5 ç‚¹ï¼‰ï¼Œå±‚çº§èˆ¬çš„ä¸€å±‚ä¸€å±‚é€’è¿›ã€‚æœ€åå°±æ˜¯ "),a("code",[t._v("patch")]),t._v(" å‡½æ•°ï¼Œç¬¬ä¸€ä¸ª"),a("code",[t._v("patch")]),t._v(" å‡½æ•°ç”¨æ¥å¯¹å…ƒç´ è¿›è¡Œæ¸²æŸ“ï¼Œç¬¬äºŒä¸ª "),a("code",[t._v("patch")]),t._v(" å‡½æ•°ç”¨æ¥"),a("strong",[t._v("æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹")]),t._v("ã€‚")]),t._v(" "),a("h3",{attrs:{id:"_2-snabbdom-æ¼”ç¤º"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-snabbdom-æ¼”ç¤º"}},[t._v("#")]),t._v(" ï¼ˆ2ï¼‰snabbdom æ¼”ç¤º")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬ç”¨ "),a("code",[t._v("cdn")]),t._v(" çš„æ–¹å¼å¼•å…¥ "),a("code",[t._v("snabbdom")]),t._v(" çš„åº“ï¼Œæ¥æ¼”ç¤ºä¸€é "),a("code",[t._v("snabbdom")]),t._v(" æ˜¯å¦‚ä½•æ“ä½œ "),a("code",[t._v("vdom")]),t._v(" çš„ã€‚"),a("strong",[t._v("é™„ä¸Šä»£ç ï¼š")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token doctype"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<!")]),a("span",{pre:!0,attrs:{class:"token doctype-tag"}},[t._v("DOCTYPE")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token name"}},[t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("meta")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("charset")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("UTF-8"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Document"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("btn-change"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("change"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-class.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-props.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-style.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/snabbdom-eventlisteners.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://cdn.bootcss.com/snabbdom/0.7.3/h.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}},[a("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" snabbdom "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("snabbdom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰ patch")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" patch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" snabbdom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        snabbdom_class"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        snabbdom_props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        snabbdom_style"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        snabbdom_eventlisteners"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å®šä¹‰ h")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" h "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" snabbdom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("h"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" container "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”Ÿæˆ vnode")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ul#list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li.item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item 1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li.item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item 2'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("container"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      document"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getElementById")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'btn-change'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addEventListener")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç”Ÿæˆ newVnode")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" newVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ul#list'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li.item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item 1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li.item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item B'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li.item'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Item 3'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vnode = newVnode â†’ patch ä¹‹åï¼Œåº”è¯¥ç”¨æ–°çš„è¦†ç›–ç°æœ‰çš„ vnode ï¼Œå¦åˆ™æ¯æ¬¡ change éƒ½æ˜¯æ–°æ—§å¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    ")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),a("p",[a("strong",[t._v("æ­¤æ—¶æˆ‘ä»¬æ¥çœ‹æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605140917178.gif#pic_center",alt:"snabbdomæ¼”ç¤º"}})]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæœ€ç»ˆçš„æ•ˆæœæ˜¯å½“æˆ‘ä»¬ç‚¹å‡»æ—¶ï¼Œ "),a("code",[t._v("DOM")]),t._v(" æ ‘"),a("strong",[t._v("ä¸ä¼šä¸€æ•´æ£µæ ‘é‡æ–°æ¸²æŸ“")]),t._v("ï¼Œè€Œæ˜¯åªé’ˆå¯¹"),a("strong",[t._v("æ”¹å˜çš„å€¼")]),t._v("è¿›è¡Œé‡æ–°æ¯”è¾ƒï¼Œæœ€ç»ˆåªå°†æ”¹å˜çš„èŠ‚ç‚¹è¿›è¡Œæ¸²æŸ“ã€‚")]),t._v(" "),a("p",[t._v("é€šè¿‡è¿™æ ·çš„æ¼”ç¤ºï¼Œç›¸ä¿¡å¤§å®¶å¯¹çœŸå® "),a("code",[t._v("DOM")]),t._v(" å’Œè™šæ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" çš„åŒºåˆ«æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_7ã€vdom-æ€»ç»“"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7ã€vdom-æ€»ç»“"}},[t._v("#")]),t._v(" 7ã€vdom æ€»ç»“")]),t._v(" "),a("p",[a("strong",[t._v("è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬æ¥å¯¹ vdom åšä¸€ä¸ªæ€»ç»“ï¼š")])]),t._v(" "),a("ul",[a("li",[t._v("å¯ä»¥é€šè¿‡ "),a("code",[t._v("JS")]),t._v(" æ¥æ¨¡æ‹Ÿ "),a("code",[t._v("DOM")]),t._v(" ç»“æ„ï¼ˆvnodeï¼‰ï¼›")]),t._v(" "),a("li",[t._v("æ–°æ—§ "),a("code",[t._v("vnode")]),t._v(" å¯¹æ¯”ï¼Œå¾—å‡º"),a("strong",[t._v("æœ€å°çš„æ›´æ–°èŒƒå›´")]),t._v("ï¼Œæœ€å"),a("strong",[t._v("æ›´æ–° DOM")]),t._v("ï¼›")]),t._v(" "),a("li",[t._v("æ•°æ®é©±åŠ¨è§†å›¾çš„æ¨¡å¼ä¸‹ï¼Œå¯ä»¥æœ‰æ•ˆåœ°æ§åˆ¶"),a("strong",[t._v("DOM æ“ä½œ")]),t._v("ã€‚")])]),t._v(" "),a("h1",{attrs:{id:"äºŒã€diff-ç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€diff-ç®—æ³•"}},[t._v("#")]),t._v(" äºŒã€diff ç®—æ³•")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬åœ¨ä¸Šè¿°è®² "),a("code",[t._v("vdom")]),t._v(" çš„æ—¶å€™è¯´è¿‡ï¼Œ "),a("code",[t._v("vdom")]),t._v(" çš„æ ¸å¿ƒä»·å€¼å°±åœ¨äºæœ€å¤§ç¨‹åº¦çš„"),a("strong",[t._v("å‡å°‘ DOM çš„ä½¿ç”¨èŒƒå›´")]),t._v("ã€‚é‚£ "),a("code",[t._v("vdom")]),t._v(" æ˜¯é€šè¿‡ä»€ä¹ˆæ–¹å¼å‘¢ï¼Œå®ƒæ˜¯é€šè¿‡æŠŠ "),a("code",[t._v("DOM")]),t._v(" ç”¨ "),a("code",[t._v("JS")]),t._v(" æ¥å»æ¨¡æ‹Ÿï¼Œä¹‹åè¿›è¡Œè®¡ç®—å’Œè¿›è¡Œå¯¹æ¯”ï¼Œæœ€åæ‰¾å‡ºæœ€å°çš„æ›´æ–°èŒƒå›´å»æ›´æ–°ã€‚é‚£ä¹ˆè¿™ä¸ªå¯¹æ¯”çš„è¿‡ç¨‹å¯¹åº”çš„å°±æ˜¯æˆ‘ä»¬ç»å¸¸å¬åˆ°çš„ "),a("code",[t._v("diff")]),t._v(" ç®—æ³•ã€‚")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€èµ·æ¥äº†è§£ "),a("code",[t._v("vdom")]),t._v(" çš„å¦å¤–ä¸€ä¸ªå†…å®¹ï¼Œ "),a("code",[t._v("diff")]),t._v(" ç®—æ³•ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_1ã€diff-ç®—æ³•"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€diff-ç®—æ³•"}},[t._v("#")]),t._v(" 1ã€diff ç®—æ³•")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("diff ç®—æ³•æ˜¯å‰ç«¯çš„ä¸€ä¸ªçƒ­é—¨è¯é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ "),a("code",[t._v("vdom")]),t._v(" ä¸­æœ€æ ¸å¿ƒã€æœ€å…³é”®çš„éƒ¨åˆ†ã€‚")])]),t._v(" "),a("li",[a("p",[t._v("diff ç®—æ³•åœ¨æ—¥å¸¸ä½¿ç”¨ "),a("code",[t._v("vue")]),t._v(" å’Œ "),a("code",[t._v("react")]),t._v(" ä¸­ç»å¸¸å‡ºç°ï¼ˆå¦‚"),a("strong",[t._v("key")]),t._v("ï¼‰ã€‚")])])]),t._v(" "),a("h2",{attrs:{id:"_2ã€diff-ç®—æ³•æ¦‚è¿°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€diff-ç®—æ³•æ¦‚è¿°"}},[t._v("#")]),t._v(" 2ã€diff ç®—æ³•æ¦‚è¿°")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("diff")]),t._v(" å³"),a("strong",[t._v("å¯¹æ¯”")]),t._v("ï¼Œæ˜¯ä¸€ä¸ª"),a("strong",[t._v("å¹¿æ³›çš„")]),t._v("æ¦‚å¿µï¼Œå¦‚"),a("strong",[t._v("linux diff å‘½ä»¤")]),t._v("ã€"),a("strong",[t._v("git diff å‘½ä»¤")]),t._v("ç­‰ã€‚")]),t._v(" "),a("li",[t._v("ä¸¤ä¸ª js å¯¹è±¡ä¹Ÿå¯ä»¥åš "),a("code",[t._v("diff")]),t._v(" ï¼Œå¦‚ "),a("code",[t._v("github")]),t._v(" ä¸Šçš„"),a("a",{attrs:{href:"https://github.com/cujojs/jiff",target:"_blank",rel:"noopener noreferrer"}},[t._v("jiff åº“"),a("OutboundLink")],1),t._v("ï¼Œè¿™ä¸ªåº“å¯ä»¥ç›´æ¥ç”¨æ¥ç»™ä¸¤ä¸ª js å¯¹è±¡åš diffã€‚")]),t._v(" "),a("li",[t._v("ä¸¤æ£µæ ‘åš "),a("code",[t._v("diff")]),t._v(" ï¼Œå¦‚ä¸Šè¿°æ‰€è¯´çš„ "),a("code",[t._v("vdom")]),t._v(" å’Œ "),a("code",[t._v("diff")]),t._v(" ã€‚")])]),t._v(" "),a("p",[a("strong",[t._v("æˆ‘ä»¬æ¥çœ‹ä¸ªä¾‹å­ ğŸŒ°ï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605140931505.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic_center",alt:"æ ‘çš„å¯¹æ¯”"}})]),t._v(" "),a("p",[t._v("çœ‹åˆ°ä¸Šé¢ä¸¤æ£µæ ‘ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸‹å®ƒæ˜¯å¦‚ä½•è¿›è¡Œ "),a("code",[t._v("diff")]),t._v(" ç®—æ³•çš„ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³è¾¹è¿™æ£µæ ‘è¦æŠŠå·¦è¾¹çš„ "),a("code",[t._v("E")]),t._v(" æ”¹ä¸º "),a("code",[t._v("X")]),t._v(" ï¼ŒåŒæ—¶è¦æ–°å¢ä¸€ä¸ªèŠ‚ç‚¹ "),a("code",[t._v("H")]),t._v(" ã€‚å› æ­¤å¦‚æœé€šè¿‡ "),a("code",[t._v("diff")]),t._v(" æ¥å®ç°çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å…¶è¿›è¡Œ"),a("strong",[t._v("æ–°æ—§èŠ‚ç‚¹çš„æ¯”è¾ƒ")]),t._v("ï¼Œå¦‚æœæ¯”è¾ƒå®Œä¸€æ ·ï¼Œåˆ™ä¸åŠ¨å®ƒï¼›å¦‚æœæ¯”è¾ƒå®Œä¸ä¸€æ ·ï¼Œåˆ™å¯¹å®ƒè¿›è¡Œä¿®æ”¹ã€‚è¿™æ ·å¤„ç†çš„è¯ï¼Œ"),a("strong",[t._v("5 ä¸ªèŠ‚ç‚¹åªéœ€è¦ä¿®æ”¹ 2 æ¬¡")]),t._v("ï¼Œè€Œä¸ç”¨ä¿®æ”¹ 5 æ¬¡ï¼Œæ•ˆç‡å¾ˆæ˜¯ UpUpã€‚")]),t._v(" "),a("h2",{attrs:{id:"_3ã€æ ‘-diff-çš„æ—¶é—´å¤æ‚åº¦-o-n3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€æ ‘-diff-çš„æ—¶é—´å¤æ‚åº¦-o-n3"}},[t._v("#")]),t._v(" 3ã€æ ‘ diff çš„æ—¶é—´å¤æ‚åº¦ O(n"),a("sup",[t._v("3")]),t._v(")")]),t._v(" "),a("p",[t._v("å¯¹äºæ ‘æ¥è¯´ï¼ŒåŸå§‹çš„æ—¶é—´å¤æ‚åº¦æœ‰"),a("strong",[t._v("O(n"),a("sup",[t._v("3")]),t._v(")")]),t._v("ã€‚é‚£ä¹ˆè¿™ä¸ª "),a("strong",[t._v("O(n"),a("sup",[t._v("3")]),t._v(")")]),t._v(" æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ")]),t._v(" "),a("p",[a("strong",[t._v("é¦–å…ˆ")]),t._v("ï¼Œéå† tree1ï¼›"),a("strong",[t._v("å…¶æ¬¡")]),t._v("ï¼Œéå† tree2ï¼›"),a("strong",[t._v("æœ€å")]),t._v("ï¼Œå¯¹æ ‘è¿›è¡Œæ’åºã€‚è¿™æ · "),a("code",[t._v("n*n*n")]),t._v(" ï¼Œå°±è¾¾åˆ°äº†"),a("strong",[t._v("O(n"),a("sup",[t._v("3")]),t._v(")")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("å‡è®¾ç°åœ¨æœ‰ 1000 ä¸ªèŠ‚ç‚¹è¦æ“ä½œï¼Œé‚£ 1000 çš„ 3 æ¬¡æ–¹å°±"),a("strong",[t._v("1 äº¿æ¬¡")]),t._v("äº†ï¼Œå› æ­¤ï¼Œæ ‘çš„è¿™ä¸ªç®—æ³•ä¸å¯ç”¨ã€‚é‚£æˆ‘ä»¬æ€ä¹ˆè§£å†³å‘¢ï¼Ÿç»§ç»­çœ‹ä¸‹é¢ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_4ã€ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦åˆ°-o-n"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦åˆ°-o-n"}},[t._v("#")]),t._v(" 4ã€ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦åˆ° O(n)")]),t._v(" "),a("p",[t._v("å› ä¸ºæ ‘çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n"),a("sup",[t._v("3")]),t._v(")ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å°±æƒ³åŠæ³•ï¼Œä¼˜åŒ–å…¶æ—¶é—´å¤æ‚åº¦"),a("strong",[t._v("ä» O(n"),a("sup",[t._v("3")]),t._v(")åˆ° O(n)")]),t._v("ï¼Œä»¥è¾¾åˆ°æ“ä½œ "),a("code",[t._v("vdom")]),t._v(" èŠ‚ç‚¹ï¼Œé‚£è¿™ä¸ªä¼˜åŒ–è¿‡ç¨‹å…¶å®æˆ‘ä»¬æ‰€è¯´çš„ "),a("code",[t._v("diff")]),t._v(" ç®—æ³•ã€‚é€šè¿‡ "),a("code",[t._v("diff")]),t._v(" ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´å¤æ‚åº¦"),a("strong",[t._v("ä» O(n"),a("sup",[t._v("3")]),t._v(")ä¼˜åŒ–åˆ° O(n)")]),t._v("ã€‚"),a("strong",[t._v("diff ç®—æ³•çš„å…·ä½“æ€æƒ³å¦‚ä¸‹ï¼š")])]),t._v(" "),a("ul",[a("li",[t._v("åªæ¯”è¾ƒ"),a("strong",[t._v("åŒä¸€å±‚çº§")]),t._v("ï¼Œ"),a("strong",[t._v("ä¸è·¨çº§æ¯”è¾ƒ")]),t._v("ï¼›")]),t._v(" "),a("li",[a("code",[t._v("tag")]),t._v(" ä¸ç›¸åŒï¼Œåˆ™ç›´æ¥åˆ æ‰é‡å»ºï¼Œä¸å†æ·±åº¦æ¯”è¾ƒï¼›")]),t._v(" "),a("li",[a("code",[t._v("tag")]),t._v(" å’Œ "),a("code",[t._v("key")]),t._v(" ï¼Œä¸¤è€…éƒ½ç›¸åŒï¼Œåˆ™è®¤ä¸ºæ˜¯"),a("strong",[t._v("ç›¸åŒèŠ‚ç‚¹")]),t._v("ï¼Œä¸å†æ·±åº¦æ¯”è¾ƒã€‚")])]),t._v(" "),a("h1",{attrs:{id:"ä¸‰ã€æ·±å…¥-diff-ç®—æ³•æºç "}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€æ·±å…¥-diff-ç®—æ³•æºç "}},[t._v("#")]),t._v(" ä¸‰ã€æ·±å…¥ diff ç®—æ³•æºç ")]),t._v(" "),a("h2",{attrs:{id:"_1ã€ç”Ÿæˆ-vnode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1ã€ç”Ÿæˆ-vnode"}},[t._v("#")]),t._v(" 1ã€ç”Ÿæˆ vnode")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å…ˆæ¥å›é¡¾ä¸‹ä¸Šé¢è®²çš„ "),a("code",[t._v("snabbdom")]),t._v(" ï¼Œ "),a("code",[t._v("diff")]),t._v(" æ¯”è¾ƒå…ˆæ˜¯åœ¨ "),a("code",[t._v("h")]),t._v(" å‡½æ•°é‡Œé¢è¿›è¡Œï¼Œè¿™ä¸ª "),a("code",[t._v("h")]),t._v(" å‡½æ•°è¾“å…¥ä¸€ä¸ªæ ‡ç­¾ï¼Œä¹‹åè¾“å…¥ä¸€ä¸ª "),a("code",[t._v("data")]),t._v(" ï¼Œæœ€åè¾“å…¥ä¸€ä¸ªå­å…ƒç´ ã€‚å¹¶ä¸” "),a("code",[t._v("h")]),t._v(" å‡½æ•°æ˜¯ä¸€ä¸ª "),a("code",[t._v("vnode")]),t._v(" çš„ç»“æ„ï¼Œå±‚çº§èˆ¬çš„ä¸€å±‚ä¸€å±‚é€’è¿›ã€‚æœ€åå°±æ˜¯ "),a("code",[t._v("patch")]),t._v(" å‡½æ•°ï¼Œ ç¬¬ä¸€ä¸ª"),a("code",[t._v("patch")]),t._v(" å‡½æ•°ç”¨æ¥å¯¹å…ƒç´ è¿›è¡Œæ¸²æŸ“ï¼Œç¬¬äºŒä¸ª "),a("code",[t._v("patch")]),t._v(" å‡½æ•°ç”¨æ¥"),a("strong",[t._v("æ¯”è¾ƒæ–°æ—§èŠ‚ç‚¹")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹å®ƒæ˜¯å¦‚ä½•ç”Ÿæˆ vnode çš„ã€‚")]),t._v(" "),a("p",[t._v("å…ˆå…‹éš†ä¸€ä»½"),a("a",{attrs:{href:"https://github.com/snabbdom/snabbdom",target:"_blank",rel:"noopener noreferrer"}},[t._v("snabbdom"),a("OutboundLink")],1),t._v("çš„ä»£ç ä¸‹æ¥ï¼Œæ‰“å¼€ "),a("code",[t._v("src|h.ts")]),t._v(" æ–‡ä»¶ï¼Œç›´æ¥æ¥çœ‹ "),a("code",[t._v("h")]),t._v(" å‡½æ•°ï¼Œ"),a("strong",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeChildren")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("h")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeData "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("i")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("primitive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("c "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("array")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("primitive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("b "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("is"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("primitive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"s"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n    sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"v"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n    sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"g"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"."')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addNS")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›vnodeï¼Œè¿™ä¸ªvnodeå¯¹åº”patchä¸‹çš„vnode")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),a("p",[t._v("æˆ‘ä»¬çœ‹åˆ°æœ€åä¸€è¡Œï¼Œ "),a("code",[t._v("h")]),t._v(" å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª "),a("code",[t._v("vnode")]),t._v(" å‡½æ•°ã€‚ä¹‹åæˆ‘ä»¬ç»§ç»­æ‰¾ "),a("code",[t._v("vnode")]),t._v(" çš„æ–‡ä»¶ï¼Œåœ¨ "),a("code",[t._v("src|vnode.ts")]),t._v(" æ–‡ä»¶ä¸­ã€‚"),a("strong",[t._v("é™„ä¸Šæœ€å…³é”®éƒ¨åˆ†ä»£ç ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("vnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sel")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Array"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("VNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("elm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Element "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›ä¸€ä¸ªå¯¹è±¡")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// elmè¡¨ç¤ºvnodeç»“æ„å¯¹åº”çš„æ˜¯å“ªä¸€ä¸ªDOMå…ƒç´ ")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// keyå¯ä»¥ç†è§£ä¸ºv-foræ—¶æˆ‘ä»¬ä½¿ç”¨çš„key")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" children"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[t._v("åŒæ ·å®šä½åˆ°æœ€åä¸€è¡Œï¼Œå¤§å®¶å¯ä»¥å‘ç°ï¼Œ "),a("code",[t._v("vnode")]),t._v(" å®é™…ä¸Šæ˜¯è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚è€Œè¿™ä¸ªå¯¹è±¡é‡Œï¼Œæœ‰ 6 ä¸ªå…ƒç´ ã€‚å…¶ä¸­ï¼Œ "),a("code",[t._v("sel, data, children, text")]),t._v(" å››ä¸ªå…ƒç´ å¯¹åº”æˆ‘ä»¬ä¸Šé¢è®² "),a("code",[t._v("vnode")]),t._v(" æ—¶å¯¹åº”çš„ç»“æ„ï¼ˆç¬¬ä¸€ç‚¹çš„ç¬¬ 5 ç‚¹ï¼‰ã€‚è€Œ "),a("code",[t._v("elm")]),t._v(" è¡¨ç¤º "),a("code",[t._v("vnode")]),t._v(" ç»“æ„å¯¹åº”çš„æ˜¯å“ªä¸€ä¸ª "),a("code",[t._v("DOM")]),t._v(" å…ƒç´ ï¼Œæœ€åçš„ "),a("code",[t._v("key")]),t._v(" å¤§å®¶å¯ä»¥ç†è§£ä¸ºæ˜¯æˆ‘ä»¬ä½¿ç”¨ "),a("code",[t._v("v-for")]),t._v(" æ—¶ç”¨çš„ "),a("code",[t._v("key")]),t._v(" ï¼ŒåŒæ—¶éœ€è¦æ³¨æ„æ˜¯ï¼Œ "),a("code",[t._v("key")]),t._v(" ä¸ä¸€å®šåªæœ‰åœ¨ "),a("code",[t._v("v-for")]),t._v(" æ—¶å¯ä»¥ä½¿ç”¨ï¼Œåœ¨å®šä¹‰ç»„ä»¶ç­‰å„ç§åœºæ™¯æ—¶å‡å¯ä½¿ç”¨ã€‚")]),t._v(" "),a("h2",{attrs:{id:"_2ã€patch-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2ã€patch-å‡½æ•°"}},[t._v("#")]),t._v(" 2ã€patch å‡½æ•°")]),t._v(" "),a("p",[t._v("çœ‹å®Œ "),a("code",[t._v("vnode")]),t._v(" ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å¦‚ä½•ç”¨ patch å‡½æ•°æ¥å¯¹æ¯” "),a("code",[t._v("vnode")]),t._v(" ã€‚ä»å®˜æ–¹æ–‡æ¡£ä¸­æˆ‘ä»¬å¯ä»¥å®šä½åˆ°ï¼Œ "),a("code",[t._v("patch")]),t._v(" å‡½æ•°åœ¨ "),a("code",[t._v("src|init.ts")]),t._v(" æ–‡ä»¶ä¸‹ï¼Œæˆ‘ä»¬æ‰¾åˆ° "),a("code",[t._v("init.ts")]),t._v(" æ–‡ä»¶ã€‚åŒæ ·ï¼Œæˆ‘ä»¬å®šä½åˆ° "),a("code",[t._v("patch")]),t._v(" å‡½æ•°éƒ¨åˆ†ï¼Œ"),a("strong",[t._v("å…·ä½“ä»£ç å¦‚ä¸‹ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è¿”å›ä¸€ä¸ªpatchå‡½æ•°")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("oldVnode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" Element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vnode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("i")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("elm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("parent")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("insertedVnodeQueue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeQueue "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œpre hookï¼Œhook å³ DOM èŠ‚ç‚¹çš„ç”Ÿå‘½å‘¨æœŸ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("pre"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯vnodeï¼Œæ˜¯ä¸€ä¸ªDOMå…ƒç´ ")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// åˆ›å»ºä¸€ä¸ªç©ºçš„ vnodeï¼Œå…³è”åˆ°è¿™ä¸ªDOMå…ƒç´ ")]),t._v("\n      oldVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("emptyNodeAt")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç›¸åŒçš„vnodeï¼ˆkey å’Œ sel éƒ½ç›¸ç­‰ï¼‰")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vnodeè¿›è¡Œå¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä¸åŒçš„ vnode ï¼Œ ç›´æ¥åˆ æ‰é‡å»º")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      parent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("parentNode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" Node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// é‡å»º")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSibling")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parent"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hook"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("insert"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("post"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("é˜…è¯»ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæˆ‘ä»¬åˆšå¼€å§‹åˆ›å»ºæ—¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯ "),a("code",[t._v("vnode")]),t._v(" ï¼Œè€Œæ˜¯ä¸€ä¸ª "),a("code",[t._v("DOM")]),t._v(" å…ƒç´ ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦å…ˆåˆ›å»ºä¸€ä¸ªç©ºçš„ "),a("code",[t._v("vnode")]),t._v(" ï¼Œæ¥å…³è”åˆ°è¿™ä¸ª "),a("code",[t._v("DOM")]),t._v(" å…ƒç´ ä¸Šã€‚")]),t._v(" "),a("p",[t._v("æœ‰äº†ç¬¬ä¸€ä¸ª "),a("code",[t._v("vnode")]),t._v(" ä¹‹åï¼Œæˆ‘ä»¬åœ¨ç¬¬äºŒæ¬¡ "),a("code",[t._v("patch")]),t._v(" æ—¶ï¼Œå°±å¯ä»¥å¯¹æ–°æ—§èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚è€Œæ–°æ—§èŠ‚ç‚¹çš„æ¯”è¾ƒæ˜¯å…ˆåˆ¤æ–­ "),a("code",[t._v("key")]),t._v(" å’Œ "),a("code",[t._v("sel")]),t._v(" æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒï¼Œåˆ™ç”¨ "),a("code",[t._v("pathVNode")]),t._v(" å‡½æ•°å¯¹æ–°æ—§èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœæ˜¯ä¸åŒçš„ "),a("code",[t._v("vnode")]),t._v(" ï¼Œåˆ™ç›´æ¥åˆ æ‰é‡å»ºã€‚")]),t._v(" "),a("h2",{attrs:{id:"_3ã€patchvnode-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3ã€patchvnode-å‡½æ•°"}},[t._v("#")]),t._v(" 3ã€patchVnode å‡½æ•°")]),t._v(" "),a("p",[t._v("ä¸Šé¢æˆ‘ä»¬è¯´åˆ°äº† "),a("code",[t._v("patchVnode")]),t._v(" å‡½æ•°è¿›è¡Œæ–°æ—§èŠ‚ç‚¹çš„æ¯”è¾ƒï¼Œä¸‹é¢æ¥å¯¹ "),a("code",[t._v("patchVnode")]),t._v(" è¿›è¡Œè¯¦ç»†å‰–æã€‚åŒæ ·åœ¨ "),a("code",[t._v("src|init.ts")]),t._v(" æ–‡ä»¶ä¸­ï¼Œ"),a("strong",[t._v("é™„ä¸Š patchVnode å‡½æ•°çš„ä»£ç ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("oldVnode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("vnode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("insertedVnodeQueue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeQueue")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‰§è¡Œprepatch hook")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hook "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("hook"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    hook"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("prepatch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®vnode.elem")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ—§çš„ children")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–°çš„children")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ch "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("children "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å½“æ–°æ—§èŠ‚ç‚¹ç›¸ç­‰æ—¶åˆ™è¿”å›")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hook ç›¸å…³")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" i "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        cbs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("hook"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("update"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vnode.text === undefined (vnode.children ä¸€èˆ¬æœ‰å€¼ï¼›childrenå’Œtextåªèƒ½å­˜åœ¨ä¸€ä¸ªï¼Œä¸èƒ½å…±å­˜)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUndef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–°æ—§vnodeéƒ½æœ‰children")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// updateChildren ä¸¤è€…éƒ½æœ‰childrenæ—¶è¦è¿›è¡Œå¯¹æ¯”")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ–°çš„vnodeæœ‰chindrenï¼Œæ—§çš„vnodeæ²¡æœ‰children ï¼ˆæ—§çš„vnodeæœ‰textï¼‰")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ¸…ç©ºæ—§çš„vnodeçš„text")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ·»åŠ children")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ch"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ—§çš„vnodeæœ‰childrenï¼Œæ–°çš„vnodeæ²¡æœ‰children")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç§»é™¤æ—§vnodeçš„children")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ—§çš„vnodeæœ‰text")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// else: vnode.text != undefined (è¯´æ˜ vnode.text æœ‰å€¼ï¼Œæ—§çš„vnode.children æ²¡æœ‰å€¼)")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç§»é™¤æ—§vnodeçš„children")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isDef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// è®¾ç½®æ–°çš„text")]),t._v("\n      api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTextContent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("text"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    hook"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),t._v("postpatch"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?.")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("é˜…è¯»ä»¥ä¸Šæºç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š")])]),t._v(" "),a("p",[a("strong",[t._v("ï¼ˆ1ï¼‰")]),t._v(" å½“æ—§çš„ "),a("code",[t._v("vnode")]),t._v(" æœ‰ "),a("code",[t._v("text")]),t._v(" æ—¶ï¼Œåˆ™è¯´æ˜æ—§çš„ "),a("code",[t._v("children")]),t._v(" æ²¡æœ‰å€¼ï¼Œä¸”æ–°çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("text")]),t._v(" æœ‰å€¼ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æŠŠæ—§çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("children")]),t._v(" è¿›è¡Œåˆ é™¤ï¼Œåˆ é™¤ç»“æŸç»™æ–°çš„ "),a("code",[t._v("vnode")]),t._v(" è®¾ç½® "),a("code",[t._v("text")]),t._v(" ï¼›")]),t._v(" "),a("p",[a("strong",[t._v("ï¼ˆ2ï¼‰")]),t._v(" å½“æ–°æ—§èŠ‚ç‚¹éƒ½æœ‰ "),a("code",[t._v("children")]),t._v(" æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œæ›´æ–°æ“ä½œï¼Œä¹Ÿå°±æ˜¯æ“ä½œ "),a("code",[t._v("updateChildren")]),t._v(" å‡½æ•°ã€‚è¿™ä¸ªæˆ‘ä»¬å°†åœ¨ä¸‹é¢è¿›è¡Œè®²è§£ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ï¼ˆ3ï¼‰")]),t._v(" å¦‚æœæ–°çš„ "),a("code",[t._v("vnode")]),t._v(" æœ‰ "),a("code",[t._v("children")]),t._v(" ï¼Œæ—§çš„ "),a("code",[t._v("vnode")]),t._v(" æ²¡æœ‰ "),a("code",[t._v("children")]),t._v(" ï¼Œåˆ™è¯´æ˜æ—§çš„ "),a("code",[t._v("vnode")]),t._v(" æœ‰ "),a("code",[t._v("text")]),t._v(" ï¼Œæ‰€ä»¥æ­¤æ—¶éœ€è¦æ¸…ç©ºæ—§çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("text")]),t._v(" ï¼Œå¹¶æ·»åŠ æ–°çš„ "),a("code",[t._v("children")]),t._v(" ä¸Šå»ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ï¼ˆ4ï¼‰")]),t._v(" å¦‚æœæ—§çš„ "),a("code",[t._v("vnode")]),t._v("æœ‰ "),a("code",[t._v("children")]),t._v(" ï¼Œæ–°çš„ "),a("code",[t._v("vnode")]),t._v(" æ²¡æœ‰ "),a("code",[t._v("children")]),t._v(" ï¼Œåˆ™ç§»é™¤æ—§çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("children")]),t._v(" ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ï¼ˆ5ï¼‰")]),t._v(" å¦‚æœæ–°æ—§èŠ‚ç‚¹éƒ½æœ‰ "),a("code",[t._v("text")]),t._v(" ï¼Œåˆ™ç›´æ¥æŠŠæ–°çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("text")]),t._v(" å€¼èµ‹å€¼ç»™æ—§çš„ "),a("code",[t._v("vnode")]),t._v(" çš„ "),a("code",[t._v("text")]),t._v(" ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("æ¥çœ‹ä¸‹å›¾çš„å‘ˆç°ï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605140953440.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic_center",alt:" æ–°æ—§èŠ‚ç‚¹çš„å¯¹æ¯”"}})]),t._v(" "),a("h2",{attrs:{id:"_4ã€updatechildren-å‡½æ•°"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4ã€updatechildren-å‡½æ•°"}},[t._v("#")]),t._v(" 4ã€updateChildren å‡½æ•°")]),t._v(" "),a("p",[t._v("ä¸Šé¢åˆ†æ "),a("code",[t._v("pathVnode")]),t._v(" æ—¶æˆ‘ä»¬è®²åˆ°äº†ç”¨ "),a("code",[t._v("updateChildren")]),t._v(" å‡½æ•°æ¥æ›´æ–°æ–°æ—§èŠ‚ç‚¹çš„ "),a("code",[t._v("children")]),t._v(" ã€‚"),a("strong",[t._v("æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸‹è¿™ä¸ªå‡½æ•°ï¼š")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateChildren")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token parameter"}},[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("parentElm")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("oldCh")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("newCh")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("insertedVnodeQueue")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNodeQueue")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("oldKeyToIdx")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" KeyToIndexMap "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("idxInOld")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("elmToMove")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" VNode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("before")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" oldEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Vnode might have been moved left")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¼€å§‹å’Œå¼€å§‹è¿›è¡Œå¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç»“æŸå’Œç»“æŸè¿›è¡Œå¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¼€å§‹å’Œç»“æŸåšå¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Vnode moved right")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("nextSibling")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oldStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ç»“æŸå’Œå¼€å§‹åšå¯¹æ¯”")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sameVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Vnode moved left")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        oldEndVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ä»¥ä¸Šå››ä¸ªéƒ½æœªå‘½ä¸­")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldKeyToIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          oldKeyToIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createKeyToOldIdx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ‹¿æ–°èŠ‚ç‚¹çš„keyï¼Œèƒ½å¦å¯¹åº”ä¸ŠoldChä¸­çš„æŸä¸ªèŠ‚ç‚¹çš„key")]),t._v("\n        idxInOld "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldKeyToIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" string"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// æ²¡æœ‰å¯¹åº”ä¸Š")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isUndef")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// New element")]),t._v("\n          api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n            parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹åº”ä¸Šäº†")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// å¯¹åº”ä¸Škeyçš„èŠ‚ç‚¹")]),t._v("\n          elmToMove "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n          "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// selæ˜¯å¦ç›¸ç­‰ï¼ˆsameVnodeçš„æ¡ä»¶ï¼‰")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sel "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sel"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// selä¸ç›¸ç­‰ï¼Œå¯èƒ½åªæ˜¯keyç›¸ç­‰ï¼›é‚£ä¹Ÿæ²¡æœ‰ç”¨ï¼Œåªèƒ½é‡å»º New Element")]),t._v("\n            api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n              parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n              oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// sel ç›¸ç­‰ï¼Œkey ç›¸ç­‰ï¼›æ‰§è¡ŒpatchVnodeå‡½æ•°")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("patchVnode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" newStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" insertedVnodeQueue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("idxInOld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("undefined")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" any"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            api"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("insertBefore")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" elmToMove"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartVnode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        newStartVnode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),t._v("newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" oldEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" newStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("oldStartIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        before "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("newEndIdx "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("elm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("addVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n          parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          before"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          newCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          newStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          newEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          insertedVnodeQueue\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("removeVnodes")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("parentElm"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldCh"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldStartIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" oldEndIdx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("p",[a("strong",[t._v("æˆ‘ä»¬å…ˆæ¥çœ‹ä¸¤å¼ å›¾ï¼š")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605141011555.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic_center",alt:"updateChildrenå›¾ç¤º1"}}),t._v(" "),a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20210605141018189.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDgwMzc1Mw==,size_16,color_FFFFFF,t_70#pic_center",alt:"updateChildrenå›¾ç¤º2"}})]),t._v(" "),a("p",[t._v("å¤§å®¶å…ˆçœ‹å›¾ 1ï¼Œ "),a("code",[t._v("updateChildren")]),t._v(" è¦åšå¾—äº‹æƒ…å°±æ˜¯ï¼Œå°†æ–°æ—§èŠ‚ç‚¹è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœç›¸åŒåˆ™ä¸è¿›è¡Œæ›´æ–°ï¼Œå¦‚æœä¸åŒåˆ™å¯¹å…¶è¿›è¡Œæ›´æ–°æ“ä½œã€‚")]),t._v(" "),a("p",[t._v("å†çœ‹å›¾ 2ï¼Œè€Œæ›´æ–°çš„æ–¹å¼å°±æ˜¯ï¼Œé€šè¿‡å¯¹"),a("strong",[t._v("oldStartIdx")]),t._v("ï¼Œ"),a("strong",[t._v("newStartIdx")]),t._v("ï¼Œ"),a("strong",[t._v("oldEndIdx")]),t._v("å’Œ"),a("strong",[t._v("newEndIdx")]),t._v("è¿™å››ä¸ªå€¼è¿›è¡Œæ¯”è¾ƒï¼Œæ¥å¾—å‡ºæ˜¯å¦éœ€è¦æ›´æ–°æ“ä½œã€‚")]),t._v(" "),a("p",[t._v("é‚£è¿™å››ä¸ªå€¼å¦‚ä½•è¿›è¡Œæ¯”è¾ƒå‘¢ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­çœ‹ã€‚")]),t._v(" "),a("p",[t._v("é˜…è¯»æºç æˆ‘ä»¬å¯ä»¥åˆ†æå‡ºï¼Œé€šè¿‡å¯¹"),a("strong",[t._v("4 ç§ç±»å‹")]),t._v("çš„èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒï¼Œæ¥"),a("strong",[t._v("åˆ¤æ–­å¦‚ä½•æ›´æ–°èŠ‚ç‚¹")]),t._v("ã€‚")]),t._v(" "),a("p",[a("strong",[t._v("ç¬¬ä¸€ç§")]),t._v("ï¼Œæ—§çš„å¼€å§‹èŠ‚ç‚¹ "),a("code",[t._v("oldStartIdx")]),t._v(" å’Œæ–°çš„å¼€å§‹èŠ‚ç‚¹ "),a("code",[t._v("newStartIdx")]),t._v(" æ¯”è¾ƒã€‚"),a("strong",[t._v("ç¬¬äºŒç§")]),t._v("ï¼Œæ—§çš„å¼€å§‹èŠ‚ç‚¹ "),a("code",[t._v("oldStartIdx")]),t._v(" å’Œæ–°çš„ç»“æŸèŠ‚ç‚¹ "),a("code",[t._v("newEndIdx")]),t._v(" æ¯”è¾ƒã€‚"),a("strong",[t._v("ç¬¬ä¸‰ç§")]),t._v("ï¼Œæ—§çš„ç»“æŸèŠ‚ç‚¹ "),a("code",[t._v("oldEndIdx")]),t._v(" å’Œæ–°çš„å¼€å§‹èŠ‚ç‚¹ "),a("code",[t._v("newStartIdx")]),t._v(" æ¯”è¾ƒã€‚"),a("strong",[t._v("ç¬¬å››ç§")]),t._v("ï¼Œæ—§çš„ç»“æŸèŠ‚ç‚¹ "),a("code",[t._v("oldEndIdx")]),t._v(" å’Œæ–°çš„ç»“æŸèŠ‚ç‚¹ "),a("code",[t._v("newEndIdx")]),t._v(" æ¯”è¾ƒã€‚")]),t._v(" "),a("p",[t._v("å¦‚æœä»¥ä¸Šè¿™å››ç§æ¯”è¾ƒéƒ½æ²¡æœ‰å‘½ä¸­ï¼Œåˆ™æ‹¿å–æ–°èŠ‚ç‚¹çš„"),a("code",[t._v("key")]),t._v(" ï¼Œä¹‹åå°†è¿™ä¸ª "),a("code",[t._v("key")]),t._v(" æŸ¥çœ‹æ˜¯å¦å¯¹åº”ä¸Š "),a("code",[t._v("oldCh")]),t._v(" ä¸­æŸä¸ªèŠ‚ç‚¹çš„ "),a("code",[t._v("key")]),t._v(" ã€‚"),a("strong",[t._v("å¦‚æœæ²¡æœ‰å¯¹åº”ä¸Š")]),t._v("ï¼Œåˆ™ç›´æ¥"),a("strong",[t._v("é‡å»ºå…ƒç´ ")]),t._v("ã€‚"),a("strong",[t._v("å¦‚æœå¯¹åº”ä¸Šäº†")]),t._v("ï¼Œè¿˜è¦å†åˆ¤æ–­ "),a("code",[t._v("sel")]),t._v(" å’Œ "),a("code",[t._v("key")]),t._v(" æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰ï¼Œåˆ™"),a("strong",[t._v("æ‰§è¡Œ patchVnode å‡½æ•°")]),t._v("ï¼Œå¦‚æœä¸ç›¸ç­‰ï¼Œé‚£è·Ÿå‰é¢ä¸€æ ·ï¼Œä¹Ÿåªèƒ½"),a("strong",[t._v("é‡å»ºå…ƒç´ ")]),t._v("ã€‚")]),t._v(" "),a("h1",{attrs:{id:"å››ã€ç»“æŸè¯­"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€ç»“æŸè¯­"}},[t._v("#")]),t._v(" å››ã€ç»“æŸè¯­")]),t._v(" "),a("p",[t._v("vdom çš„æ ¸å¿ƒæ¦‚å¿µä¸»è¦åœ¨ "),a("code",[t._v("h")]),t._v(" ã€ "),a("code",[t._v("vnode")]),t._v(" ã€ "),a("code",[t._v("patch")]),t._v(" ã€ "),a("code",[t._v("diff")]),t._v(" ã€ "),a("code",[t._v("key")]),t._v(" è¿™å‡ ä¸ªå†…å®¹ï¼Œä¸ªäººè§‰å¾—ï¼Œæ•´ä¸ª "),a("code",[t._v("diff")]),t._v(" çš„æ¯”è¾ƒéƒ½åœ¨å›´ç»•ç€è¿™å‡ ä¸ªå‡½æ•°è¿›è¡Œï¼Œæ‰€ä»¥äº†è§£è¿™å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µå¾ˆé‡è¦ã€‚åŒæ—¶ï¼Œvdom å­˜åœ¨çš„å¦ä¸€ä¸ªæ›´é‡è¦çš„ä»·å€¼è«è¿‡äºæ•°æ®é©±åŠ¨è§†å›¾äº†ï¼Œ "),a("code",[t._v("vdom")]),t._v(" é€šè¿‡æ§åˆ¶ "),a("code",[t._v("DOM")]),t._v(" çš„æ“ä½œæ¥"),a("strong",[t._v("ä½¿å¾—æ•°æ®å¯ä»¥å»é©±åŠ¨è§†å›¾")]),t._v("ã€‚")]),t._v(" "),a("p",[t._v("å…³äºè™šæ‹Ÿ DOM å’Œ diff çš„è®²è§£åˆ°æ­¤å°±ç»“æŸå•¦ï¼å¦‚æœ‰ä¸ç†è§£æˆ–æœ‰è¯¯çš„åœ°æ–¹æ¬¢è¿è¯„è®ºåŒºè¯„è®ºæˆ–ç§ä¿¡æˆ‘äº¤æµ~")]),t._v(" "),a("blockquote",[a("ul",[a("li",[t._v("å…³æ³¨å…¬ä¼—å· "),a("strong",[t._v("æ˜ŸæœŸä¸€ç ”ç©¶å®¤")]),t._v(" ï¼Œä¸å®šæœŸåˆ†äº«å­¦ä¹ å¹²è´§ï¼Œå­¦ä¹ è·¯ä¸Šä¸è¿·è·¯~")]),t._v(" "),a("li",[t._v("å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œè®°å¾—"),a("strong",[t._v("ç‚¹ä¸ªèµåŠ ä¸ªå…³æ³¨")]),t._v("å†èµ°å“¦~")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);