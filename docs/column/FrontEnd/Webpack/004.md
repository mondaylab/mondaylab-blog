---
title: webpackå®æˆ˜ä¹‹æ‰‹å†™ä¸€ä¸ªloaderå’Œplugin
author: å‘¨ä¸€
date: '2021-08-05'
categories:
  - å‰ç«¯å¼€å‘
tags:
  - Webpack
sidebar: 'auto'
---

# ğŸ”” åºè¨€

å¯¹äº `webpack` æ¥è¯´ï¼Œ `loader` å’Œ `plugin` å¯ä»¥ç®—æ˜¯éœ€æ±‚ç¨‹åº¦æœ€ä¸ºå¹¿æ³›çš„é…ç½®é¡¹äº†ã€‚ä½†æ˜¯å‘¢ï¼Œå•å•æ­¢æ­¥äºé…ç½®å¯èƒ½è¿˜ä¸å¤Ÿã€‚å¦‚æœæˆ‘ä»¬è‡ªå·±æœ‰æ—¶å€™æƒ³è¦ `diy` ä¸€ä¸ªéœ€æ±‚ï¼Œä½†æ˜¯ `webpack` åˆæ²¡æœ‰ç›¸å…³çš„ `loader` å’Œ `plugin` ã€‚é‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯èƒ½å°±å¾—å¼€å§‹é€ ç‚¹è½®å­æ¥ä¾›ç»™è‡ªå·±ä½¿ç”¨äº†ã€‚

å› æ­¤ï¼Œåœ¨ä»Šå¤©çš„æ–‡ç« å½“ä¸­ï¼Œå°†å¸¦é¢†å¤§å®¶æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„ `loader` å’Œ `plugin` ï¼Œå¹¶å­¦ä¼šå¦‚ä½•åœ¨é¡¹ç›®ä¸­è¿ç”¨è‡ªå·±æ‰€ç¼–å†™çš„ `loader` å’Œ `plugin` ã€‚

ä¸€èµ·æ¥å­¦ä¹ å§~ğŸ“¢

# ğŸµ ä¸€ã€å¦‚ä½•ç¼–å†™ä¸€ä¸ª Loader

## 1. ç¢ç¢å¿µ

ä¹‹å‰çš„æ–‡ç« ä¸­æˆ‘ä»¬è®²åˆ°äº†å…³äº `loader` çš„ä¸€äº›é…ç½®ã€‚é‚£å¦‚æœæŠŠé‚£äº›å¼•ç”¨çš„ `loader` æ”¹ä¸ºæˆ‘ä»¬å†™çš„ `loader` ï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹ï¼Œå¦‚ä½•æ‰‹å†™ä¸€ä¸ªç®€æ˜“çš„ `loader` ï¼Œå¹¶è¿ç”¨åˆ°æˆ‘ä»¬çš„é¡¹ç›®å½“ä¸­ã€‚

## 2. é¡¹ç›®ç»“æ„

é¦–å…ˆç”¨ä¸€å¼ å›¾ï¼Œæ¥çœ‹æˆ‘ä»¬çš„**é¡¹ç›®ç»“æ„**ã€‚**å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š**

![loaderé¡¹ç›®ç»“æ„](https://mondaylab-1309616765.cos.ap-shanghai.myqcloud.com/images/202305270746613.png)

å…¶ä¸­ `loaders` æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®æˆ‘ä»¬æƒ³è¦å†™çš„ `loader` ï¼ŒåŒæ—¶é‡Œé¢çš„ `replaceLoader.js` æ–‡ä»¶æ”¾ç½®æˆ‘ä»¬å³å°†è¦å†™çš„ `loader` çš„ä»£ç é€»è¾‘ã€‚ä¹‹åï¼Œ`index.js` æ–‡ä»¶æ˜¯æˆ‘ä»¬çš„**å…¥å£æ–‡ä»¶**ï¼Œæ”¾ç½®æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ã€‚ `webpack.config.js` æ–‡ä»¶æ”¾ç½®å…³äº `webpack` çš„ç›¸å…³é…ç½®ï¼Œè€Œ `dist` æ–‡ä»¶å¤¹å†…çš„å†…å®¹ï¼Œæ”¾ç½®çš„æ˜¯æˆ‘ä»¬é€šè¿‡ `webpack` æ‰“åŒ…åï¼Œç”Ÿæˆçš„æ‰“åŒ…æ–‡ä»¶ã€‚

## 3. ä¸šåŠ¡ä»£ç ç¼–å†™

### ï¼ˆ1ï¼‰å…¥å£æ–‡ä»¶ä»£ç 

ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆæ¥ç¼–å†™å…¥å£æ–‡ä»¶ `index.js` çš„ä»£ç ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
console.log('hello monday');
```

### ï¼ˆ2ï¼‰ç¼–å†™ loader

å…¥å£æ–‡ä»¶çš„å†…å®¹å¾ˆç®€å•ï¼Œæˆ‘ä»¬æƒ³è¦è¾¾åˆ°çš„ç›®çš„å°±æ˜¯è¾“å‡º `hello monday` è¿™ä¸ªè¯­å¥ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ç¼–å†™ `loader` çš„å†…å®¹ï¼Œå·²è¾¾åˆ°å¯¹å…¥å£æ–‡ä»¶ `index.js` çš„å†…å®¹è¿›è¡Œä¿®æ”¹ã€‚ `replaceLoader.js` æ–‡ä»¶çš„**ä»£ç å…·ä½“å¦‚ä¸‹ï¼š**

```js
module.exports = function (source) {
  const result = source.replace('monday', 'mondaylab');
  this.callback(null, result);
};
```

---

ä»¥ä¸Šçš„ä»£ç æ„æ€ä¸ºï¼Œå°†å…¥å£æ–‡ä»¶ `index.js` æ–‡ä»¶ä¸­çš„ `monday` æ›¿æ¢ä¸º `mondaylab` ã€‚è¿™æ ·å†™ä¼¼ä¹æ²¡å•¥é—®é¢˜ï¼Œä½†æ˜¯å¤§å®¶æœ‰æ²¡æœ‰æƒ³è¿‡ï¼Œæˆ‘ä»¬æœ‰æ—¶å€™ä¼ çš„å±æ€§å¯èƒ½ä¼šå¾ˆè¯¡å¼‚ï¼Œä¸ä¸€å®šæ¯æ¬¡éƒ½èƒ½åƒè¿™æ ·ä»¥å­—ç¬¦ä¸²çš„å½¢å¼æ¥æ›¿æ¢ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼•ç”¨ `webpack` å®˜æ–¹æ¨èçš„ `loadertils` è¿™ä¸ªå·¥å…·ï¼Œæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£… `loader-utils` æ’ä»¶ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npm install loader-utils --save-dev
```

**ç¬¬äºŒæ­¥ï¼š** æ”¹é€  `loader` æ–‡ä»¶ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯¹ `replaceLoader.js` æ–‡ä»¶è¿›è¡Œæ”¹é€ å‡çº§ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const loaderUtils = require('loader-utils');

//ç”¨functionçš„åŸå› åœ¨äºä¸ºäº†ä¸šåŠ¡å±‚å¯ä»¥è°ƒç”¨this
//sourceä¸ºå¼•å…¥æ–‡ä»¶çš„æºä»£ç 
module.exports = function (source) {
  //getOptionsä¼šè‡ªåŠ¨åœ°å¸®æˆ‘ä»¬åˆ†æthis.query,ç„¶åæŠŠå‚æ•°çš„æ‰€æœ‰å†…å®¹æ”¾åœ¨optionsé‡Œé¢å»
  const options = loaderUtils.getOptions(this);

  const result = source.replace('monday', options.name);

  this.callback(null, result);
};
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨ `loaderUtils` æ’ä»¶ï¼Œé—´æ¥åœ°ï¼Œè°ƒç”¨ `getOptions` æ–¹æ³•ï¼Œæ¥è‡ªåŠ¨çš„å¸®æˆ‘ä»¬åˆ†æ `this.query` ï¼Œä»è€Œå–åˆ°æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å†äº†è§£ä¸€ä¸‹ `this.callback` çš„å†…å®¹ã€‚

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬æ¥æ”¶åˆ°äº†æºä»£ç  `source` ï¼Œé‚£ä¹ˆç°åœ¨æˆ‘ä»¬åªèƒ½å¯¹æºä»£ç åšå¤„ç†ã€‚ä½†æ˜¯å‘¢ï¼Œæœ‰çš„æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³è¦ä½¿ç”¨ä¸€äº› `sourceMap` ï¼Œæˆ–è€…å¯¹æºä»£ç åˆ†æå¥½äº†ä¹‹åï¼Œæˆ‘ä»¬ä¸ä»…æƒ³è¦è¿”å›æºä»£ç ï¼Œè¿˜è¦æŠŠ `sourceMap` ä¹Ÿå¸¦å›å»ã€‚

å› ä¸ºæˆ‘ä»¬ `return` çš„æ—¶å€™åªèƒ½ `return` ä¸€ä¸ªå‚æ•°ï¼Œå…¶ä½™çš„ä¸€äº›é¢å¤–çš„å†…å®¹å°±å¸¦ä¸å‡ºå»äº†ã€‚è¿™ä¸ªæ—¶å€™å‘¢ï¼Œæˆ‘ä»¬å°±éœ€è¦ `this.callback` æ¥å¸®æˆ‘ä»¬æŠŠ `sourceMap` ç»™å¸¦å‡ºå»ã€‚å› æ­¤ï¼Œä¸€èˆ¬ç”¨ `this.callback` æ¥è¿”å›å†…å®¹ã€‚

### ï¼ˆ3ï¼‰å¼•ç”¨ loader

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ `webpack.config.js` ä¸­ï¼Œæ¥å¼•å…¥æˆ‘ä»¬ä¸Šé¢çš„ `loader` ã€‚**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
const path = require('path');

module.exports = {
  mode: 'development',
  entry: {
    main: './src/index.js',
  },
  module: {
    rules: [
      {
        test: /\.js/,
        use: [
          {
            loader: path.resolve(__dirname, './loaders/replaceLoader.js'),
            //ä¸Šé¢çš„options.nameä¸­çš„name
            options: {
              name: 'mondaylab',
            },
          },
        ],
      },
    ],
  },
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: '[name].js',
  },
};
```

é€šè¿‡ä»¥ä¸Šæ–¹å¼ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ªç®€æ˜“çš„ `loader` ï¼Œè¿™ä¸ª `loader` å®ç°äº†å°† `monday` æ›¿æ¢ä¸º `mondaylab` çš„åŠŸèƒ½ã€‚å¹¶ä¸”ä¾›æˆ‘ä»¬åœ¨ `webpack` ä¸­ä½¿ç”¨è‡ªå·±ä¹¦å†™çš„ `loader` ã€‚

### ï¼ˆ4ï¼‰åœ¨ loader é‡Œé¢åšä¸€äº›å¼‚æ­¥çš„æ“ä½œ

å¥½äº†ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦ç»™ `loader` åšä¸€äº›å¼‚æ­¥æ“ä½œï¼Œè¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ

åœ¨æˆ‘ä»¬æ‰€å†™çš„ `loader` å½“ä¸­ï¼ŒåŠ å…¥å¼‚æ­¥æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è°ƒç”¨å®˜æ–¹æä¾›ç»™æˆ‘ä»¬çš„ `this.async()` è¿™ä¸ª `API` æ¥å®ç°ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ”¹é€ ä¸€ä¸‹ `replaceLoader.js` æ–‡ä»¶çš„ä»£ç ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const loaderUtils = require('loader-utils');

module.exports = function (source) {
  const options = loaderUtils.getOptions(this);
  //è°ƒç”¨this.async()è¿™ä¸ªAPIï¼Œæ¥ç»™å¼‚æ­¥ä»£ç ä½¿ç”¨
  const callback = this.async();

  setTimeout(() => {
    const result = source.replace('monday', options.name);
    callback(null, result);
  }, 1000);
};
```

é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ `loader` ä¸­ç¼–å†™å¼‚æ­¥ä»£ç ï¼Œæ¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚

### ï¼ˆ5ï¼‰loader è·¯å¾„è‡ªå®šä¹‰

æœ‰ä¸€ä¸ªå¾ˆå°çš„æ³¨æ„ç‚¹å°±æ˜¯ï¼Œå½“æˆ‘ä»¬åœ¨é…ç½® `webpack.config.js` æ–‡ä»¶ä¸­ï¼Œ `loader` çš„è·¯å¾„æ—¶ï¼Œæ¯å›éƒ½è¦ `path.resolve` å»å¯»æ‰¾è·¯å¾„æ–‡ä»¶ã€‚æ–‡ä»¶å°‘çš„æ—¶å€™è¿˜å¥½ï¼Œä½†å¦‚æœé‡åˆ°å¤šæ–‡ä»¶çš„æ—¶å€™å‘¢ï¼Ÿå²‚ä¸æ˜¯ä¼šå¾ˆéº»çƒ¦ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬å¼•ç”¨ `resolveLoader` æ¥ç®€åŒ–å®ƒã€‚ç°åœ¨æˆ‘ä»¬åœ¨ `webpack.config.js` æ–‡ä»¶ä¸­è¿›è¡Œæ”¹é€ ã€‚**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
const path = require('path');

module.exports = {
  // å…ˆåˆ°node_modulesä¸­å»æ‰¾ï¼Œæ‰¾ä¸åˆ°åˆ™å»./loadersç›®å½•ä¸‹å»æ‰¾
  resolveLoader: {
    modules: ['node_modules', './loaders'],
  },
  module: {
    rules: [
      {
        test: /\.js/,
        use: [
          {
            loader: 'replaceLoader',
          },
        ],
      },
    ],
  },
};
```

é€šè¿‡é…ç½® `resolveLoader` ï¼Œæ¥å¯¹æ–‡ä»¶æ–‡ä»¶ç›®å½•è¿›è¡ŒæŸ¥æ‰¾ï¼Œä»è€Œç®€åŒ–äº†è·¯å¾„å†…å®¹ã€‚

# ğŸ¶ äºŒã€å¦‚ä½•ç¼–å†™ä¸€ä¸ª Plugin

## 1. ç¢ç¢å¿µ

åœ¨è®²è§£ `plugin` ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ `loader` å’Œ `plugin` çš„åŒºåˆ«ã€‚

å½“æˆ‘ä»¬åœ¨æºä»£ç é‡Œé¢ï¼Œå»å¼•å…¥ä¸€ä¸ªæ–°çš„ `js` æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå…¶ä»–æ ¼å¼çš„æ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å€Ÿç”¨ `loader` ï¼Œæ¥å¸®æˆ‘ä»¬å¤„ç†æˆ‘ä»¬å¼•ç”¨çš„ `loader` æ–‡ä»¶ã€‚ `loader` çš„ä½œç”¨å°±åœ¨äºï¼Œå¸®åŠ©æˆ‘ä»¬**å¤„ç†å¼•ç”¨çš„æ¨¡å—**ã€‚

è€Œ `plugin` å‘¢ï¼Œæ˜¯å½“æˆ‘ä»¬åœ¨åšæ‰“åŒ…çš„æ—¶å€™ï¼Œåœ¨**æŸäº›å…·ä½“æ—¶åˆ»ä¸Š**ï¼Œæ¯”å¦‚è¯´ï¼Œå½“æˆ‘ä»¬æ‰“åŒ…ç»“æŸä¹‹åï¼Œæˆ‘ä»¬è¦ç”Ÿæˆä¸€ä¸ª `html` æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ä¸€ä¸ª `htmlWebpackPlugin` çš„æ’ä»¶ã€‚ä½¿ç”¨å®ƒä¹‹åï¼Œä»–å°±ä¼šåœ¨æ‰“åŒ…ç»“æŸä¹‹åï¼Œå¸®æˆ‘ä»¬ç”Ÿæˆå¯¹åº”çš„ `html` æ–‡ä»¶ã€‚

å†æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦åœ¨æ‰“åŒ…ä¹‹å‰ï¼ŒæŠŠ `dist` ç›®å½•è¿›è¡Œæ¸…ç©ºï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ `cleanWebpackPlugin` æ¥å¸®åŠ©æˆ‘ä»¬åšè¿™ä»¶äº‹æƒ…ã€‚

æ‰€ä»¥ï¼Œ `plugin` æ’ä»¶ï¼Œåœ¨ä»€ä¹ˆæ—¶å€™ç”Ÿæ•ˆå‘¢ï¼Ÿ

å®ƒåœ¨æˆ‘ä»¬**æ‰“åŒ…è¿‡ç¨‹ä¸­çš„æŸäº›æ—¶åˆ»é‡Œ**ï¼Œå°±æ˜¯**æ’ä»¶ç”Ÿæ•ˆçš„åœºæ™¯**ã€‚

`plugin` çš„ç¼–å†™ç›¸å¯¹äº `loader` æ¥è¯´ï¼Œä¼šéš¾ä¸€ç‚¹ç‚¹ã€‚ä½†æ˜¯å‘¢ï¼Œå¦‚æœæœ‰çœ‹è¿‡ `webpack` æºç çš„å°ä¼™ä¼´ä»¬å¯èƒ½ä¼šçŸ¥é“ï¼Œ `webpack` çš„ä¸€äº›åº•å±‚åŸç†éƒ½æ˜¯ä¾æ® `plugin` æ¥è¿›è¡Œç¼–å†™çš„ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯æœ‰å¿…è¦æ¥å­¦ä¹ ä¸€ä¸‹ `plugin` çš„ç¼–å†™ã€‚

ä¸‹é¢å°±å¸¦é¢†å¤§å®¶æ¥ç¼–å†™ä¸€ä¸ªç®€æ˜“çš„ `plugin` ~

## 2. é¡¹ç›®ç»“æ„

å¯¹äº `webpack` çš„ `plugin` æ¥è¯´ï¼Œå®ƒæ˜¯æ˜¯åŸºäº**å‘å¸ƒè€…è®¢é˜…**çš„è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯åŸºäº**äº‹ä»¶é©±åŠ¨**æ¥å®ç°çš„ã€‚åœ¨è¿™ä¸ªäº‹ä»¶é©±åŠ¨é‡Œï¼Œä»£ç ä¹‹é—´çš„æ‰§è¡Œï¼Œæ˜¯é€šè¿‡äº‹ä»¶æ¥è¿›è¡Œé©±åŠ¨çš„ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥å†™ä¸€ä¸ªç®€æ˜“çš„ `plugin` ã€‚

é¦–å…ˆç”¨ä¸€å¼ å›¾ï¼Œæ¥çœ‹æˆ‘ä»¬çš„**é¡¹ç›®ç»“æ„**ã€‚**å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š**

![pluginé¡¹ç›®ç»“æ„](https://mondaylab-1309616765.cos.ap-shanghai.myqcloud.com/images/202305270746252.png)

å…¶ä¸­ `plugins` æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®æˆ‘ä»¬æƒ³è¦å†™çš„ `plugin` ï¼ŒåŒæ—¶é‡Œé¢çš„ `copyright-webpack-plugin.js` æ–‡ä»¶æ”¾ç½®æˆ‘ä»¬å³å°†è¦å†™çš„ `plugin` çš„ä»£ç é€»è¾‘ã€‚ä¹‹åï¼Œ`index.js` æ–‡ä»¶æ˜¯æˆ‘ä»¬çš„**å…¥å£æ–‡ä»¶**ï¼Œæ”¾ç½®æˆ‘ä»¬çš„ä¸šåŠ¡é€»è¾‘ã€‚ `webpack.config.js` æ–‡ä»¶æ”¾ç½®å…³äº `webpack` çš„ç›¸å…³é…ç½®ï¼Œè€Œ `dist` æ–‡ä»¶å¤¹å†…çš„å†…å®¹ï¼Œæ”¾ç½®çš„æ˜¯æˆ‘ä»¬é€šè¿‡ `webpack` æ‰“åŒ…åï¼Œç”Ÿæˆçš„æ‰“åŒ…æ–‡ä»¶ã€‚

## 3. ä¸šåŠ¡ä»£ç ç¼–å†™

### ï¼ˆ1ï¼‰å…¥å£æ–‡ä»¶ä»£ç 

ç°åœ¨ï¼Œæˆ‘ä»¬å…ˆæ¥ç¼–å†™å…¥å£æ–‡ä»¶ `index.js` çš„ä»£ç ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
console.log('hello monday');
```

### ï¼ˆ2ï¼‰ç¼–å†™ plugin

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥ç¼–å†™ `plugin` çš„å†…å®¹ï¼Œ `copyright-webpack-plugin.js` æ–‡ä»¶çš„**ä»£ç å…·ä½“å¦‚ä¸‹ï¼š**

```js
class CopyrightWebpackPlugin {
  //ç¼–å†™ä¸€ä¸ªæ„é€ å™¨
  constructor(options) {
    console.log(options);
  }

  apply(compiler) {
    //é‡åˆ°åŒæ­¥æ—¶åˆ»
    compiler.hooks.compile.tap('CopyrightWebpackPlugin', () => {
      console.log('compiler');
    });

    //é‡åˆ°å¼‚æ­¥æ—¶åˆ»
    //å½“è¦æŠŠä»£ç æ”¾åˆ°distç›®å½•ä¹‹å‰ï¼Œè¦èµ°ä¸‹é¢è¿™ä¸ªå‡½æ•°
    //Compilationå­˜æ”¾æ‰“åŒ…çš„æ‰€æœ‰å†…å®¹ï¼ŒCompilation.assetsæ”¾ç½®ç”Ÿæˆçš„å†…å®¹
    compiler.hooks.emit.tapAsync(
      'CopyrightWebpackPlugin',
      (Compilation, cb) => {
        debugger;
        // å¾€ä»£ç ä¸­å¢åŠ ä¸€ä¸ªæ–‡ä»¶ï¼Œcopyright.txt
        Compilation.assets['copyright.txt'] = {
          source: function () {
            return 'copyright by monday';
          },
          size: function () {
            return 19;
          },
        };
        cb();
      }
    );
  }
}

module.exports = CopyrightWebpackPlugin;
```

ä¸Šé¢çš„è¿™ä¸ªæ’ä»¶ä¸­æƒ³è¦å®ç°çš„åŠŸèƒ½å°±æ˜¯ï¼Œ**è·å–ç‰ˆæƒä¿¡æ¯**ã€‚

### ï¼ˆ3ï¼‰å¼•ç”¨ plugin

ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ `webpack.config.js` ä¸­ï¼Œæ¥å¼•å…¥æˆ‘ä»¬ä¸Šé¢çš„ `plugin` ã€‚**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
const path = require('path');
const CopyrightWebpackPlugin = require('./plugins/copyright-webpack-plugin');

module.exports = {
  mode: 'development',
  entry: {
    main: './src/index.js',
  },
  plugins: [
    new CopyrightWebpackPlugin({
      name: 'monday',
    }),
  ],
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: '[name].js',
  },
};
```

é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œåœ¨ï¼ˆ2ï¼‰ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆéœ€è¦**å®šä¹‰ä¸€ä¸ªç±»**ï¼Œä¹‹åå‘¢ï¼Œåœ¨ç±»ä¸­å†™ä¸€ä¸ªæ„é€ å™¨å’Œä¸€ä¸ª `apply()` æ–¹æ³•æ¥è°ƒç”¨ã€‚ç„¶åå‘¢ï¼Œå¤§å®¶çœ‹åˆ°ï¼ˆ3ï¼‰ï¼Œé€šè¿‡ `require` çš„æ–¹å¼ï¼Œæ¥è¿›è¡Œ **new å®ä¾‹** ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªæ’ä»¶ï¼Œä»è€Œåœ¨é¡¹ç›®ä¸­ä½¿ç”¨è¿™ä¸ªæ’ä»¶ã€‚

æœ€ç»ˆï¼Œæˆ‘ä»¬é¡¹ç›®è¿›è¡Œæ‰“åŒ…æ—¶ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ª `dist` ç›®å½•ï¼Œå¹¶ä¸”åœ¨ç›®å½•ä¸‹å¢åŠ ä¸€ä¸ª `copyright.txt` æ–‡ä»¶ï¼Œå¹¶ä¸”æ–‡ä»¶ä¸­çš„å†…å®¹å°±æ˜¯ `copyright by monday` ã€‚

# ğŸ’¹ ä¸‰ã€ç»“æŸè¯­

åœ¨ä¸Šé¢çš„æ–‡ç« ä¸­ï¼Œè®²è§£äº†å…³äº loader å’Œ plugin çš„åŸºæœ¬ç¼–å†™æ€è·¯ï¼Œä»¥åŠå¦‚ä½•åœ¨é¡¹ç›®ä¸­å¯¹ä»–ä»¬è¿›è¡Œè¿ç”¨ï¼Œç›¸ä¿¡å¤§å®¶å¯¹è¿™ä¸€å—å†…å®¹æœ‰äº†åŸºç¡€çš„è®¤è¯†ã€‚

åˆ°è¿™é‡Œï¼Œloader å’Œ plugin çš„ç¼–å†™è®²è§£å°±ç»“æŸå•¦ï¼å¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©~

å¦‚æ–‡ç« æœ‰è¯¯æˆ–æœ‰ä¸ç†è§£çš„åœ°æ–¹ï¼Œæ¬¢è¿å°ä¼™ä¼´ä»¬è¯„è®ºåŒºç•™è¨€å“¦ ğŸ’¬

æœ¬æ–‡ä»£ç å·²ä¸Šä¼ è‡³å…¬ä¼—å·ï¼Œåå°å›å¤å…³é”®è¯ `webpack` å³å¯è·å–~

# ğŸ£ å½©è›‹ One More Thing

## ï¼ˆï¼šå¾€æœŸæ¨è

webpack å…¥é—¨æ ¸å¿ƒçŸ¥è¯† ğŸ‘‰[ä¸ä¼š webpack çš„å‰ç«¯å¯èƒ½æ˜¯æ¡æ¥çš„ï¼Œä¸‡å­—æ€»ç»“ webpack çš„è¶…å…¥é—¨æ ¸å¿ƒçŸ¥è¯†](https://blog.csdn.net/weixin_44803753/article/details/118728201)

webpack å…¥é—¨è¿›é˜¶çŸ¥è¯† ğŸ‘‰[webpack å…¥é—¨æ ¸å¿ƒçŸ¥è¯†è¿˜çœ‹ä¸è¿‡ç˜¾ï¼Ÿé€Ÿæ¥å›´è§‚ä¸‡å­—è¿›é˜¶çŸ¥è¯†](https://blog.csdn.net/weixin_44803753/article/details/118885391)

webpack å®æˆ˜æ¡ˆä¾‹é…ç½® ğŸ‘‰[ä¸‡å­—æ€»ç»“ webpack å®æˆ˜æ¡ˆä¾‹é…ç½®](https://blog.csdn.net/weixin_44803753/article/details/118977647)





