---
title: ä¸‡å­—æ€»ç»“webpackå®æˆ˜æ¡ˆä¾‹é…ç½®
author: å‘¨ä¸€
date: '2021-12-12'
categories:
  - å‰ç«¯å¼€å‘
tags:
  - Webpack
sidebar: 'auto'
---

![å°é¢](https://img-blog.csdnimg.cn/img_convert/f0afc3174fcc8b155da06988165a769f.png#pic_center)

@[toc](ä¸€æ–‡äº†è§£webpackä¸­å¸¸è§å®æˆ˜æ¡ˆä¾‹é…ç½®)

# ğŸ›´ åºè¨€

åœ¨[å‰é¢çš„ä¸¤ç¯‡æ–‡ç« ](https://blog.csdn.net/weixin_44803753/category_11123550.html?spm=1001.2014.3001.5482)ä¸­ï¼Œæˆ‘ä»¬è®²è§£äº† `webpack` çš„å…¥é—¨çŸ¥è¯†ã€‚ä½†æ˜¯å‘¢ï¼Œå…¥é—¨çŸ¥è¯†äº†è§£äº†ä¹‹åï¼Œæ€»å¾—åº”ç”¨åˆ°å…·ä½“çš„æ¡ˆä¾‹å½“ä¸­æ¥ã€‚

å› æ­¤ï¼Œåœ¨ä¸‹é¢çš„è¿™ç¯‡æ–‡ç« ä¸­ï¼Œå°†å¸¦é¢†å¤§å®¶æ¥äº†è§£å…³äº `webpack` çš„ä¸€äº›å®æˆ˜æ¡ˆä¾‹é…ç½®ï¼ŒåŒ…æ‹¬ç¬¬ä¸‰æ–¹åº“ã€ `PWA` ã€ `ts` çš„æ‰“åŒ…é…ç½®ï¼Œä»¥åŠ `WebpackDevServer` çš„è¿›é˜¶æ“ä½œï¼Œè¿˜æœ‰éœ€é‡ç‚¹æŒæ¡çš„ï¼Œå…³äº `webpack` å¦‚ä½•åšæ€§èƒ½ä¼˜åŒ–å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚

ä¸‹é¢å¼€å§‹æœ¬æ–‡çš„ä»‹ç»~ğŸš¦

# ğŸšŒ ä¸€ã€Library çš„æ‰“åŒ…

å‡è®¾æˆ‘ä»¬ç°åœ¨è¦å¼€å‘ä¸€ä¸ªç»„ä»¶åº“æˆ–è€…ä¸€ä¸ªå‡½æ•°åº“æ—¶ï¼Œå¯¹äºè¿™æ ·çš„åº“ä»£ç ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•è®© `webpack` æ¥è¿›è¡Œæ‰“åŒ…å‘¢ï¼Ÿ

## 1. webpack æ‰“åŒ…åº“

å‡å¦‚æˆ‘ä»¬ç°åœ¨å†™äº†å¾ˆå¤šé€»è¾‘ä»£ç ï¼ŒåŒæ—¶å‘¢ï¼Œæˆ‘ä»¬å°†è¿™äº›é€»è¾‘ä»£ç è¿›è¡Œæ‰“åŒ…ï¼Œæ‰“åŒ…ä¹‹åå®ƒå…¨éƒ¨ç”Ÿæˆåœ¨ `dist` æ–‡ä»¶å¤¹ä¸‹çš„ `mondaylib.js` æ–‡ä»¶ä¸­ã€‚

å¥½äº†ï¼Œç°åœ¨è¿™ä¸ªåº“ç”Ÿæˆäº†ã€‚é‚£å¦‚ä½•è®©æˆ‘ä»¬çš„ç”¨æˆ·ï¼Œæ¥å¼•å…¥ `mondaylib` è¿™ä¸ªåº“å‘¢ï¼Ÿ

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåˆ«äººå¼•å…¥æˆ‘ä»¬çš„åº“çš„æ–¹æ³•ï¼Œ**å…·ä½“æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š**

```js
//æ–¹å¼ä¸€
import mondaylib from 'mondaylib';
//æ–¹å¼äºŒ
const mondaylib = require('mondaylib');
//æ–¹å¼ä¸‰
require(['mondaylib'], function () {});
```

æ‰€ä»¥ï¼Œå¦‚æœæƒ³è®©æˆ‘ä»¬çš„ç”¨æˆ·æ¥å¼•å…¥è¿™ä¸ªåº“ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ `webpack.config.js` ä¸‹è¿›è¡Œé…ç½®ã€‚**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
const path = require('path');

module.exports = {
  mode: 'production',
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'mondaylib.js',
    //æ­¤å¤„é…ç½®libraryTargetï¼Œumdè¡¨ç¤ºæ”¯æŒcommonJSè¿™ç§è¯­æ³•
    libraryTarget: 'umd',
  },
};
```

`libraryTarget: 'umd'` è¡¨ç¤ºæ”¯æŒ `commonJS` è¿™ç§è¯­æ³•ï¼Œå› æ­¤å¯ä»¥å¼•å…¥ä¸Šé¢ä¸‰ç§æ–¹å¼ã€‚åŒæ—¶ï¼Œ `libraryTarget` ä¹Ÿå¯ä»¥è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œæ¯”å¦‚ `this` å’Œ `window` ã€‚

`libraryTarget: 'this'` çš„æ„æ€ä¸ºï¼Œæˆ‘è¦è®© `mondaylib` è¿™ä¸ªå˜é‡ï¼ŒæŒ‚è½½åˆ°é¡µé¢ä¸Šã€‚ `libraryTarget: 'window'` åˆ™è¡¨ç¤ºä¸ºï¼Œ `mondaylib` è¿™ä¸ªå˜é‡ï¼Œå°†æŒ‚è½½åˆ° `window` ä¸Šã€‚

---

é™¤äº†ä»¥ä¸Šä¸‰ç§æƒ…å†µï¼Œè¿˜æœ‰å¦å¤–ç‰¹æ®Šæƒ…å†µï¼Œ**å…·ä½“å¦‚ä¸‹ï¼š**

```html
<script src="mondaylib.js"></script>
```

æ­¤æ—¶æˆ‘ä»¬éœ€è¦åœ¨ `webpack.config.js` ä¸­è¿›è¡Œ**ä»¥ä¸‹é…ç½®ï¼š**

```js
const path = require('path');

module.exports = {
  mode: 'production',
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'mondaylib.js',
    //å°†æ‰“åŒ…ç”Ÿæˆçš„ä»£ç æŒ‚è½½åˆ°é¡µé¢çš„å…¨å±€å˜é‡ä¸Š
    library: 'mondaylib',
    //æ­¤å¤„é…ç½®libraryTargetï¼Œumdè¡¨ç¤ºæ”¯æŒcommonJSè¿™ç§è¯­æ³•
    libraryTarget: 'umd',
  },
};
```

å…¶ä¸­ï¼Œç¬¬ä¸€ä¸ª `library` æ˜¯å±æ€§å€¼ï¼Œç¬¬äºŒä¸ª `mondaylib` æ˜¯æˆ‘ä»¬çš„åº“åï¼Œè¿™ä¸ªé…ç½®çš„æ„æ€ä¸ºï¼Œå°†æ‰“åŒ…ç”Ÿæˆçš„ä»£ç ï¼Œå³ `mondaylib.js` è¿™ä¸ªåº“ï¼Œç»™æŒ‚è½½åˆ°å…¨å±€çš„å˜é‡ä¸Šã€‚

## 2. åº“å¼•ç”¨å†²çª

å‡è®¾ç°åœ¨ï¼Œæˆ‘ä»¬åœ¨ä¸Šé¢ `mondaylib` è¿™ä¸ªåº“ä¸­ï¼Œå¼•å…¥äº† `lodash` è¿™ä¸ªåº“ã€‚ç„¶åå‘¢ï¼Œå½“ç”¨æˆ·ä½¿ç”¨çš„æ—¶å€™ï¼Œç”¨æˆ·åˆå†å¼•å…¥äº†ä¸€æ¬¡ lodash è¿™ä¸ªåº“ã€‚åƒä¸‹é¢ä»£ç è¿™æ ·ï¼š

```js
import _ from 'lodash';
//mondaylibè¿™ä¸ªåº“åŸå…ˆå·²ç»å¼•å…¥è¿‡lodashè¿™ä¸ªåº“
import mondaylib from 'mondaylib';
```

æ‰€ä»¥ç°åœ¨ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•æ¥é¿å…è¿™ç§é—®é¢˜å‘ç”Ÿå‘¢ï¼Ÿæˆ‘ä»¬å† `webpack.config.js` ä¸­è¿›è¡Œé…ç½®ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const path = require('path');

module.exports = {
  externals: ['lodash'],
};
```

ä»ä»¥ä¸Šä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œé€šè¿‡ `externals: ["lodash"]` è¿™ä¸ªé…ç½®ï¼Œæ¥å‘Šè¯‰ `webpack` ï¼Œå‘Šè¯‰å®ƒè¯´ï¼Œå¦‚æœåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­ï¼Œ `mondaylib` è¿™ä¸ªåº“ä¸­å¦‚æœæœ‰é‡åˆ° `lodash` è¿™ä¸ªåº“ï¼Œé‚£ä¹ˆå°±é¿å¼€å®ƒï¼Œä¸è¦è¿›è¡Œæ‰“åŒ…ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥æœ‰æ•ˆåœ°é¿å…åº“å¤šæ¬¡å¼•ç”¨çš„é—®é¢˜ï¼Œå‡å°‘ä»£ç çš„æ‰“åŒ…å¤§å°ã€‚

---

`externals` è¿˜æœ‰å¦å¤–ä¸€ç§ç‰¹æ®Šé…ç½®ï¼Œ**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
module.exports = {
  externals: {
    // è¡¨æ˜lodashè¿™ä¸ªåº“å¦‚æœåœ¨commonjsè¿™ç§ç¯å¢ƒä¸‹è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆè¦æ±‚lodashåŠ è½½çš„æ—¶å€™å¿…é¡»å«åšlodash
    lodash: {
      commonjs: 'lodash',
    },
  },
};
```

å¦‚æœè¿™æ ·é…ç½®ï¼Œæ„åœ¨è¡¨æ˜ `lodash` è¿™ä¸ªåº“å¦‚æœåœ¨ `commonjs` è¿™ç§ç¯å¢ƒä¸‹è¢«ä½¿ç”¨ï¼Œé‚£ä¹ˆè¦æ±‚ `lodash` åŠ è½½çš„æ—¶å€™ï¼Œå¿…é¡»å‘½åä¸º `lodash` ï¼Œè€Œä¸èƒ½éšæ„å‘½åã€‚**åƒä¸‹é¢è¿™æ ·ï¼š**

```js
//âœ”å¯ä½¿ç”¨æ–¹å¼ï¼šå‘½åä¸ºlodash
import lodash from 'lodash';
//âœ˜ä¸å¯ä½¿ç”¨æ–¹å¼ï¼šæœªå‘½åä¸ºlodash
import _ from 'lodash';
```

# ğŸš äºŒã€PWA çš„æ‰“åŒ…é…ç½®

## 1. PWA æ˜¯ä»€ä¹ˆ

**PWA**ï¼Œå…¨ç§°ä¸º `Progressive Web Application` ï¼Œå³æ¸è¿›å¼ Web åº”ç”¨ç¨‹åºã€‚

`PWA` æ˜¯ä¸€é—¨æ¯”è¾ƒæ–°çš„å‰ç«¯æŠ€æœ¯ï¼Œé‚£å®ƒæ˜¯ä¸€ç§ä»€ä¹ˆæ ·çš„æŠ€æœ¯å‘¢ï¼Ÿ

`PWA` å¯ä»¥å®ç°çš„æ•ˆæœæ˜¯ï¼Œå¦‚æœä½ è®¿é—®ä¸€ä¸ªç½‘ç«™ï¼Œæœ‰å¯èƒ½ç¬¬ä¸€æ¬¡ä½ è®¿é—®æˆåŠŸäº†ï¼Œä½†æ˜¯å‘¢ï¼Œçªç„¶é—´è¿™ä¸ªç½‘ç«™çš„æœåŠ¡å™¨æŒ‚æ‰äº†ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ä½ è®¿é—®ç½‘ç«™åº”è¯¥å°±æ˜¯æ²¡åŠæ³•è®¿é—®äº†ã€‚ä½†æ˜¯å‘¢ï¼Œ `PWA` ä¼šå°†ä½ ç¬¬ä¸€æ¬¡è®¿é—®çš„é¡µé¢ç»™ç¼“å­˜èµ·æ¥ã€‚ä¹‹åå³ä½¿æœåŠ¡å™¨æŒ‚æ‰äº†ï¼Œä½ ä¾ç„¶å¯ä»¥æŠŠä¹‹å‰çœ‹åˆ°çš„é¡µé¢å†å±•ç¤ºå‡ºæ¥ã€‚

å› æ­¤ï¼Œ `webpack` ä¸­æœ‰ä¸€ä¸ªæ’ä»¶ï¼Œå¯ä»¥æ¥å®ç°è¿™æ ·çš„æ•ˆæœã€‚æˆ‘ä»¬æ¥äº†è§£ä¸€ä¸‹~

## 2. webpack ä¸­çš„ PWA

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£…æ’ä»¶ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```bash
npm install workbox-webpack-plugin --save-dev
```

---

**ç¬¬äºŒæ­¥ï¼š** åœ¨ `webpack.prod.js` ä¸­å¼•å…¥è¯¥æ’ä»¶å¹¶ä½¿ç”¨ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const WorkboxPlugin = require('workbox-webpack-plugin');

module.exports = {
  plugins: [
    new WorkboxPlugin.GenerateSW({
      clientsClaim: true,
      skipWaiting: true,
    }),
  ],
};
```

é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨çº¿ä¸Šç¯å¢ƒ `prod` å¼•å…¥ `PWA` ï¼Œè€Œåœ¨å¼€å‘ç¯å¢ƒä¸­ä¸éœ€è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡ä»¥ä¸Šçš„é…ç½®ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®æ‰“åŒ…å®Œæˆä¹‹åï¼Œ `dist` ç›®å½•ä¸‹å°†ç”Ÿæˆä¸¤ä¸ªæ–°çš„æ–‡ä»¶ï¼Œä¸€ä¸ªæ˜¯ `service-worker.js` ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ `precache.js` æ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªæ–‡ä»¶å°±æ˜¯ä¾›æˆ‘ä»¬æ¥ä½¿ç”¨ PWA çš„ã€‚

---

**ç¬¬ä¸‰æ­¥ï¼š** å¼•å…¥ä»¥ä¸Šæ–‡ä»¶ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker
      .register('/service-worker.js')
      .then((registration) => {
        console.log('service-worker registed');
      })
      .catch((error) => {
        console.log('service-worker regist error');
      });
  });
}
```

æˆ‘ä»¬éœ€è¦åœ¨**å…¥å£æ–‡ä»¶**ä¸­ï¼Œå†™ä¸€æ®µä¸šåŠ¡ä»£ç ï¼Œå¼•å…¥ `service-worker.js` æ–‡ä»¶ï¼Œæ¥å¸®æˆ‘ä»¬åš `PWA` ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯¹é¡¹ç›®è¿›è¡Œæ‰“åŒ…ï¼Œä¹‹åå‘¢ï¼Œå¦‚æœå‡ºç°æœåŠ¡å™¨çªç„¶æŒ‚äº†çš„æƒ…å†µï¼Œé‚£ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œ `PWA` ä¼šå¸®æˆ‘ä»¬åŠ è½½åŸå…ˆçš„é¡µé¢æ¥æä¾›ç»™æˆ‘ä»¬æµè§ˆã€‚

# ğŸš ä¸‰ã€TypeScript çš„æ‰“åŒ…é…ç½®

## 1. å¼•ä¾‹é˜è¿°

æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œå¯¹äºä¸åŒçš„å¼€å‘è€…æ¥è¯´ï¼Œä¸åŒçš„äººå†™å‡ºçš„ä»£ç é£æ ¼å½¢å¼å„å¼‚ï¼Œè¿™æ ·åœ¨åæœŸï¼Œé¡¹ç›®çš„ç»´æŠ¤æ€§å°±å¾ˆéš¾å¾—åˆ°ä¿è¯ã€‚é‚£ä¹ˆï¼Œè¿™ä¸ªæ—¶å€™ï¼Œé£é¡äº 2018 å¹´çš„ `Typescript` å‡ºç°äº†ã€‚ `ts` è§„èŒƒäº†ä¸€å¥— `js` çš„æ ‡å‡†ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä»£ç çš„ç¼–å†™ä¸­ï¼Œé€šè¿‡ `ts` ï¼Œå°±å¯ä»¥è§„èŒƒæˆ‘ä»¬çš„ä»£ç ï¼Œå¹¶ä¸”ä½¿å¾—æˆ‘ä»¬é¡¹ç›®çš„ç»´å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§å˜å¾—æ›´å¥½äº†ã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹ï¼Œå¦‚ä½•é€šè¿‡ `webpack` çš„é…ç½®å˜æ›´ï¼Œæ¥å®ç°å¯¹ `ts` è¯­æ³•çš„æ”¯æŒã€‚

## 2. webpack å¯¹ ts çš„é…ç½®

### ï¼ˆ1ï¼‰èƒŒæ™¯

å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰è¿™ä¹ˆä¸€æ®µ `ts` çš„ä»£ç éœ€è¦è¿›è¡Œç¼–è¯‘ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
class Greeter {
  greeting: string;
  constructor(message: string) {
    this.greeting = message;
  }
  greet() {
    return 'Hello, ' + this.greeting;
  }
}

let greeter = new Greeter('world');

let button = document.createElement('button');
button.textContent = 'Say Hello';
button.click = function () {
  alert(greeter.greet());
};

document.body.appendChild(button);
```

ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³è¦è®© `webpack` æ¥å¯¹è¿™æ®µ `ts` ä»£ç è¿›è¡Œç¼–è¯‘ï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

### ï¼ˆ2ï¼‰é…ç½®æ­¥éª¤

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£… `ts-loader` ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npm install ts-loader typescript -D
```

**ç¬¬äºŒæ­¥ï¼š** æˆ‘ä»¬åœ¨ `webpack.config.js` æ–‡ä»¶ä¸‹è¿›è¡Œé…ç½®ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const path = require('path');

module.exports = {
  mode: 'production',
  entry: './src/index.tsx',
  module: {
    rules: [
      {
        test: /\.tsx?$/,
        use: 'ts-loader',
        exclude: /node_modules/,
      },
    ],
  },
  output: {
    filename: 'bundle.js',
    path: path.resolve(__dirname, 'dist'),
  },
};
```

**ç¬¬ä¸‰æ­¥ï¼š** é…ç½® `tsconfig.json` æ–‡ä»¶ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```json
{
  "compilerOptions": {
    "outDir": "./dist",
    "module": "es6",
    "target": "es5",
    "allowJs": true
  }
}
```

## 3. ts è¯†åˆ«ç¬¬ä¸‰æ–¹åº“

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ `lodash` ä¸­çš„ `join` æ–¹æ³•ï¼Œä½†æ˜¯å‘¢ï¼Œå¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œç‰¹æ®Šå¤„ç†çš„è¯ï¼Œåœ¨ `tsx` æ–‡ä»¶ä¸­æ­£å¸¸å¼•å…¥ `lodash` è¿™ä¸ªåº“å¹¶ä½¿ç”¨ï¼Œæ˜¯ä¸ä¼šæŠ¥é”™çš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ¥å®‰è£…å¦å¤–ä¸€ä¸ª `ts` çš„åº“ï¼Œæ¥å¯¹å®ƒè¿›è¡Œå¤„ç†ä¸€ä¸‹ã€‚**å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š**

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£… `@types/lodash` åº“ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npm install @types/lodash --save-dev
```

å®‰è£…å®Œè¿™ä¸ªåº“ä¹‹åï¼Œ `ts` å°±å¯ä»¥å»è¯†åˆ« `lodash` çš„ä¸€äº›å‡½æ•°å’Œæ–¹æ³•ï¼Œä¸€æ—¦å‡ºç°å¼•ç”¨ä¸å¯¹ï¼Œå°±ä¼šè¿›è¡ŒæŠ¥é”™æç¤ºã€‚

é‚£æœ‰å°ä¼™ä¼´å°±ä¼šæœ‰ç–‘é—®è¯´ï¼Œæ˜¯ä¸æ˜¯ `ts` æ‹¥æœ‰æ‰€æœ‰è¿™æ ·çš„åº“ï¼ˆåƒ `jQuery` ç­‰å„ç§åº“ï¼‰çš„ç±»å‹æ–‡ä»¶å‘¢ï¼Ÿ

ç­”æ¡ˆå½“ç„¶æ˜¯å¦å®šçš„ã€‚æˆ‘ä»¬å¯ä»¥åˆ° `github` ä¸Šçš„ä¸€ä¸ªç½‘å€[ğŸ‘‰](https://emojipedia.org/backhand-index-pointing-right/)[https://microsoft.github.io/TypeSearch/](https://microsoft.github.io/TypeSearch/)æ¥è¿›è¡Œæœç´¢ï¼Œå¦‚æœæœç´¢å¾—åˆ°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨ `@type/åº“å` æ¥è¿›è¡Œå®‰è£…ï¼Œä¹‹å `tsx` æ–‡ä»¶å°±ä¼šæ”¯æŒå¯¹è¯¥åº“çš„ç±»å‹æ£€æŸ¥ã€‚

# ğŸš• å››ã€WebpackDevServer è¿›é˜¶æ“ä½œ

## 1. WebpackDevServer å®ç°è¯·æ±‚è½¬å‘

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ `charles fiddler` å·¥å…·ï¼Œåœ¨æœ¬åœ°æ­å»ºä¸€ä¸ªä»£ç†æœåŠ¡å™¨ã€‚é€šè¿‡è¿™å°ä»£ç†æœåŠ¡å™¨ï¼Œå°†æˆ‘ä»¬æƒ³è¦è¯·æ±‚çš„æ¥å£åœ°å€è¿›è¡Œè½¬å‘ã€‚

é‚£åœ¨ `webpack` ä¸­ï¼Œç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå·¥å…·ï¼Œ `devServer.Proxy` ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åœ¨ `webpack.config.js` ä¸­è¿›è¡Œé…ç½®ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
module.exports = {
  devServer: {
    proxy: {
      '/react/api': {
        target: 'http://www.mondaylab.com',
        //å®ç°å¯¹httpsç½‘å€çš„è¯·æ±‚è½¬å‘
        secure: false,
        bypass: function (req, res, proxyOptions) {
          //å¦‚æœè¯·æ±‚çš„å†…å®¹æ˜¯ä¸€ä¸ªhtmlåœ°å€ï¼Œé‚£ä¹ˆå°±ç›´æ¥è¿”å›æ ¹è·¯å¾„ä¸‹index.htmlçš„å†…å®¹
          if (req.headers.accept.indexOf('html') !== -1) {
            console.log('Skipping proxy for browser request');
            return './index.html';
            // return false; //è¡¨ç¤ºå¦‚æœé‡åˆ°htmlè¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥ç»™ä½ è¿”å›ä»€ä¹ˆå°±è¿”å›ä»€ä¹ˆ
          }
        },
        //åœ¨å‰ç«¯è¯·æ±‚æ—¶å†™header.jsonï¼Œwebpackä¼šé—´æ¥çš„å¸®æˆ‘ä»¬æ‹¿åˆ°demo.jsonçš„æ•°æ®ï¼ˆè¯·æ±‚è½¬å‘ã€‘ï¼‰
        pathRewrite: {
          'header.json': 'demo.json',
        },
        //å¦‚æœæœ‰ä¸€äº›ç½‘ç«™åšäº†é˜²çˆ¬è™«ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯èƒ½æ²¡åŠæ³•è¿›è¡Œè·¨åŸŸã€‚éœ€è¦è¿›è¡Œå¦‚ä¸‹é…ç½®ï¼Œå°±å¯ä»¥çªç ´å¯¹originçš„é™åˆ¶
        changeOrigin: true,
        // åœ¨è¯·æ±‚å¤´ä¸­è‡ªå®šä¹‰ä¸€äº›å†…å®¹
        headers: {
          host: 'www.mondaylab.com',
          //åœ¨åšè¯·æ±‚è½¬å‘æ—¶æ¨¡æ‹Ÿä¸€äº›ç™»å½•ç­‰æ“ä½œ
          cookie: 'gfhgfh',
        },
      },
    },
  },
};
```

## 2. WebpackDevServer è§£å†³å•é¡µé¢åº”ç”¨è·¯ç”±é—®é¢˜

å¯¹äºç°ä»£çš„çš„ä¸»æµæ¡†æ¶æ¥è¯´ï¼Œåƒ `vue.js` ã€`React.js` ç­‰ç­‰æ¡†æ¶ï¼ŒåŸºæœ¬éƒ½æ˜¯å•é¡µé¢åº”ç”¨ã€‚é‚£ä¹ˆï¼Œåœ¨å•é¡µé¢åº”ç”¨é‡Œï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è¦ä» `http://mondaylab.com` è·³è½¬åˆ° `http://mondaylab.com/list` ï¼Œè¯¥æ€ä¹ˆæ ·è¿›è¡Œè·³è½¬å‘¢ï¼Ÿ

è¿™å°±è¦è°ˆåˆ°ä¸€ä¸ªå•é¡µé¢åº”ç”¨çš„è·¯ç”±é—®é¢˜ã€‚æˆ‘ä»¬éœ€è¦åœ¨ `webpack.config.js` ä¸­è¿›è¡Œ**å¦‚ä¸‹é…ç½®ï¼š**

```js
module.exports = {
  devServer: {
    //ç¬¬ä¸€ç§æ–¹å¼
    historyApiFallback: true,
    /*ç­‰åŒäº
        historyApiFallback: {
            rewrites: [{
                from: /\.*\/,
                to: '/list.html/'
            }]
        }
        */

    /*ç¬¬äºŒç§æ–¹å¼
        historyApiFallback: {
            rewrites: [{
                from: /abc.html/,
                //è¿›è¡Œè½¬æ¢ï¼Œå½“è®¿é—®abc.htmlæ—¶ï¼Œä¼šæŠŠlist.htmlçš„å†…å®¹å±•ç¤ºå‡ºæ¥
                to: '/list.html/'
            }]
        }
        */

    /*ç¬¬ä¸‰ç§æ–¹å¼ï¼šæ›´ä¸ºçµæ´»
        historyApiFallback: {
            rewrites: [{
            	//è¡¨æ˜åœ¨åšé¡µé¢çš„æ›¿æ¢æ—¶ï¼Œé€šè¿‡ä¸€ä¸ªå‡½æ•°functionçš„å½¢å¼ï¼Œç»“åˆcontextçš„ä¸€äº›å‚æ•°
            	//åšä¸€äº›jsçš„é€»è¾‘æ”¾åœ¨é‡Œé¢ï¼Œæ¥å†³å®šæœ€ç»ˆå®ƒè·³è½¬åˆ°å“ª
                from: /^\/(libs)\/.*$/,
                to: function(context){
                	return '/bower_components' + context.match[0];
                }
            }]
        }
        */
  },
};
```

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ `historyApiFallback` åªèƒ½ç”¨äºå¼€å‘ç¯å¢ƒä¸‹ã€‚å¦‚æœåˆ°äº†çº¿ä¸Šç¯å¢ƒçš„è¯ï¼Œéœ€è¦è®©åç«¯çš„å°ä¼™ä¼´å» `nginx` æˆ–è€… `apache` ä¸Šï¼Œä»¿ç…§ `webpackDevServer` çš„ä¸€äº›é…ç½®ï¼Œåœ¨åç«¯çš„æœåŠ¡å™¨ä¸ŠåšåŒæ ·çš„é…ç½®ï¼Œé…ç½®ä¹‹åå‰ç«¯æ‰å¯ä»¥ä½¿ç”¨å¯¹åº”çš„è·¯ç”±ã€‚

# ğŸš– äº”ã€ESLint åœ¨ Webpack ä¸­çš„é…ç½®

## 1. ESLint æ˜¯ä»€ä¹ˆ

åœ¨æˆ‘ä»¬æ—¥å¸¸çš„å›¢é˜Ÿå¼€å‘ä¸­ï¼Œæ¯ä¸ªäººå†™çš„ä»£ç éƒ½å„å¼å„æ ·ï¼Œæ¯”å¦‚æœ‰çš„äººå–œæ¬¢åœ¨ä»£ç åè¾¹åŠ ä¸ªåˆ†å·ï¼Œæœ‰çš„äººåˆä¸å–œæ¬¢åŠ ã€‚è¿™é—´æ¥åœ°ï¼Œå°±å¾ˆå®¹æ˜“å¯¼è‡´æˆ‘ä»¬é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å˜å·®äº†ã€‚å› æ­¤å‘¢ï¼Œæˆ‘ä»¬å°±å¼•å…¥äº† `ESLint` è¿™ä¸ªå†…å®¹ï¼Œæ¥çº¦æŸçš„ä»£ç è§„èŒƒï¼Œè®©é¡¹ç›®çš„å¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§å˜é«˜ã€‚

é‚£ `ESLint` åœ¨ `Webpack` ä¸­æ˜¯æ€ä¹ˆæ ·é…ç½®çš„å‘¢ï¼Ÿ

## 2. å¦‚ä½•å®‰è£… ESLint

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£… `ESLint` å·¥å…·ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npm install eslint --save-dev
```

**ç¬¬äºŒæ­¥ï¼š** çº¦æŸæˆ‘ä»¬çš„ä»£ç ã€‚æˆ‘ä»¬éœ€è¦æ–°å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¥å¯¹æˆ‘ä»¬çš„ ESLint è§„èŒƒè¿›è¡Œé…ç½®ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npx eslint --init
> Use a popular style guide ä½¿ç”¨é€šç”¨çš„ä»£ç æ£€æµ‹æ¨¡æ¿
> Airbnb
> Do you use React æ ¹æ®è‡ªèº«éœ€æ±‚å¡«yæˆ–è€…n
> Javascript
> Would you like to install them now with npm? Y
```

**ç¬¬ä¸‰æ­¥ï¼š** ä½¿ç”¨ `eslint` æ£€æµ‹ä»£ç è§„èŒƒã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```bash
npx eslint src
```

ä»¥ä¸Šä»£ç è¡¨ç¤ºçš„æ˜¯ï¼Œä½¿ç”¨ eslint æ¥æ£€æµ‹ src ç›®å½•ä¸‹çš„ä»£ç è§„èŒƒã€‚

## 3. ä¸ºä»€ä¹ˆè¦åœ¨ webpack ä¸­é…ç½® ESLint

åœ¨ä¸Šé¢ä¸­æˆ‘ä»¬äº†è§£åˆ°ï¼Œæ¯ä¸ªå¼€å‘çš„å°ä¼™ä¼´éƒ½å¯ä»¥ç”¨å‘½ä»¤è¡Œæ¥æ£€æµ‹è‡ªå·±çš„ä»£ç è§„èŒƒï¼Œä½†æ˜¯å¦‚æœæ¯å›å†™å®Œä¸€æ¬¡ä»£ç ï¼Œæˆ‘ä»¬éƒ½è¦å»è¿è¡Œè¿™æ ·çš„å‘½ä»¤ï¼Œæ‰èƒ½çœ‹æˆ‘ä»¬çš„ä»£ç å†™çš„åˆä¸åˆç†ï¼Œè¿™æ ·ä¼šä¸ä¼šå°±æœ‰ç‚¹éº»çƒ¦äº†ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬åˆä¹Ÿä¸èƒ½ä¿è¯æ¯ä¸ªäººçš„ `eslint` çš„ä»£ç è§„èŒƒè®¾ç½®æ˜¯ä¸æ˜¯ä¸€æ ·çš„ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ `webpack` ä¸­æ¥è¿›è¡Œé…ç½®ï¼Œè§£å†³ä¸Šè¿°æ‰€è¯´çš„é—®é¢˜ã€‚**å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š**

**ç¬¬ä¸€æ­¥ï¼š** å®‰è£… `eslint-loader` ã€‚**å…·ä½“å‘½ä»¤è¡Œå¦‚ä¸‹ï¼š**

```bash
npm install eslint-loader --save-dev
```

**ç¬¬äºŒæ­¥ï¼š** é…ç½® `webpack.config.js` ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
module.exports = {
  devServer: {
    /*å½“æˆ‘ä»¬è¿è¡Œwebpackåšæ‰“åŒ…æ—¶ï¼Œ
      ä¸€æ—¦ä»£ç å‡ºç°è§„èŒƒé—®é¢˜ï¼Œ
      webpackå°†ä¼šåœ¨æµè§ˆå™¨ä¸Šå¼¹å‡ºä¸€ä¸ªæŠ¥é”™å±‚æ¥æç¤ºæˆ‘ä»¬*/
    overlay: true,
  },
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: ['babel-loader', 'eslint-loader'],
      },
    ],
  },
};
```

---

äº†è§£å®ŒåŸºç¡€é…ç½®ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥äº†è§£ä¸€äº› `eslint-loader` çš„ä¸€äº›å…¶ä»–é…ç½®ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        use: [
          'babel-loader',
          {
            loader: 'eslint-loader',
            options: {
              //å¦‚æœä»£ç æœ‰ä¸€äº›æ¯”è¾ƒæµ…æ˜¾çš„é—®é¢˜ï¼Œeslint-loaderå°†ä¼šå¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ä¿®å¤
              fix: true,
              //é™ä½eslintåœ¨æ‰“åŒ…è¿‡ç¨‹ä¸­å¯¹é¡¹ç›®æ€§èƒ½çš„æŸè€—
              cache: true,
            },
            //å¼ºåˆ¶eslint-loaderå…ˆæ‰§è¡Œ
            fore: 'pre',
          },
        ],
      },
    ],
  },
};
```

# ğŸï¸ å…­ã€Webpack æ€§èƒ½ä¼˜åŒ–

ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½å·²ç»å‘ç°ï¼Œwebpack çš„æ‰“åŒ…é€Ÿåº¦æœ‰æ—¶å€™å¯èƒ½ä¼šæœ‰ä¸€ç‚¹ç‚¹æ…¢ã€‚è¿™é—´æ¥åœ°ï¼Œä¼šæµªè´¹æˆ‘ä»¬å¾ˆå¤šä¸è¯¥æµªè´¹çš„æ—¶é—´ã€‚æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥å°±æ¥è°ˆè°ˆï¼Œæå‡ `Webpack` æ‰“åŒ…é€Ÿåº¦çš„å‡ ç§æ–¹æ³•ã€‚

## 1. è·Ÿä¸ŠæŠ€æœ¯çš„è¿­ä»£(Node,Npm,Yarn)

å¦‚æœæˆ‘ä»¬æƒ³æå‡ `webpack` çš„æ‰“åŒ…é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥å‡çº§ `webpack` çš„ç‰ˆæœ¬ï¼Œæˆ–è€…å‡çº§æˆ‘ä»¬çš„ nodeã€npm ç®¡ç†å™¨æˆ–è€… yarn çš„ç‰ˆæœ¬ã€‚

é‚£ä¸ºä»€ä¹ˆå‡çº§è¿™äº›å·¥å…·å¯ä»¥æå‡ `webpack` çš„æ‰“åŒ…é€Ÿåº¦å‘¢ã€‚

å¤§å®¶æƒ³ä¸€ä¸‹ï¼Œ `webpack` åœ¨åšæ¯ä¸€ä¸ªç‰ˆæœ¬çš„æ›´æ–°æ—¶ï¼Œå†…éƒ¨è‚¯å®šä¼šåšå¾ˆå¤šç‰ˆæœ¬çš„ä¼˜åŒ–ï¼Œå› æ­¤ï¼Œå½“æˆ‘ä»¬åš `webpack` çš„ç‰ˆæœ¬æ›´æ–°æ—¶ï¼Œåœ¨é€Ÿåº¦ä¸Šè‚¯å®šä¼šæœ‰æ‰€æå‡ã€‚ `node` ã€ `npm` ã€ `yarn` çš„æ›´æ–°ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚

è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸æå‡ï¼Œé‚£å®ƒå‡çº§çš„æ„ä¹‰åˆåœ¨å“ªå‘¢ï¼Ÿå¯¹å§ã€‚

## 2. åœ¨å°½å¯èƒ½å°‘çš„æ¨¡å—ä¸Šåº”ç”¨ Loader

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç¬¬ä¸‰æ–¹æ¨¡å—çš„åº“éƒ½æ˜¯å·²ç»è¿›è¡Œæ‰“åŒ…ç¼–è¯‘è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨å¼•å…¥ `loader` æ¥è¿›è¡Œç¼–è¯‘æ—¶ï¼Œå¯¹ `node_module` çš„æ–‡ä»¶ç»™å¿½ç•¥æ‰ï¼Œæˆ–è€…åªåœ¨æŸä¸ªæ–‡ä»¶å¤¹ä¸‹ä½¿ç”¨æŸä¸ª `loader` ï¼Œä»¥æ­¤æ¥å¢åŠ æˆ‘ä»¬çš„æ‰“åŒ…é€Ÿåº¦ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ `webpack.config.js` ä¸­è¿›è¡Œé…ç½®ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
module.exports = {
  module: {
    rules: [
      {
        test: /\.js$/,
        exclude: /node_modules/,
        //æˆ–è€…ä»¥ä¸‹è¿™ç§æ–¹å¼->include
        //include: path.resolve(__dirname, '../src'),
        use: [
          {
            loader: 'babel-loader',
          },
        ],
      },
    ],
  },
};
```

å½“ç„¶ï¼Œä¾æ®ä¸Šé¢è¿™ä¸ªæ€è·¯ï¼Œè¿˜æœ‰å…¶ä»–çš„ `loader` ä¹Ÿéƒ½æœ‰å…¶ç›¸å¯¹åº”çš„æ³¨æ„äº‹é¡¹ï¼Œè¿™é‡Œä¸å†å±•å¼€ç»†è¿°ã€‚

## 3. åˆç†ä½¿ç”¨æ’ä»¶

æ’ä»¶è¦åˆç†çš„ä½¿ç”¨ï¼Œä¸è¦ä½¿ç”¨é‚£äº›å†—ä½™çš„ï¼Œæ²¡æœ‰æ„ä¹‰çš„æ’ä»¶ã€‚åŒæ—¶å‘¢ï¼Œä¹Ÿè¦é€‰æ‹©é‚£äº›ï¼Œæ€§èƒ½æ¯”è¾ƒå¥½çš„ï¼Œå®˜æ–¹è®¤å¯çš„æ’ä»¶æ¥ä½¿ç”¨ï¼Œè¿™æ ·ï¼Œå¯ä»¥æœ‰æ•ˆçš„æ¥æå‡ `webpack` çš„æ‰“åŒ…é€Ÿåº¦ã€‚

## 4. resolve å‚æ•°åˆç†é…ç½®

### ï¼ˆ1ï¼‰å¸¸è§é…ç½®

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬æƒ³è¦å¯¹æˆ‘ä»¬å¼•å…¥çš„æ–‡ä»¶è¿›è¡Œä¸€äº›**è‡ªå®šä¹‰çš„é…ç½®**ï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
module.exports = {
  resolve: {
    extensions: ['js', 'jsx'],
    /**
     * 1.å½“ä½ åªå¼•å…¥ä¸€ä¸ªç›®å½•æ—¶ï¼Œæ¯”å¦‚ import Child from './child/child' ï¼Œ
     * è¿™ä¸ªæ—¶å€™webpackä¸çŸ¥é“æˆ‘ä»¬å…·ä½“æ˜¯è¦å¼•å…¥å“ªä¸ªæ–‡ä»¶ï¼Œ
     * é‚£ä¹ˆä¼šå…ˆå»æ‰¾indexæ–‡ä»¶ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£å®ƒä¼šç»§ç»­å»æ‰¾childæ–‡ä»¶
     */
    mainFiles: ['index', 'child'],
    /**
     * alias, é¡¾åæ€ä¹‰æ˜¯åˆ«åã€‚
     * æ¯”å¦‚ï¼Œæƒ³è¦å°†æŸä¸ªæ–‡ä»¶çš„å¼•å…¥æ–¹å¼æ”¹ä¸ºè‡ªå·±çš„åå­—
     * import Child from './Child' -> import Child from 'monday'
     */
    alias: {
      monday: path.resolve(__dirname, '../src/Child'),
    },
  },
};
```

æ¥ä¸‹æ¥å¯¹ä»¥ä¸Šçš„å‡ ä¸ªå‚æ•°è¿›è¡Œè¯¦ç»†è®²è§£ã€‚

### ï¼ˆ2ï¼‰å‚æ•°è®²è§£

**1ï¼‰extensions**

- æ¯”å¦‚å½“å¼•å…¥ `import Child from './child/child'` æ—¶ï¼Œä¼šå…ˆå»æ‰¾ `'./child/child.js'` æ–‡ä»¶ï¼Œæ‰¾ä¸åˆ°å†å»æ‰¾ `'./child/child.jsx'` æ–‡ä»¶ã€‚
- ä¸€èˆ¬ä¸é…ç½® css å’Œå›¾ç‰‡æ–‡ä»¶ï¼Œå› ä¸º css å’Œå›¾ç‰‡å¯èƒ½æ•°é‡ä¼šæ¯”è¾ƒå¤šï¼Œç›¸åº”çš„ä¼šå»æ‰§è¡Œå¾ˆå¤šæ¬¡æŸ¥æ‰¾ã€‚é—´æ¥åœ°ï¼Œæœ¬æ¥æƒ³æå‡æ€§èƒ½ï¼Œç»“æœåˆå˜æˆäº†æµªè´¹æ€§èƒ½äº†ã€‚
- æ‰€ä»¥ï¼Œå¦‚æœæ˜¯åƒ `css` å’Œ `jpg` ç­‰ä¹‹ç±»çš„èµ„æºæ–‡ä»¶ï¼Œåº”è¯¥è¿›è¡Œæ˜¾å¼çš„å¼•å…¥ï¼›å¦‚æœæ˜¯åƒ `js` å’Œ `jsx` ä¹‹ç±»çš„é€»è¾‘æ–‡ä»¶ï¼Œå¯ä»¥åœ¨ `extesions` ä¸­é…ç½®ï¼Œè¿›è¡Œæ˜¾å¼çš„å¼•å…¥ã€‚

**2ï¼‰mainFiles**

å½“ä½ åªå¼•å…¥ä¸€ä¸ªç›®å½•æ—¶ï¼Œæ¯”å¦‚ `import Child from './child/child'` ï¼Œè¿™ä¸ªæ—¶å€™ `webpack` ä¸çŸ¥é“æˆ‘ä»¬å…·ä½“æ˜¯è¦å¼•å…¥å“ªä¸ªæ–‡ä»¶ï¼Œé‚£ä¹ˆä¼šå…ˆå»æ‰¾ `index` æ–‡ä»¶ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£å®ƒä¼šç»§ç»­å»æ‰¾ `child` æ–‡ä»¶ã€‚

**3ï¼‰alias**

- `alias` , é¡¾åæ€ä¹‰æ˜¯**åˆ«å**ã€‚æ¯”å¦‚ï¼Œæƒ³è¦å°†æŸä¸ªæ–‡ä»¶çš„å¼•å…¥æ–¹å¼æ”¹ä¸ºè‡ªå·±çš„åå­— **â†’** `import Child from './Child' -> import Child from 'monday'` ã€‚
- å¸¸ç”¨äºå¤šå±‚çº§ç›®å½•çš„æƒ…å†µä¸‹ã€‚

## 5. ä½¿ç”¨ DllPlugin æé«˜æ‰“åŒ…é€Ÿåº¦

æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å¼•å…¥çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡åšæ‰“åŒ…çš„æ—¶å€™è¿›è¡Œåˆ†æï¼Œè€Œåç»­å†åšæ‰“åŒ…æ—¶å°±ä¸è¦å†è¿›è¡Œåˆ†æäº†ã€‚é‚£è¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

**ç¬¬ä¸€æ­¥ï¼š** æ–°å»º `webpack.dll.js` æ–‡ä»¶ï¼Œå¹¶è¿›è¡Œé…ç½®ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const path = require('path');
const webpack = require('webpack');

module.exports = {
  mode: 'production',
  entry: {
    //æ­¤å¤„å¡«å†™æˆ‘ä»¬æƒ³è¦å•ç‹¬è¿›è¡Œæ‰“åŒ…çš„ç¬¬ä¸‰æ–¹åº“å
    vendors: ['react', 'react-dom', 'lodash'],
  },
  output: {
    filename: '[name].dll.js',
    path: path.resolve(__dirname, '../dll'),
    /*ç”¨libraryæŠŠç¬¬ä¸‰æ–¹æ¨¡å—é‡Œé¢çš„æ‰€æœ‰ä»£ç ï¼Œ
        é€šè¿‡å…¨å±€å˜é‡çš„æ–¹å¼æš´éœ²å‡ºå»*/
    library: '[name]',
  },
  plugins: [
    /*æš´éœ²å®Œæˆä¹‹åï¼Œå€ŸåŠ©DllPluginæ’ä»¶å¯¹æš´éœ²å‡ºæ¥çš„æ¨¡å—ä»£ç è¿›è¡Œåˆ†æï¼Œæœ€ç»ˆç”Ÿæˆmanifest.jsonçš„æ–‡ä»¶ */
    new webpack.DllPlugin({
      //å¯¹ç”Ÿæˆçš„vendorsçš„åº“è¿›è¡ŒDllPluginçš„åˆ†æ(æ–‡ä»¶æ˜ å°„)
      name: '[name]',
      // åˆ†æç»“æœæ‰€æ”¾çš„è·¯å¾„ï¼Œåˆ†æä¹‹åç»“åˆå…¨å±€å˜é‡ï¼Œåœ¨common.jsä¸­è¿›è¡Œé…ç½®
      path: path.resolve(__dirname, '../dll/[name].manifest.json'),
    }),
  ],
};
```

**ç¬¬äºŒæ­¥ï¼š** å®‰è£… `add-asset-html-webpack-plugin` æ’ä»¶ã€‚**å…·ä½“å‘½ä»¤å¦‚ä¸‹ï¼š**

```bash
npm install add-asset-html-webpack-plugin --save
```

**ç¬¬ä¸‰æ­¥ï¼š** é…ç½® `webpack.common.js` æ–‡ä»¶ã€‚**å…·ä½“é…ç½®å¦‚ä¸‹ï¼š**

```js
const AddAssetHtmlWebpackPlugin = require('add-asset-html-webpack-plugin');
const webpack = require('webpack');

module.exports = {
  entry: {
    main: './src/index.js',
    plugins: [
      new HtmlWebpackPlugin({
        template: 'src/index.html',
      }),
      /**
       * æŒ‡çš„æ˜¯è¦å¾€HtmlWebpackPluginæ’ä»¶ç”Ÿæˆçš„index.htmlä¸­æ·»åŠ ä¸€äº›å†…å®¹
       */
      new AddAssetHtmlWebpackPlugin({
        filepath: path.resolve(__dirname, '../dll/vendors.dll.js'),
      }),
      /**
       * 1.ä½¿ç”¨DllReferencePluginæ’ä»¶ï¼Œ
       * è¿™ä¸ªæ’ä»¶ä¼šåˆ°'../dll/vendors.manifest.json'ä¸­æ‰¾ç¬¬ä¸‰æ–¹æ¨¡å—çš„æ˜ å°„å…³ç³»ï¼Œ
       * å¦‚æœèƒ½æ‰¾åˆ°æ˜ å°„å…³ç³»ï¼Œé‚£ä¹ˆwebpackå°±ä¼šçŸ¥é“ï¼Œè¿™ä¸ªç¬¬ä¸‰æ–¹æ¨¡å—æ²¡æœ‰å¿…è¦å†æ‰“åŒ…è¿›æ¥äº†ï¼Œ
       * ç›´æ¥ä»vendors.dll.jsä¸­æ‹¿è¿‡æ¥ç”¨å°±å¯ä»¥äº†
       * 2.å¦‚æœå‘ç°å¹¶ä¸å†æ˜ å°„å…³ç³»é‡Œé¢ï¼Œé‚£ä¹ˆæ‰ä¼šå†åˆ°node_modulesä¸­å»æ‰¾
       *
       */
      new webpack.DllReferencePlugin({
        manifest: path.resolve(__dirname, '../dll/vendors.manifest.json'),
      }),
    ],
  },
};
```

**ç¬¬å››æ­¥ï¼š** é…ç½® `package.json` æ–‡ä»¶ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```json
{
  "scripts": {
    "build:dll": "webpack --config ./build/webpack.dll.js"
  }
}
```

é€šè¿‡è¿è¡Œ `npm run build:dll` å‘½ä»¤ï¼Œæ¥å®ç°å¯¹ç¬¬ä¸‰æ–¹åº“çš„æ‰“åŒ…ã€‚

## 6. æ§åˆ¶åŒ…æ–‡ä»¶å¤§å°

åœ¨æˆ‘ä»¬åšé¡¹ç›®æ‰“åŒ…æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥è®©æˆ‘ä»¬æ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶å°½å¯èƒ½çš„å°ã€‚æœ‰æ—¶æˆ‘ä»¬åœ¨å†™ä»£ç çš„æ—¶å€™ï¼Œç»å¸¸ä¼šåœ¨é¡µé¢é‡Œé¢å¼•å…¥ä¸€äº›æ²¡æœ‰ç”¨çš„æ¨¡å—ï¼Œä¹Ÿå°±æ˜¯å¼•å…¥ä¸€äº›æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å—ã€‚

è¿™ä¸ªæ—¶å€™å¦‚æœä½ æ²¡æœ‰é…ç½® `Tree-Shaking` ï¼Œå°±ä¼šå¾ˆå®¹æ˜“é€ æˆæ‰“åŒ…çš„æ—¶å€™ï¼Œå‡ºç°å¤§é‡å†—ä½™çš„ä»£ç ã€‚è¿™äº›å†—ä½™ä»£ç å‘¢ï¼Œé—´æ¥åœ°ï¼Œå°±ä¼šæ‹–ç´¯æˆ‘ä»¬ `webpack` çš„æ‰“åŒ…é€Ÿåº¦ã€‚

æ‰€ä»¥å‘¢ï¼Œæˆ‘ä»¬åœ¨åšæ‰“åŒ…æ—¶ï¼Œè¦æ§åˆ¶å¥½æ–‡ä»¶çš„å¤§å°ã€‚**å…·ä½“æ­¥éª¤å‚è€ƒå¦‚ä¸‹ï¼š**

- é…ç½® `Tree-shaking` ï¼›
- é€šè¿‡ `SplittingChunk` æ¥å°†ä¸€ä¸ªå¤§çš„æ–‡ä»¶åˆ†å‰²æˆå¤šä¸ªå°çš„æ–‡ä»¶ã€‚

## 7. å¤šè¿›ç¨‹æ‰“åŒ…

`webpack` æ˜¯é€šè¿‡ node æ¥è¿è¡Œçš„ï¼Œæ‰€ä»¥å®ƒçš„æ‰“åŒ…è¿‡ç¨‹æ˜¯å•çº¿ç¨‹çš„ã€‚é‚£æœ‰æ—¶å€™å‘¢ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å€ŸåŠ© `node` é‡Œé¢çš„å¤šè¿›ç¨‹ï¼Œæ¥å¸®åŠ©æˆ‘ä»¬æå‡ `webpack` çš„æ‰“åŒ…é€Ÿåº¦ã€‚

å¸¸è§å·¥å…·æœ‰ `thread-loader` ï¼Œ `parallel-webpack` ï¼Œ `happypack` ç­‰å·¥å…·ï¼Œå¤§å®¶å¯ä»¥ä¾æ®è‡ªèº«éœ€æ±‚æŸ¥æ‰¾ç›¸å…³èµ„æ–™ï¼Œé€‰å‡ºæœ€é€‚åˆè‡ªå·±é¡¹ç›®çš„å·¥å…·ï¼Œè¿›è¡Œæ‰“åŒ…ã€‚è¿™ä¸€å—ä¸å†è¿›è¡Œè¯¦ç»†è®²è§£~

## 8. åˆç†ä½¿ç”¨ sourceMap

é€šå¸¸æƒ…å†µä¸‹ï¼Œ `sourceMap` è¶Šè¯¦ç»†ï¼Œé‚£ä¹ˆæ‰“åŒ…çš„é€Ÿåº¦å°±ä¼šè¶Šæ…¢ã€‚æ‰€ä»¥åœ¨åšæ‰“åŒ…çš„æ—¶å€™ï¼Œè¦æ ¹æ®å½“å‰æ˜¯å¼€å‘ç¯å¢ƒè¿˜æ˜¯ç”Ÿäº§ç¯å¢ƒï¼Œé€‰å‡ºæœ€åˆé€‚çš„ `sourceMap` é…ç½®ï¼Œæ¥ç”Ÿæˆæˆ‘ä»¬å¯¹åº”çš„ä»£ç è°ƒé”™æ–‡ä»¶ã€‚

è¿™æ ·ï¼Œä¸€æ–¹é¢èƒ½ä¿è¯æˆ‘ä»¬å³ä½¿å‘ç°ä»£ç é‡Œçš„é”™è¯¯é—®é¢˜ã€‚å¦ä¸€æ–¹é¢å‘¢ï¼Œä¹Ÿå¯ä»¥å°½å¯èƒ½åœ°æå‡æ‰“åŒ…é€Ÿåº¦ã€‚

## 9. ç»“åˆ stats åˆ†ææ‰“åŒ…ç»“æœ

åœ¨æ‰“åŒ…é¡¹ç›®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤ï¼Œæ¥ç”Ÿæˆè¿™æ¬¡æ‰“åŒ…æƒ…å†µçš„ `stats` æ–‡ä»¶ï¼Œä¹‹åå‘¢ï¼Œé€šè¿‡å€ŸåŠ©ä¸€äº›çº¿ä¸Šæˆ–è€…æœ¬åœ°çš„æ‰“åŒ…åˆ†æå·¥å…·ï¼Œæ¥è¾¾åˆ°åˆ†ææˆ‘ä»¬æœ¬æ¬¡æ‰“åŒ…è¿‡ç¨‹ä¸­çš„æ‰“åŒ…æƒ…å†µã€‚

æ¯”å¦‚è¯´ï¼Œåˆ†æå“ªä¸ªæ¨¡å—æ‰“åŒ…çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œå“ªä¸ªæ¨¡å—æ‰“åŒ…åˆ†æçš„æ—¶é—´æ¯”è¾ƒçŸ­ç­‰ç­‰å†…å®¹ï¼Œä¾æ®å…·ä½“çš„æƒ…å†µè¿›è¡Œä¼˜åŒ–ã€‚

## 10. å¼€å‘ç¯å¢ƒå†…å­˜ç¼–è¯‘

ä½¿ç”¨ `webpackDevServer` æ¥è¿›è¡Œç¼–è¯‘ï¼Œå®ƒä¸ä¼šæŠŠæ‰“åŒ…ç”Ÿæˆçš„æ–‡ä»¶æ”¾åœ¨ `dist` ç›®å½•ä¸­å»ï¼Œè€Œæ˜¯æŠŠå…¶æ”¾åˆ°äº†æˆ‘ä»¬ç”µè„‘çš„å†…å­˜ä¸­ã€‚

## 11. å¼€å‘ç¯å¢ƒæ— ç”¨æ’ä»¶å‰”é™¤

æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬åœ¨å¼€å‘ç¯å¢ƒçš„æƒ…å†µä¸‹ï¼Œå¹¶ä¸éœ€è¦å¯¹ä»£ç è¿›è¡Œå‹ç¼©ã€‚å› æ­¤ï¼Œå¯¹åº”çš„å‹ç¼©æ’ä»¶æˆ‘ä»¬å°±ä¸è¦åœ¨å¼€å‘ç¯å¢ƒä¸­é…ç½®ï¼Œåªåœ¨ç”Ÿäº§ç¯å¢ƒä¸­é…ç½®å°±å¥½äº†ã€‚è¿™æ ·ï¼Œå¯ä»¥å‡å°‘ä¸€äº›ä¸å¿…è¦çš„æ‰“åŒ…æ—¶é—´ã€‚

# ğŸï¸ ä¸ƒã€å¤šé¡µé¢æ‰“åŒ…é…ç½®

é€šå¸¸æƒ…å†µæ¥è¯´ï¼Œä½†å‡¡æˆ‘ä»¬åœ¨åšæ‰“åŒ…çš„æ—¶å€™ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯å¯¹å•é¡µé¢åº”ç”¨åšæ‰“åŒ…ã€‚ä»€ä¹ˆæ˜¯å•é¡µé¢å‘¢ï¼Œä¹Ÿå°±æ˜¯åªæœ‰ä¸€ä¸ª `index.html` æ–‡ä»¶ã€‚åƒç›®å‰æ¯”è¾ƒä¸»æµçš„æ¡†æ¶ï¼Œ `vue` å’Œ `react` ç­‰æ¡†æ¶ï¼Œéƒ½æ˜¯å•é¡µé¢åº”ç”¨ã€‚ä½†æ˜¯å¦‚æœåƒä¸€äº›æ¯”è¾ƒè€çš„æ¡†æ¶ï¼Œæ¯”å¦‚ `jquery` å’Œ `zepto` ï¼Œå¯èƒ½å°±éœ€è¦è¿›è¡Œå¤šé¡µé¢åº”ç”¨æ‰“åŒ…ã€‚

å› æ­¤ï¼Œé¡ºç€è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘ä»¬æ¥è°ˆè°ˆï¼Œåœ¨ `webpack` ä¸­ï¼Œå¦‚ä½•å¯¹å¤šé¡µé¢åº”ç”¨ï¼Œè¿›è¡Œæ‰“åŒ…é…ç½®ã€‚

æˆ‘ä»¬åœ¨ `webpack.common.js` ä¸­è¿›è¡Œé…ç½®ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
const HtmlWebpackPlugin = require('html-webpack-plugin');
module.exports = {
  entry: {
    //å¼•å…¥å¤šä¸ªå…¥å£æ–‡ä»¶
    main: './src/index.js',
    list: './src/list.js',
  },
  plugins: [
    new HtmlWebpackPlugin({
      template: 'src/index.html',
      filename: 'index.html',
      //chunkè¡¨æ˜è¿™äº›htmlæ–‡ä»¶è¦å¼•å…¥çš„æ–‡ä»¶æœ‰å“ªäº›
      chunks: ['runtime', 'vendors', 'main'],
    }),
    new HtmlWebpackPlugin({
      template: 'src/index.html',
      filename: 'list.html',
      chunks: ['runtime', 'vendors', 'list'],
    }),
  ],
};
```

é€šè¿‡ä»¥ä¸Šä»£ç æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå¢åŠ  `entry` å’Œ `plugins` çš„é…ç½®ï¼Œæ¥å¢åŠ å¤šä¸ªå…¥å£é¡µé¢ï¼Œä»è€Œè¾¾åˆ°äº†**å¤šé¡µé¢åº”ç”¨**é…ç½®çš„æ•ˆæœã€‚

# ğŸ›µ å…«ã€ç»“æŸè¯­

é€šè¿‡ä¸Šæ–‡çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹ `webpack` åœ¨ä¸€äº›åœºæ™¯ä¸­çš„å®æˆ˜é…ç½®æœ‰äº†ä¸€å®šçš„äº†è§£ã€‚ä¸Šé¢è®²è¿°çš„ä¹Ÿæ˜¯æ¯”è¾ƒæµ…æ˜¾çš„å†…å®¹ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®ç›¸å¯¹åº”çš„çŸ¥è¯†ç‚¹ï¼Œè¿›è¡ŒçŸ¥è¯†é¢çš„æ‹“å®½ï¼Œä»¥ä¾¿æ›´å¥½çš„åº”ç”¨åˆ°å®é™…çš„é¡¹ç›®å½“ä¸­ã€‚

åˆ°è¿™é‡Œï¼Œå…³äº `webpack` çš„å®æˆ˜æ¡ˆä¾‹é…ç½®å°±è®²è§£ç»“æŸå•¦ï¼å¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©~

å¦‚æ–‡ç« æœ‰è¯¯æˆ–æœ‰ä¸ç†è§£çš„åœ°æ–¹ï¼Œæ¬¢è¿å°ä¼™ä¼´ä»¬è¯„è®ºåŒºç•™è¨€å“¦ ğŸ’¬

æœ¬æ–‡ä»£ç å·²ä¸Šä¼ è‡³å…¬ä¼—å·ï¼Œåå°å›å¤å…³é”®è¯ `webpack` å³å¯è·å–~

# ğŸ£ å½©è›‹ One More Thing

## ï¼ˆï¼šå¾€æœŸæ¨è

- webpack å…¥é—¨åŸºç¡€çŸ¥è¯† ğŸ‘‰[ä¸ä¼š webpack çš„å‰ç«¯å¯èƒ½æ˜¯æ¡æ¥çš„ï¼Œä¸‡å­—æ€»ç»“ webpack çš„è¶…å…¥é—¨æ ¸å¿ƒçŸ¥è¯†](https://blog.csdn.net/weixin_44803753/article/details/118728201)
- webpack å…¥é—¨è¿›é˜¶çŸ¥è¯† ğŸ‘‰[webpack å…¥é—¨æ ¸å¿ƒçŸ¥è¯†è¿˜çœ‹ä¸è¿‡ç˜¾ï¼Ÿé€Ÿæ¥å›´è§‚è¿›é˜¶çŸ¥è¯†](https://blog.csdn.net/weixin_44803753/article/details/118885391)

## ï¼ˆï¼šç•ªå¤–ç¯‡

> - å…³æ³¨å…¬ä¼—å·**æ˜ŸæœŸä¸€ç ”ç©¶å®¤**ï¼Œç¬¬ä¸€æ—¶é—´å…³æ³¨ä¼˜è´¨æ–‡ç« ï¼Œ**æ›´å¤šç²¾é€‰ä¸“æ å¾…ä½ è§£é”**~
> - å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œè®°å¾—**ç•™ä¸ªè„šå° jio**å†èµ°å“¦~
> - ä»¥ä¸Šå°±æ˜¯æœ¬æ–‡çš„å…¨éƒ¨å†…å®¹ï¼æˆ‘ä»¬ä¸‹æœŸè§ï¼ğŸ‘‹ğŸ‘‹ğŸ‘‹
