---
title: æœºå™¨å­¦ä¹ ä¸ç¥ç»ç½‘ç»œç®€ä»‹
author: å‘¨ä¸€
date: '2023-08-05'
categories:
  - äººå·¥æ™ºèƒ½
tags:
  - æœºå™¨å­¦ä¹ 
sidebar: 'auto'
---



# èƒŒæ™¯

å‰é¢æˆ‘ä»¬ä¸€ç›´åœ¨ä»‹ç»**äºŒåˆ†ç±»çš„é€»è¾‘å›å½’**é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦è¾“å‡ºä¸€ä¸ªæ¦‚ç‡å°±å¯ä»¥å¯¹æ•°æ®é›†è¿›è¡ŒäºŒåˆ†ç±»ã€‚ä½†æ˜¯åœ¨ç°å®ç”Ÿæ´»ä¸­ä¸ä»…åŒ…å«äºŒåˆ†ç±»é—®é¢˜ï¼Œä¹ŸåŒ…å«å¾ˆå¤šåˆ†ç±»é—®é¢˜ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¯´ä½ åœ¨ç”»æ¿ä¸Šæ‰‹å†™äº†ä¸€ä¸ªæ•°å­—ï¼Œä½ ç”¨ç¥ç»ç½‘ç»œæ¥åˆ¤æ–­è¿™ä¸ªæ‰‹å†™çš„æ•°å­—æ˜¯ 0- 9 å“ªä¸ªæ•°å­—ï¼Œé‚£ä¹ˆè¿™ä¸ªé—®é¢˜ä¸€å…±å°±æœ‰ 10 ä¸ªåˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯å¤šåˆ†ç±»ã€‚å†æ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ç¥ç»ç½‘ç»œå¯¹é€šç”¨çš„å›¾ç‰‡è¿›è¡Œåˆ†ç±»ï¼Œæ¯”å¦‚è¯´åˆ¤æ–­ä¸€å¼ å›¾ç‰‡é‡Œé¢æ˜¯å¦æœ‰é’¢ç´ã€è‡ªè¡Œè½¦ã€å…¬é¸¡ã€æ¯é¸¡ã€çŒ«ç‹—ç­‰ç­‰ï¼Œå¯èƒ½å°±ä¼šæœ‰æˆåƒä¸Šä¸‡ç§åˆ†ç±»äº†ã€‚é‚£åœ¨ä¸‹é¢ï¼Œæˆ‘ä»¬å°±æ¥è°ˆè°ˆ**å¤šåˆ†ç±»**ã€‚

# ä¸€ã€ä»»åŠ¡ç®€ä»‹ã€ä¸»è¦æ­¥éª¤

## 1ã€ä»»åŠ¡ç®€ä»‹ - é¸¢å°¾èŠ±ä¾‹å­

é¢å¯¹è¿™æ ·çš„å¤šåˆ†ç±»é—®é¢˜ï¼Œæˆ‘ä»¬è¯¥æ„å»ºæ€æ ·çš„ç¥ç»ç½‘ç»œæ‰èƒ½è§£å†³å®ƒä»¬å‘¢ï¼Ÿ

åœ¨åº”å¯¹æ›´ä¸ºå¤æ‚çš„å¤šåˆ†ç±»é—®é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªè‘—åçš„**é¸¢å°¾èŠ±åˆ†ç±»**æ¥è¿›è¡Œå­¦ä¹ ã€‚é¸¢å°¾èŠ±çš„è‹±æ–‡å«åš`Iris`ï¼Œè¿™ä¸ªæ•°æ®é›†å·²ç»è¯ç”Ÿå¾ˆå¤šå¹´äº†ï¼Œæ— æ•°çš„æ•°æ®ç§‘å­¦å®¶ç”¨å®ƒä½œä¸º**æ•°æ®é›†**å»éªŒè¯è‡ªå·±çš„ç®—æ³•ä»¥åŠæ¨¡å‹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬ç”¨è¿™ä¸ªæ•°æ®é›†æ¥è¿›è¡Œå¤šåˆ†ç±»ã€‚

ä¸‹é¢ï¼Œç»§ç»­ç»™å¤§å®¶ä»‹ç»ä¸€ä¸‹**ä»€ä¹ˆæ˜¯é¸¢å°¾èŠ±åˆ†ç±»**ã€‚æˆ‘ä»¬è¿™ä¸ªåˆ†ç±»é—®é¢˜æ˜¯è¦æ ¹æ®é¸¢å°¾èŠ±çš„**èŠ±ç“£**é•¿åº¦å®½åº¦ï¼Œ**èŠ±é³„**çš„é•¿åº¦å®½åº¦æ¥å°†é¸¢å°¾èŠ±åˆ†ä¸ºä¸‰ä¸ªç±»åˆ«ï¼Œåˆ†åˆ«æ˜¯**å±±é¸¢å°¾ï¼ˆIris setosaï¼‰**ã€**å˜è‰²çƒŸå°¾**å’Œ**ç»´å‰å°¼äºšé¸¢å°¾ï¼ˆIris virginicaï¼‰**ã€‚

é‚£èŠ±ç“£çš„é•¿åº¦å®½åº¦ï¼ŒèŠ±è¼çš„é•¿åº¦å®½åº¦ï¼Œå°±ä¸€å…±æœ‰4ä¸ªç‰¹å¾ã€‚ä¹‹å‰æˆ‘ä»¬æ„å»ºçš„ç¥ç»ç½‘ç»œéƒ½æ˜¯ä¸¤ä¸ªç‰¹å¾ï¼Œç°åœ¨å°±å˜æˆå››ä¸ªç‰¹å¾ã€‚é‚£å¯¹äºæ›´ä¸ºå¤æ‚çš„ç¥ç»ç½‘ç»œï¼Œæˆ‘ä»¬è¯¥æ€æ ·æ„å»ºå‘¢ï¼Ÿä»¥è‡³äºæ—¢èƒ½è§£å†³è¿™ä¸ªå¤šåˆ†ç±»é—®é¢˜ï¼Œåˆèƒ½è¾“å‡ºè¿™ä¸ªå¤šåˆ†ç±»çš„æ¦‚ç‡è¾“å‡ºï¼Œä¸”æ»¡è¶³å¤šåˆ†ç±»çš„ç»“æœã€‚

äº‹å®ä¸Šï¼Œé¢å¯¹è¿™æ ·çš„é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦æ„å»ºä¸€ä¸ªå¤šå±‚ç¥ç»ç½‘ç»œï¼Œå¹¶åœ¨ç¥ç»ç½‘ç»œçš„æœ€åä¸€å±‚åŠ ä¸€ä¸ª `Softmax` æ¿€æ´»å‡½æ•°å°±å¯ä»¥äº†ã€‚

![img](https://mondaylab-1309616765.cos.ap-shanghai.myqcloud.com/images/202407132127681.png)

## 2ã€ä¸»è¦æ­¥éª¤

- åŠ è½½ `IRIS` æ•°æ®é›†ï¼ˆè®­ç»ƒé›†ä¸éªŒè¯é›†ï¼‰
- å®šä¹‰æ¨¡å‹ç»“æ„ï¼šå¸¦æœ‰`softmax`çš„å¤šå±‚ç¥ç»ç½‘ç»œ
- è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹

# äºŒã€åŠ è½½irisæ•°æ®é›†ï¼ˆè®­ç»ƒé›†ä¸éªŒè¯é›†ï¼‰

## 1ã€å…³äºè®­ç»ƒé›†å’ŒéªŒè¯é›†

- è®­ç»ƒé›†ç”¨äºåé¢çš„æ¨¡å‹è®­ç»ƒï¼Œè€ŒéªŒè¯é›†åˆ™ç”¨äºéªŒè¯æ¨¡å‹æ˜¯å¦è®­ç»ƒçš„è¶Šæ¥è¶Šå¥½ã€‚
- éªŒè¯é›†è·Ÿè®­ç»ƒé›†çš„æ•°æ®æ ¼å¼æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚åœ¨å®é™…çš„å·¥ä½œä¸­ï¼ŒéªŒè¯é›†å¾€å¾€éƒ½æ˜¯ä»è®­ç»ƒé›†é‡Œé¢åˆ†ä¸€éƒ¨åˆ†å‡ºæ¥çš„ï¼Œå®ƒä¿©çš„æ ¼å¼ä¸€æ¨¡ä¸€æ ·ï¼Œä¹Ÿå°±æ„å‘³ç€è®­ç»ƒé›†è·ŸéªŒè¯é›†éƒ½åŒ…æ‹¬äº†è¾“å…¥ç‰¹å¾å’Œå¯¹åº”çš„æ ‡ç­¾ã€‚
- è™½ç„¶å®ƒä¿©æ ¼å¼ä¸€æ ·ï¼Œä½†ä½†æ˜¯ä½œç”¨ä¸ä¸€æ ·ã€‚è®­ç»ƒé›†æ˜¯ç”¨äºè®­ç»ƒç¥ç»ç½‘ç»œçš„ï¼Œæ¢å¥è¯è¯´ï¼Œç¥ç»ç½‘ç»œçš„æƒé‡ä¼šå› ä¸ºè®­ç»ƒé›†çš„æ•°æ®è€Œå˜åŒ–ï¼Œä½†æ˜¯å®ƒçš„æƒé‡å´ä¸ä¼šå› ä¸ºéªŒè¯çº§çš„æ•°æ®è€Œå˜åŒ–ï¼Œå› ä¸ºéªŒè¯çº§åªæ˜¯**ç”¨æ¥éªŒè¯è¿™ä¸ªæ¨¡å‹æ˜¯å¦è®­ç»ƒçš„è¶Šæ¥è¶Šå¥½äº†**ã€‚
- ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¯´åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è®­ç»ƒé›†çš„æŸå¤±è¶Šæ¥è¶Šä½äº†ï¼Œä½†æ˜¯éªŒè¯çº§çš„æŸå¤±å´è¶Šæ¥è¶Šé«˜ï¼Œé‚£å°±è¯æ˜ä½ è¿™ä¸ªæ¨¡å‹æ²¡æœ‰è¶Šè®­ç»ƒè¶Šå¥½ï¼Œä½ å°±è¯¥åœæ­¢äº†ï¼Œè¿™ä¸ªæ—¶å€™å°±è¦æ€è€ƒä¸‹è¦ä¸è¦æ”¹ä¸€äº›æ¨¡å‹ç»“æ„æˆ–è€…å…¶ä»–è¶…å‚æ•°å†è®­ç»ƒå®ƒã€‚

## 1ã€æ“ä½œæ­¥éª¤

- ä½¿ç”¨é¢„å…ˆå‡†å¤‡å¥½çš„è„šæœ¬ç”Ÿæˆ`IRIS`çš„æ•°æ®é›†ï¼ŒåŒ…æ‹¬è®­ç»ƒé›†ä¸éªŒè¯é›†
- å¤šæ‰“å° IRIS æ•°æ®é›†

## 2ã€è®­ç»ƒè¿‡ç¨‹

é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ª `data.js` æ–‡ä»¶ï¼ŒåŠŸèƒ½ä¸»è¦ç”¨æ¥**ç”ŸæˆäºŒåˆ†ç±»æ•°æ®é›†**ã€‚

```JavaScript
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */

import * as tf from '@tensorflow/tfjs';

export const IRIS_CLASSES =
    ['å±±é¸¢å°¾', 'å˜è‰²é¸¢å°¾', 'ç»´å‰å°¼äºšé¸¢å°¾'];
export const IRIS_NUM_CLASSES = IRIS_CLASSES.length;

// Iris flowers data. Source:
//   https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data
const IRIS_DATA = [
  [5.1, 3.5, 1.4, 0.2, 0], [4.9, 3.0, 1.4, 0.2, 0], [4.7, 3.2, 1.3, 0.2, 0],
  [4.6, 3.1, 1.5, 0.2, 0], [5.0, 3.6, 1.4, 0.2, 0], [5.4, 3.9, 1.7, 0.4, 0],
  [4.6, 3.4, 1.4, 0.3, 0], [5.0, 3.4, 1.5, 0.2, 0], [4.4, 2.9, 1.4, 0.2, 0],
  [4.9, 3.1, 1.5, 0.1, 0], [5.4, 3.7, 1.5, 0.2, 0], [4.8, 3.4, 1.6, 0.2, 0],
  [4.8, 3.0, 1.4, 0.1, 0], [4.3, 3.0, 1.1, 0.1, 0], [5.8, 4.0, 1.2, 0.2, 0],
  [5.7, 4.4, 1.5, 0.4, 0], [5.4, 3.9, 1.3, 0.4, 0], [5.1, 3.5, 1.4, 0.3, 0],
  [5.7, 3.8, 1.7, 0.3, 0], [5.1, 3.8, 1.5, 0.3, 0], [5.4, 3.4, 1.7, 0.2, 0],
  [5.1, 3.7, 1.5, 0.4, 0], [4.6, 3.6, 1.0, 0.2, 0], [5.1, 3.3, 1.7, 0.5, 0],
  [4.8, 3.4, 1.9, 0.2, 0], [5.0, 3.0, 1.6, 0.2, 0], [5.0, 3.4, 1.6, 0.4, 0],
  [5.2, 3.5, 1.5, 0.2, 0], [5.2, 3.4, 1.4, 0.2, 0], [4.7, 3.2, 1.6, 0.2, 0],
  [4.8, 3.1, 1.6, 0.2, 0], [5.4, 3.4, 1.5, 0.4, 0], [5.2, 4.1, 1.5, 0.1, 0],
  [5.5, 4.2, 1.4, 0.2, 0], [4.9, 3.1, 1.5, 0.1, 0], [5.0, 3.2, 1.2, 0.2, 0],
  [5.5, 3.5, 1.3, 0.2, 0], [4.9, 3.1, 1.5, 0.1, 0], [4.4, 3.0, 1.3, 0.2, 0],
  [5.1, 3.4, 1.5, 0.2, 0], [5.0, 3.5, 1.3, 0.3, 0], [4.5, 2.3, 1.3, 0.3, 0],
  [4.4, 3.2, 1.3, 0.2, 0], [5.0, 3.5, 1.6, 0.6, 0], [5.1, 3.8, 1.9, 0.4, 0],
  [4.8, 3.0, 1.4, 0.3, 0], [5.1, 3.8, 1.6, 0.2, 0], [4.6, 3.2, 1.4, 0.2, 0],
  [5.3, 3.7, 1.5, 0.2, 0], [5.0, 3.3, 1.4, 0.2, 0], [7.0, 3.2, 4.7, 1.4, 1],
  [6.4, 3.2, 4.5, 1.5, 1], [6.9, 3.1, 4.9, 1.5, 1], [5.5, 2.3, 4.0, 1.3, 1],
  [6.5, 2.8, 4.6, 1.5, 1], [5.7, 2.8, 4.5, 1.3, 1], [6.3, 3.3, 4.7, 1.6, 1],
  [4.9, 2.4, 3.3, 1.0, 1], [6.6, 2.9, 4.6, 1.3, 1], [5.2, 2.7, 3.9, 1.4, 1],
  [5.0, 2.0, 3.5, 1.0, 1], [5.9, 3.0, 4.2, 1.5, 1], [6.0, 2.2, 4.0, 1.0, 1],
  [6.1, 2.9, 4.7, 1.4, 1], [5.6, 2.9, 3.6, 1.3, 1], [6.7, 3.1, 4.4, 1.4, 1],
  [5.6, 3.0, 4.5, 1.5, 1], [5.8, 2.7, 4.1, 1.0, 1], [6.2, 2.2, 4.5, 1.5, 1],
  [5.6, 2.5, 3.9, 1.1, 1], [5.9, 3.2, 4.8, 1.8, 1], [6.1, 2.8, 4.0, 1.3, 1],
  [6.3, 2.5, 4.9, 1.5, 1], [6.1, 2.8, 4.7, 1.2, 1], [6.4, 2.9, 4.3, 1.3, 1],
  [6.6, 3.0, 4.4, 1.4, 1], [6.8, 2.8, 4.8, 1.4, 1], [6.7, 3.0, 5.0, 1.7, 1],
  [6.0, 2.9, 4.5, 1.5, 1], [5.7, 2.6, 3.5, 1.0, 1], [5.5, 2.4, 3.8, 1.1, 1],
  [5.5, 2.4, 3.7, 1.0, 1], [5.8, 2.7, 3.9, 1.2, 1], [6.0, 2.7, 5.1, 1.6, 1],
  [5.4, 3.0, 4.5, 1.5, 1], [6.0, 3.4, 4.5, 1.6, 1], [6.7, 3.1, 4.7, 1.5, 1],
  [6.3, 2.3, 4.4, 1.3, 1], [5.6, 3.0, 4.1, 1.3, 1], [5.5, 2.5, 4.0, 1.3, 1],
  [5.5, 2.6, 4.4, 1.2, 1], [6.1, 3.0, 4.6, 1.4, 1], [5.8, 2.6, 4.0, 1.2, 1],
  [5.0, 2.3, 3.3, 1.0, 1], [5.6, 2.7, 4.2, 1.3, 1], [5.7, 3.0, 4.2, 1.2, 1],
  [5.7, 2.9, 4.2, 1.3, 1], [6.2, 2.9, 4.3, 1.3, 1], [5.1, 2.5, 3.0, 1.1, 1],
  [5.7, 2.8, 4.1, 1.3, 1], [6.3, 3.3, 6.0, 2.5, 2], [5.8, 2.7, 5.1, 1.9, 2],
  [7.1, 3.0, 5.9, 2.1, 2], [6.3, 2.9, 5.6, 1.8, 2], [6.5, 3.0, 5.8, 2.2, 2],
  [7.6, 3.0, 6.6, 2.1, 2], [4.9, 2.5, 4.5, 1.7, 2], [7.3, 2.9, 6.3, 1.8, 2],
  [6.7, 2.5, 5.8, 1.8, 2], [7.2, 3.6, 6.1, 2.5, 2], [6.5, 3.2, 5.1, 2.0, 2],
  [6.4, 2.7, 5.3, 1.9, 2], [6.8, 3.0, 5.5, 2.1, 2], [5.7, 2.5, 5.0, 2.0, 2],
  [5.8, 2.8, 5.1, 2.4, 2], [6.4, 3.2, 5.3, 2.3, 2], [6.5, 3.0, 5.5, 1.8, 2],
  [7.7, 3.8, 6.7, 2.2, 2], [7.7, 2.6, 6.9, 2.3, 2], [6.0, 2.2, 5.0, 1.5, 2],
  [6.9, 3.2, 5.7, 2.3, 2], [5.6, 2.8, 4.9, 2.0, 2], [7.7, 2.8, 6.7, 2.0, 2],
  [6.3, 2.7, 4.9, 1.8, 2], [6.7, 3.3, 5.7, 2.1, 2], [7.2, 3.2, 6.0, 1.8, 2],
  [6.2, 2.8, 4.8, 1.8, 2], [6.1, 3.0, 4.9, 1.8, 2], [6.4, 2.8, 5.6, 2.1, 2],
  [7.2, 3.0, 5.8, 1.6, 2], [7.4, 2.8, 6.1, 1.9, 2], [7.9, 3.8, 6.4, 2.0, 2],
  [6.4, 2.8, 5.6, 2.2, 2], [6.3, 2.8, 5.1, 1.5, 2], [6.1, 2.6, 5.6, 1.4, 2],
  [7.7, 3.0, 6.1, 2.3, 2], [6.3, 3.4, 5.6, 2.4, 2], [6.4, 3.1, 5.5, 1.8, 2],
  [6.0, 3.0, 4.8, 1.8, 2], [6.9, 3.1, 5.4, 2.1, 2], [6.7, 3.1, 5.6, 2.4, 2],
  [6.9, 3.1, 5.1, 2.3, 2], [5.8, 2.7, 5.1, 1.9, 2], [6.8, 3.2, 5.9, 2.3, 2],
  [6.7, 3.3, 5.7, 2.5, 2], [6.7, 3.0, 5.2, 2.3, 2], [6.3, 2.5, 5.0, 1.9, 2],
  [6.5, 3.0, 5.2, 2.0, 2], [6.2, 3.4, 5.4, 2.3, 2], [5.9, 3.0, 5.1, 1.8, 2],
];

/**
 * Convert Iris data arrays to `tf.Tensor`s.
 *
 * @param data The Iris input feature data, an `Array` of `Array`s, each element
 *   of which is assumed to be a length-4 `Array` (for petal length, petal
 *   width, sepal length, sepal width).
 * @param targets An `Array` of numbers, with values from the set {0, 1, 2}:
 *   representing the true category of the Iris flower. Assumed to have the same
 *   array length as `data`.
 * @param testSplit Fraction of the data at the end to split as test data: a
 *   number between 0 and 1.
 * @return A length-4 `Array`, with
 *   - training data as `tf.Tensor` of shape [numTrainExapmles, 4].
 *   - training one-hot labels as a `tf.Tensor` of shape [numTrainExamples, 3]
 *   - test data as `tf.Tensor` of shape [numTestExamples, 4].
 *   - test one-hot labels as a `tf.Tensor` of shape [numTestExamples, 3]
 */
function convertToTensors(data, targets, testSplit) {
  const numExamples = data.length;
  if (numExamples !== targets.length) {
    throw new Error('data and split have different numbers of examples');
  }

  // Randomly shuffle `data` and `targets`.
  const indices = [];
  for (let i = 0; i < numExamples; ++i) {
    indices.push(i);
  }
  tf.util.shuffle(indices);

  const shuffledData = [];
  const shuffledTargets = [];
  for (let i = 0; i < numExamples; ++i) {
    shuffledData.push(data[indices[i]]);
    shuffledTargets.push(targets[indices[i]]);
  }

  // Split the data into a training set and a tet set, based on `testSplit`.
  const numTestExamples = Math.round(numExamples * testSplit);
  const numTrainExamples = numExamples - numTestExamples;

  const xDims = shuffledData[0].length;

  // Create a 2D `tf.Tensor` to hold the feature data.
  const xs = tf.tensor2d(shuffledData, [numExamples, xDims]);

  // Create a 1D `tf.Tensor` to hold the labels, and convert the number label
  // from the set {0, 1, 2} into one-hot encoding (.e.g., 0 --> [1, 0, 0]).
  const ys = tf.oneHot(tf.tensor1d(shuffledTargets).toInt(), IRIS_NUM_CLASSES);

  // Split the data into training and test sets, using `slice`.
  const xTrain = xs.slice([0, 0], [numTrainExamples, xDims]);
  const xTest = xs.slice([numTrainExamples, 0], [numTestExamples, xDims]);
  const yTrain = ys.slice([0, 0], [numTrainExamples, IRIS_NUM_CLASSES]);
  const yTest = ys.slice([0, 0], [numTestExamples, IRIS_NUM_CLASSES]);
  return [xTrain, yTrain, xTest, yTest];
}

/**
 * Obtains Iris data, split into training and test sets.
 *
 * @param testSplit Fraction of the data at the end to split as test data: a
 *   number between 0 and 1.
 *
 * @param return A length-4 `Array`, with
 *   - training data as an `Array` of length-4 `Array` of numbers.
 *   - training labels as an `Array` of numbers, with the same length as the
 *     return training data above. Each element of the `Array` is from the set
 *     {0, 1, 2}.
 *   - test data as an `Array` of length-4 `Array` of numbers.
 *   - test labels as an `Array` of numbers, with the same length as the
 *     return test data above. Each element of the `Array` is from the set
 *     {0, 1, 2}.
 */
export function getIrisData(testSplit) {
  return tf.tidy(() => {
    const dataByClass = [];
    const targetsByClass = [];
    for (let i = 0; i < IRIS_CLASSES.length; ++i) {
      dataByClass.push([]);
      targetsByClass.push([]);
    }
    for (const example of IRIS_DATA) {
      const target = example[example.length - 1];
      const data = example.slice(0, example.length - 1);
      dataByClass[target].push(data);
      targetsByClass[target].push(target);
    }

    const xTrains = [];
    const yTrains = [];
    const xTests = [];
    const yTests = [];
    for (let i = 0; i < IRIS_CLASSES.length; ++i) {
      const [xTrain, yTrain, xTest, yTest] =
          convertToTensors(dataByClass[i], targetsByClass[i], testSplit);
      xTrains.push(xTrain);
      yTrains.push(yTrain);
      xTests.push(xTest);
      yTests.push(yTest);
    }

    const concatAxis = 0;
    return [
      tf.concat(xTrains, concatAxis), tf.concat(yTrains, concatAxis),
      tf.concat(xTests, concatAxis), tf.concat(yTests, concatAxis)
    ];
  });
}
```

æ¥ç€ï¼Œåˆ›å»º`script.js`æ–‡ä»¶ï¼Œæ¥åŠ è½½`Iris`çš„æ•°æ®é›†ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```JavaScript
import * as tf from '@tensorflow/tfjs';
import * as tfvis from '@tensorflow/tfjs-vis';
import { getData } from './data.js';

window.onload = async () => {
  // åŠ è½½æ•°æ®é›†
  // xTrainä»£è¡¨è¾“å…¥çš„ç‰¹å¾ï¼›xTestä»£è¡¨è®­ç»ƒé›†çš„æ‰€æœ‰æ ‡ç­¾
  const [xTrain, yTrain, xTest, yTest] = getIrisData(0.15);
}
```

# ä¸‰ã€å®šä¹‰æ¨¡å‹ç»“æ„ï¼šå¸¦æœ‰softmaxçš„å¤šå±‚ç¥ç»ç½‘ç»œ

## 1ã€æ“ä½œæ­¥éª¤

- åˆå§‹åŒ–ä¸€ä¸ªç¥ç»ç½‘ç»œæ¨¡å‹
- ä¸ºç¥ç»ç½‘ç»œæ¨¡å‹æ·»åŠ ä¸¤ä¸ªå±‚
- è®¾è®¡è¿™ä¸¤ä¸ªå±‚çš„ç¥ç»å…ƒä¸ªæ•°ã€inputShapeã€æ¿€æ´»å‡½æ•°

## 2ã€è®­ç»ƒè¿‡ç¨‹

æˆ‘ä»¬éœ€è¦ç”¨`model`ï¼Œæ¥ä¸ºè¿™ä¸ªç¥ç»ç½‘ç»œç½‘ç»œæ·»åŠ **ä¸¤ä¸ªå±‚**ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ğŸ‘‡ğŸ»ï¼š

```JavaScript
import * as tf from '@tensorflow/tfjs';
import * as tfvis from '@tensorflow/tfjs-vis';
import { getData } from './data.js';

window.onload = async () => {
  // åŠ è½½æ•°æ®é›†
  // xTrainä»£è¡¨è¾“å…¥çš„ç‰¹å¾ï¼›yä»£è¡¨è®­ç»ƒé›†çš„æ‰€æœ‰æ ‡ç­¾
  const [xTrain, yTrain, xTest, yTest] = getIrisData(0.15);
  
  const model = tf.sequential();
  // å¸¦æœ‰softmaxçš„å¤šå±‚ç¥ç»ç½‘ç»œ
  model.add(
    tf.layers.dense({
      units: 10,
      inputShape: [xTrain.shape[1]],
      activation: 'sigmoid'
    })
  );
  model.add(
    tf.layers.dense({
      units: 3,
      activation: 'softmax'
    })
  );
}
```

# å››ã€è®­ç»ƒæ¨¡å‹ï¼šäº¤å‰ç†µæŸå¤±å‡½æ•°ä¸å‡†ç¡®åº¦åº¦é‡

## 1ã€æ“ä½œæ­¥éª¤

- è®¾ç½®äº¤å‰ç†µå‡½æ•°
- æ·»åŠ å‡†ç¡®åº¦åº¦é‡
- è®­ç»ƒæ¨¡å‹å¹¶ä½¿ç”¨`tfvis`å¯è§†åŒ–è®­ç»ƒè¿‡ç¨‹

## 2ã€è®­ç»ƒè¿‡ç¨‹

æ·»åŠ å®Œæˆç¥ç»ç½‘ç»œçš„å±‚ä¹‹åï¼Œæ¥ä¸‹æ¥è¦ä¸ºè¿™ä¸ªæ¨¡å‹ï¼Œè®¾ç½®**äº¤å‰ç†µæŸå¤±å‡½æ•°ä¸å‡†ç¡®åº¦åº¦é‡**ï¼Œä¹‹åè¿›è¡Œé¢„æµ‹ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ğŸ‘‡ğŸ»ï¼š

```JavaScript
import * as tf from '@tensorflow/tfjs';
import * as tfvis from '@tensorflow/tfjs-vis';
import { getData } from './data.js';

window.onload = async () => {
  // åŠ è½½æ•°æ®é›†
  â€¦â€¦
  
  // å®šä¹‰æ¨¡å‹ç»“æ„ 
  â€¦â€¦
  
  // äº¤å‰ç†µæŸå¤±å‡½æ•°ä¸å‡†ç¡®åº¦åº¦é‡
  model.compile({
    loss: 'categoricalCrossentropy', // è®¾ç½®æŸå¤±å‡½æ•°
    optimizer: tf.train.adam(0.1), // è®¾ç½®ä¼˜åŒ–å™¨
    metrics: ['accuracy'] // è®¾ç½®åº¦é‡
  });

  // å¼€å§‹è®­ç»ƒ
  await model.fit(xTrain, yTrain, {
    epochs: 100,
    validationData: [xTest, yTest],
    callbacks: tfvis.show.fitCallbacks(
      { name: 'è®­ç»ƒæ•ˆæœ' },
      ['loss', 'val_loss', 'acc', 'val_acc'],
      { callbacks: ['onEpochEnd'] } // è®¾ç½®å›¾æ ‡åªå±•ç¤º onEpochEnd
    )
  });
}
```

æœ€åï¼Œæ¥çœ‹ä¸‹æ•ˆæœï¼š

![img](https://mondaylab-1309616765.cos.ap-shanghai.myqcloud.com/images/202407132127254.png)

å¯ä»¥çœ‹åˆ°ï¼Œè“çº¿å’Œé»„çº¿åŸºæœ¬æ˜¯æ¥è¿‘é«˜åº¦å»åˆï¼Œæ‰€ä»¥è¯´é¢„æµ‹æ•ˆæœæ¥è¿‘95%+çš„æ­£ç¡®ç‡ã€‚

# äº”ã€å¤šåˆ†ç±»é¢„æµ‹æ–¹æ³•

## 1ã€æ“ä½œæ­¥éª¤

- ç¼–å†™å‰ç«¯ç•Œé¢ï¼Œå¹¶è¾“å…¥å¾…é¢„æµ‹æ•°æ®
- ä½¿ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹è¿›è¡Œé¢„æµ‹
- å°†è¾“å‡ºçš„`Tensor`è½¬ä¸ºæ™®é€šæ•°æ®å¹¶æ˜¾ç¤º

## 2ã€è®­ç»ƒè¿‡ç¨‹

é¦–å…ˆæˆ‘ä»¬æ–°å»ºä¸ªæ–‡ä»¶å¤¹ `index.html`ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

```HTML
<script src="script.js"></script>
<form action="" onsubmit="predict(this); return false;">
    èŠ±è¼é•¿åº¦ï¼š<input type="text" name="a"><br>
    èŠ±è¼å®½åº¦ï¼š<input type="text" name="b"><br>
    èŠ±ç“£é•¿åº¦ï¼š<input type="text" name="c"><br>
    èŠ±ç“£å®½åº¦ï¼š<input type="text" name="d"><br>
    <button type="submit">é¢„æµ‹</button>
</form>
```

æ¥ç€ï¼Œåœ¨`script.js`æ–‡ä»¶é‡Œé¢ï¼Œç»§ç»­ç¼–å†™**å¯¹æ•°æ®è¿›è¡Œé¢„æµ‹**çš„ä»£ç ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

```JavaScript
import * as tf from '@tensorflow/tfjs';
import * as tfvis from '@tensorflow/tfjs-vis';
import { getData } from './data.js';

window.onload = async () => {
  // åŠ è½½æ•°æ®é›†
  â€¦â€¦
  
  // å®šä¹‰æ¨¡å‹ç»“æ„ 
  â€¦â€¦
  
  // äº¤å‰ç†µæŸå¤±å‡½æ•°ä¸å‡†ç¡®åº¦åº¦é‡
  â€¦â€¦
  
  // å¤šåˆ†ç±»é¢„æµ‹æ–¹æ³•
  window.predict = (form) => {
    const input = tf.tensor([
      [form.a.value * 1, form.b.value * 1, form.c.value * 1, form.d.value * 1]
    ]);
    const pred = model.predict(input);
    alert(`é¢„æµ‹ç»“æœï¼š${IRIS_CLASSES[pred.argMax(1).dataSync(0)]}`);
  };
}
```

æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é¢„æµ‹æ•ˆæœï¼š

![img](https://mondaylab-1309616765.cos.ap-shanghai.myqcloud.com/images/202407132127103.gif)