---
title: æ¢ç§˜reactï¼Œä¸€æ–‡å¼„æ‡‚reactçš„åŸºæœ¬ä½¿ç”¨å’Œé«˜çº§ç‰¹æ€§
author: å‘¨ä¸€
date: '2021-12-12'
sidebar: 'auto'
---

æ¢ç§˜ reactï¼Œä¸€æ–‡å¼„æ‡‚ react çš„åŸºæœ¬ä½¿ç”¨å’Œé«˜çº§ç‰¹æ€§
27/100
å‘å¸ƒæ–‡ç« 
weixin_44803753
æœªé€‰æ‹©ä»»ä½•æ–‡ä»¶
![å°é¢](https://img-blog.csdnimg.cn/e7b11deeaac94d99a72e4103203e9c55.png#pic_center)

@[toc](ä¸€æ–‡è¯¦è§£reactçš„åŸºæœ¬ä½¿ç”¨ã€é«˜çº§ç‰¹æ€§å’Œå‘¨è¾¹æ’ä»¶)

# â° åºè¨€

å¯¹äºåˆšå­¦ä¹  `react` çš„å°ä¼™ä¼´æ¥è¯´ï¼Œæ€»æ˜¯ä»åŸºç¡€å¼€å§‹å­¦ä¹ ï¼Œå‘¨ä¸€è‡ªç„¶ä¹Ÿä¸ä¾‹å¤–æã€‚é‚£åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­ï¼Œå°†è®²è§£ `react` çš„åŸºæœ¬ä½¿ç”¨å’Œé«˜çº§ç‰¹æ€§ï¼Œæ›´æœ‰å‘¨è¾¹æ’ä»¶ `Redux` å’Œ `React-router` å¾…ä½ æ¥æ¢å¯»ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œèåˆå¤§é‡æ¡ˆä¾‹ ğŸŒ° å’ŒåŠ¨å›¾ ğŸ•¹ï¸ è¿›è¡Œå±•ç¤ºã€‚å¯ä»¥æŠŠå®ƒå½“æˆæ˜¯ `react` çš„å…¥é—¨å®åº“ï¼Œæœ‰ä¸æ‡‚çš„è¯­æ³•çŸ¥è¯†ç‚¹æ—¶æˆ–è®¸åœ¨è¿™é‡Œå¯ä»¥å¯»æ‰¾åˆ°ä½ çš„ç­”æ¡ˆå¹¶ä¸”é€šè¿‡ä¾‹å­è¿ç”¨èµ·æ¥ã€‚

å®ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢æ¥å¼€å§‹æ¢ç´¢ `react` çš„å¥¥ç§˜å§ ğŸ‘

# ğŸ“ ä¸€ã€React çš„åŸºæœ¬ä½¿ç”¨

## 1ã€JSX åŸºæœ¬ä½¿ç”¨

### ï¼ˆ1ï¼‰å˜é‡ã€è¡¨è¾¾å¼

åœ¨ `react` ä¸­ï¼Œæœ€åŸºç¡€çš„å†…å®¹ä¾¿æ˜¯å˜é‡å’Œè¡¨è¾¾å¼ï¼Œ**å…·ä½“å½¢å¼å¦‚ä¸‹ï¼š**

ç¬¬ä¸€ç§ç±»å‹ï¼šè·å–å˜é‡ã€æ’å€¼

```js
import React from 'react';

class JSXBaseDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      imgUrl:
        'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
      flag: true,
    };
  }
  render() {
    // è·å–å˜é‡ æ’å€¼
    const pElem = <p>{this.state.name}</p>;
    return pElem;
  }
}

export default JSXBaseDemo;
```

æ³¨æ„ï¼Œ `react` ä¸­æ’å€¼çš„å½¢å¼æ˜¯å•ä¸ªèŠ±æ‹¬å· `{}` çš„å½¢å¼ã€‚æœ€ç»ˆæµè§ˆå™¨æ˜¾ç¤ºçš„æ•ˆæœå¦‚ä¸‹ï¼š

![è·å–å˜é‡ã€æ’å€¼](https://img-blog.csdnimg.cn/c2d538a24e9b45ce927f3a51469e62bf.png#pic_center)

**ç¬¬äºŒç§ç±»å‹ï¼šè¡¨è¾¾å¼**

```js
import React from 'react';

class JSXBaseDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      imgUrl:
        'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
      flag: true,
    };
  }
  render() {
    // è¡¨è¾¾å¼
    const exprElem = <p>{this.state.flag ? 'yes' : 'no'}</p>;
    return exprElem;
  }
}

export default JSXBaseDemo;
```

`react` ä¸­ä¹Ÿæ”¯æŒç›´æ¥åœ¨æ’å€¼é‡Œé¢ä½¿ç”¨è¡¨è¾¾å¼ï¼Œå¦‚ä¸Šè¿°ä»£ç ä¸­çš„ `this.state.flag ? 'yes' : 'no'` ã€‚æœ€ç»ˆæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/cab2c444b91e46969b25f08423186c38.png#pic_center)

### ï¼ˆ2ï¼‰class å’Œ style

é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬è¦ç»™æŸä¸€ä¸ªæ ‡ç­¾è®¾ç½®ç±»åï¼Œé‚£ä¹ˆä¼šç»™è¯¥æ ‡ç­¾åŠ ä¸Šä¸€ä¸ª `class` ã€‚è€Œåœ¨ `react` ä¸­ï¼Œå¦‚æœæƒ³è¦ç»™ä¸€ä¸ªæ ‡ç­¾åŠ ä¸Šä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆéœ€è¦ç»™å…¶åŠ ä¸Š `className` ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';
import './style.css';
import List from '../List';

class JSXBaseDemo extends React.Component {
  render() {
    // class
    const classElem = <p className='title'>è®¾ç½® css class</p>;

    // style
    const styleData = { fontSize: '30px', color: 'blue' };
    const styleElem1 = <p style={styleData}>è®¾ç½® style</p>;
    // å†…è”å†™æ³•ï¼Œæ³¨æ„ {{ å’Œ }}
    const styleElem2 = (
      <p style={{ fontSize: '30px', color: 'blue' }}>è®¾ç½® style</p>
    );

    // è¿”å›ç»“æœ
    return [classElem, styleElem1, styleElem2];
  }
}

export default JSXBaseDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![classå’Œstyle](https://img-blog.csdnimg.cn/05a9ced4154b4358b5ab8c66726242b9.png#pic_center)

åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ `react` ä¸­ï¼Œå¦‚æœè¦åœ¨æ ‡ç­¾é‡Œé¢å†™**å†…è”æ ·å¼**ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨**åŒèŠ±æ‹¬å·** `{{}}` æ¥è¡¨ç¤ºã€‚

### ï¼ˆ3ï¼‰å­å…ƒç´ å’Œç»„ä»¶

**ç¬¬ä¸€ç§ç±»å‹ï¼šå­å…ƒç´ **

å¯¹äºå­å…ƒç´ æ¥è¯´ï¼Œå®ƒå¯ä»¥åœ¨**æ ‡ç­¾**é‡Œé¢è¿›è¡Œä½¿ç”¨ã€‚**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

class JSXBaseDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      imgUrl:
        'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
      flag: true,
    };
  }
  render() {
    // å­å…ƒç´ 
    const imgElem = (
      <div>
        <p>æˆ‘çš„å¤´åƒ</p>
        <img src='xxxx.png' />
        <img src={this.state.imgUrl} />
      </div>
    );
    return imgElem;
  }
}

export default JSXBaseDemo;
```

æœ€ç»ˆï¼Œ**æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![å­å…ƒç´ ](https://img-blog.csdnimg.cn/2680ae37d77f44a79495ad3ef878d470.png#pic_center)

**ç¬¬äºŒç§ç±»å‹ï¼šåŠ è½½ç»„ä»¶**

å¦‚æœè¦åœ¨ `React` ä¸­åŠ è½½ä¸€ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå¤„ç†ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';
import './style.css';
import List from '../List';

class JSXBaseDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      imgUrl:
        'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
      flag: true,
    };
  }
  render() {
    // åŠ è½½ç»„ä»¶
    const componentElem = (
      <div>
        <p>JSX ä¸­åŠ è½½ä¸€ä¸ªç»„ä»¶</p>
        <hr />
        <List />
      </div>
    );
    return componentElem;
  }
}

export default JSXBaseDemo;
```

**List.js ç»„ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';

class List extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'React',
      list: ['a', 'b', 'c'],
    };
  }
  render() {
    return (
      <div>
        <p onClick={this.changeName.bind(this)}>{this.state.name}</p>
        <ul>
          {this.state.list.map((item, index) => {
            return <li key={index}>{item}</li>;
          })}
        </ul>
        <button onClick={this.addItem.bind(this)}>æ·»åŠ ä¸€é¡¹</button>
      </div>
    );
  }
  changeName() {
    this.setState({
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
    });
  }
  addItem() {
    this.setState({
      list: this.state.list.concat(`${Date.now()}`), // ä½¿ç”¨ä¸å¯å˜å€¼
    });
  }
}

export default List;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![å­å…ƒç´ å’Œç»„ä»¶](https://img-blog.csdnimg.cn/fe564ba03ff141d6a09cdf90e27c5eee.gif#pic_center)

ç”±æ­¤ï¼Œæˆ‘ä»¬å°±å°†ä¸€ä¸ª**ç»„ä»¶**æ³¨å…¥åˆ°ç»„ä»¶å½“ä¸­ã€‚

### ï¼ˆ4ï¼‰åŸç”Ÿ html

ç»§ç»­ï¼Œæˆ‘ä»¬æ¥çœ‹åŸç”Ÿ `html` åœ¨ `react` ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚**å…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š**

```js
import React from 'react';

class JSXBaseDemo extends React.Component {
  render() {
    // åŸç”Ÿ html
    const rawHtml = '<span>å¯Œæ–‡æœ¬å†…å®¹<i>æ–œä½“</i><b>åŠ ç²—</b></span>';
    const rawHtmlData = {
      // æŠŠ rawHtml èµ‹å€¼ç»™ __html
      __html: rawHtml, // æ³¨æ„ï¼Œå¿…é¡»æ˜¯è¿™ç§æ ¼å¼
    };
    const rawHtmlElem = (
      <div>
        <p dangerouslySetInnerHTML={rawHtmlData}></p>
        <p>{rawHtml}</p>
      </div>
    );
    return rawHtmlElem;
  }
}

export default JSXBaseDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![åŸç”Ÿhtml](https://img-blog.csdnimg.cn/f03b7cb9b47940ceab7cfbf25a0efb20.png#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœè¦åœ¨ `react` ä¸­ä½¿ç”¨åŸç”Ÿ `html` ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ `const rawHtmlData = { __html: rawHtml }` è¿™ç§å½¢å¼ï¼Œæ‰èƒ½å°†åŸç”Ÿ `html` ä»£ç ç»™è§£æå‡ºæ¥ã€‚å¦åˆ™çš„è¯ï¼Œ `react` æ˜¯æ— æ³•æ­£å¸¸å°†åŸç”Ÿ `html` è§£æå‡ºæ¥çš„ã€‚

## 2ã€æ¡ä»¶åˆ¤æ–­

### ï¼ˆ1ï¼‰if else

**å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š**

```js
import React from 'react';
import './style.css';

class ConditionDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      theme: 'black',
    };
  }
  render() {
    const blackBtn = <button className='btn-black'>black btn</button>;
    const whiteBtn = <button className='btn-white'>white btn</button>;

    // if else
    if (this.state.theme === 'black') {
      return blackBtn;
    } else {
      return whiteBtn;
    }
  }
}

export default ConditionDemo;
```

**style.css çš„ä»£ç å¦‚ä¸‹ï¼š**

```js
.title {
    font-size: 30px;
    color: red;
}

.btn-white {
    color: #333;
}
.btn-black {
    background-color: #666;
    color: #fff;;
}

```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![if else](https://img-blog.csdnimg.cn/791baf06fd334bf7997db865cf629879.png#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ `theme` è®¾ç½®ä¸º `black` æ—¶ï¼Œæœ€ç»ˆæ˜¾ç¤ºçš„æ•ˆæœå°±æ˜¯**é»‘è‰²**ã€‚å¦‚æœæˆ‘ä»¬æŠŠ `theme` è®¾ç½®ä¸ºå…¶ä»–çŠ¶æ€ï¼Œé‚£ä¹ˆæœ€ç»ˆæ˜¾ç¤ºçš„æ•ˆæœå°±æ˜¯**ç™½è‰²**ã€‚

### ï¼ˆ2ï¼‰ä¸‰å…ƒè¡¨è¾¾å¼

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';
import './style.css';

class ConditionDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      theme: 'black',
    };
  }
  render() {
    const blackBtn = <button className='btn-black'>black btn</button>;
    const whiteBtn = <button className='btn-white'>white btn</button>;

    // ä¸‰å…ƒè¿ç®—ç¬¦
    return <div>{this.state.theme === 'black' ? blackBtn : whiteBtn}</div>;
  }
}

export default ConditionDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![ä¸‰å…ƒè¡¨è¾¾å¼](https://img-blog.csdnimg.cn/17721f46345d49d5b9d44967280ab191.png#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼ `this.state.theme === 'black' ? blackBtn : whiteBtn` çš„æ–¹å¼æ¥å¯¹ä¸€äº›æ¡ä»¶è¿›è¡Œåˆ¤æ–­ã€‚

### ï¼ˆ3ï¼‰é€»è¾‘è¿ç®—ç¬¦ && ||

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';
import './style.css';

class ConditionDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      theme: 'black',
    };
  }
  render() {
    const blackBtn = <button className='btn-black'>black btn</button>;
    const whiteBtn = <button className='btn-white'>white btn</button>;

    // &&
    return <div>{this.state.theme === 'black' && blackBtn}</div>;
  }
}

export default ConditionDemo;
```

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºç»“æœä¹Ÿæ˜¯å’Œä¸Šè¿°ä¸€æ ·çš„ã€‚**å…·ä½“å¦‚ä¸‹ï¼š**

![é€»è¾‘è¿ç®—ç¬¦](https://img-blog.csdnimg.cn/fd8430b48547497e9f5052810cbcc514.png#pic_center)

`this.state.theme === 'black' && blackBtn` è¿™å¥è¯çš„æ„æ€ä¸ºï¼Œå¦‚æœ `this.state.theme` çš„å€¼ä¸º `black` æ—¶ï¼Œé‚£ä¹ˆè¿”å› `backBtn` çš„ç»“æœã€‚

## 3ã€æ¸²æŸ“åˆ—è¡¨

### ï¼ˆ1ï¼‰map å’Œ key

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class ListDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      list: [
        {
          id: 'id-1',
          title: 'æ ‡é¢˜1',
        },
        {
          id: 'id-2',
          title: 'æ ‡é¢˜2',
        },
        {
          id: 'id-3',
          title: 'æ ‡é¢˜3',
        },
      ],
    };
  }
  render() {
    return (
      <ul>
        {
          /* ç±»ä¼¼äºvueä¸­çš„v-for */
          this.state.list.map((item, index) => {
            // è¿™é‡Œçš„ key å’Œ Vue çš„ key ç±»ä¼¼ï¼Œå¿…å¡«ï¼Œä¸èƒ½æ˜¯ index æˆ– random
            return (
              <li key={item.id}>
                index {index}; id {item.id}; title {item.title}
              </li>
            );
          })
        }
      </ul>
    );
  }
}

export default ListDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![æ¸²æŸ“åˆ—è¡¨](https://img-blog.csdnimg.cn/5836efc973064656bf22dbe3ed6e7e6c.png#pic_center)

åœ¨ `react` ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ `list.map` æ¥æ¸²æŸ“åˆ—è¡¨ã€‚å…¶ä¸­ï¼Œ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ `list.map()` æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ç°åœ¨æˆ‘ä»¬å‡è®¾è¿™ä¸ªå‡½æ•°é‡Œé¢è¦éµå¾ªä¸€å¥—è§„åˆ™ `list.map( item => item.id )` ã€‚

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è§† `.map` ä¸ºä¸€ä¸ªæ•°ç»„çš„**é‡ç»„**ï¼Œé‚£ä¹ˆé‡ç»„çš„è§„åˆ™å°±æ˜¯ `item => item.id` ã€‚åŒæ—¶ï¼Œ `list.map` è¿”å›çš„æ˜¯ä¸€ä¸ª**æ•°ç»„**ã€‚

## 4ã€React çš„äº‹ä»¶

### ï¼ˆ1ï¼‰bind this

å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

```js
import React from 'react';

class EventDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'zhangsan',
    };

    // ä¿®æ”¹æ–¹æ³•çš„ this æŒ‡å‘
    // ä½¿ç”¨è¿™ä¸ªå†™æ³•ï¼Œç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œåªæ‰§è¡Œä¸€æ¬¡bind
    this.clickHandler1 = this.clickHandler1.bind(this);
  }
  render() {
    // this - ä½¿ç”¨ bind
    return <p onClick={this.clickHandler1}>{this.state.name}</p>;
  }
  clickHandler1() {
    // console.log('this....', this) // this é»˜è®¤æ˜¯ undefined
    this.setState({
      name: 'lisi',
    });
  }
}

export default EventDemo;
```

**æœ€ç»ˆæµè§ˆå™¨æ˜¾ç¤ºçš„æ•ˆæœä¸ºï¼š**

![bind this(1](https://img-blog.csdnimg.cn/a6effbcdf9c74d9b92189e64f25492d3.png#)

åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ `this.clickHandler1 = this.clickHandler1.bind(this)` æ¥å¯¹ `clickHandler1` è¿›è¡Œç»‘å®šã€‚

---

è¿˜æœ‰å¦å¤–ä¸€ç§å…³äº `this` çš„ç»‘å®šæ–¹æ³•ã€‚**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class EventDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'zhangsan',
    };
  }
  render() {
    // this - ä½¿ç”¨é™æ€æ–¹æ³•
    return <p onClick={this.clickHandler2}>clickHandler2 {this.state.name}</p>;
  }
  // é™æ€æ–¹æ³•ï¼Œthis æŒ‡å‘å½“å‰å®ä¾‹
  clickHandler2 = () => {
    this.setState({
      name: 'lisi',
    });
  };
}

export default EventDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![bind this](https://img-blog.csdnimg.cn/2342f2993983478084092daf5c9182ba.png#)

å¯¹äºä¸Šé¢çš„è¿™ç§æ–¹å¼æ¥è¯´ï¼Œ `clickHandler2` æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ­¤æ—¶å®ƒçš„ `this` ä¼šæŒ‡å‘å½“å‰çš„å®ä¾‹ã€‚

### ï¼ˆ2ï¼‰å…³äº event å‚æ•°

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class EventDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'zhangsan',
    };
  }
  render() {
    // event
    return (
      <a href='https://imooc.com/' onClick={this.clickHandler3}>
        click me
      </a>
    );
  }
  // è·å– event ï¼ˆé‡ç‚¹ï¼‰
  clickHandler3 = (event) => {
    event.preventDefault(); // é˜»æ­¢é»˜è®¤è¡Œä¸º
    event.stopPropagation(); // é˜»æ­¢å†’æ³¡
    console.log('target', event.target); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
    console.log('current target', event.currentTarget); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå‡è±¡ï¼ï¼ï¼

    // æ³¨æ„ï¼Œevent å…¶å®æ˜¯ React å°è£…çš„ã€‚å¯ä»¥æŠŠ __proto__.constructor çœ‹æˆæ˜¯ SyntheticEvent ç»„åˆäº‹ä»¶
    console.log('event', event); // ä¸æ˜¯åŸç”Ÿçš„ Event ï¼ŒåŸç”Ÿçš„æ˜¯ MouseEvent
    console.log('event.__proto__.constructor', event.__proto__.constructor);

    // åŸç”Ÿ event å¦‚ä¸‹ã€‚å…¶ __proto__.constructor æ˜¯ MouseEvent
    console.log('nativeEvent', event.nativeEvent);
    console.log('nativeEvent target', event.nativeEvent.target); // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
    console.log('nativeEvent current target', event.nativeEvent.currentTarget); // æŒ‡å‘ document ï¼ï¼ï¼
  };
}

export default EventDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![event](https://img-blog.csdnimg.cn/50535e7617da4e9996e9ad8221acdf32.gif#pic_center)

ä¾æ®ä»¥ä¸Šå†…å®¹ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š

- `event` æ˜¯åˆæˆäº‹ä»¶ `SyntheticEvent` ï¼Œå®ƒèƒ½å¤Ÿæ¨¡æ‹Ÿå‡ºæ¥ `DOM` äº‹ä»¶æ‰€æœ‰çš„èƒ½åŠ›ï¼›
- `event` æ˜¯`React` å°è£…å‡ºæ¥çš„ï¼Œè€Œ `event.nativeEvent` æ˜¯åŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼›
- æ‰€æœ‰çš„äº‹ä»¶ï¼Œéƒ½ä¼šè¢«æŒ‚è½½åˆ° `document` ä¸Šï¼›
- `React` ä¸­çš„äº‹ä»¶ï¼Œå’Œ `DOM` äº‹ä»¶ä¸ä¸€æ ·ï¼Œå’Œ `Vue` äº‹ä»¶ä¹Ÿä¸ä¸€æ ·ã€‚

### ï¼ˆ3ï¼‰ä¼ é€’è‡ªå®šä¹‰å‚æ•°

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class EventDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'zhangsan',
      list: [
        {
          id: 'id-1',
          title: 'æ ‡é¢˜1',
        },
        {
          id: 'id-2',
          title: 'æ ‡é¢˜2',
        },
        {
          id: 'id-3',
          title: 'æ ‡é¢˜3',
        },
      ],
    };
  }
  render() {
    // ä¼ é€’å‚æ•° - ç”¨ bind(this, a, b)
    return (
      <ul>
        {this.state.list.map((item, index) => {
          return (
            <li
              key={item.id}
              onClick={this.clickHandler4.bind(this, item.id, item.title)}
            >
              index {index}; title {item.title}
            </li>
          );
        })}
      </ul>
    );
  }
  // ä¼ é€’å‚æ•°
  clickHandler4(id, title, event) {
    console.log(id, title);
    console.log('event', event); // æœ€åè¿½åŠ ä¸€ä¸ªå‚æ•°ï¼Œå³å¯æ¥æ”¶ event
  }
}

export default EventDemo;
```

æ­¤æ—¶ï¼Œ**æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![ä¼ é€’å‚æ•°](https://img-blog.csdnimg.cn/e61951374ede46f881217184c8cb0ea4.png#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ `this.clickHandler4.bind(this, item.id, item.title)` è¿™ç§å½¢å¼æ¥å¯¹ `react` ä¸­çš„äº‹ä»¶è¿›è¡Œå‚æ•°ä¼ é€’ã€‚

### ï¼ˆ4ï¼‰æ³¨æ„ç‚¹

- `React 16` å°†äº‹ä»¶ç»‘å®šåˆ° `document` ä¸Šï¼›
- `React 17` å°†äº‹ä»¶ç»‘å®šåˆ° `root` ç»„ä»¶ä¸Šï¼›
- è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼šæœ‰åˆ©äºå¤šä¸ª `React` ç‰ˆæœ¬å¹¶å­˜ï¼Œä¾‹å¦‚**å¾®å‰ç«¯**ã€‚

**å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š**

![react16å’Œ17ä¸­äº‹ä»¶çš„ä¸åŒ](https://img-blog.csdnimg.cn/7a7454902b2c412cac412300d8892ced.png#pic_center)

## 5ã€è¡¨å•

### ï¼ˆ1ï¼‰å—æ§ç»„ä»¶

å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

```js
import React from 'react';

class FormDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      info: 'ä¸ªäººä¿¡æ¯',
      city: 'GuangDong',
      flag: true,
      gender: 'female',
    };
  }
  render() {
    // å—æ§ç»„ä»¶
    return (
      <div>
        <p>{this.state.name}</p>
        <label htmlFor='inputName'>å§“åï¼š</label> {/* ç”¨ htmlFor ä»£æ›¿ for */}
        <input
          id='inputName'
          value={this.state.name}
          onChange={this.onInputChange}
        />
      </div>
    );
  }
  onInputChange = (e) => {
    this.setState({
      name: e.target.value,
    });
  };
}

export default FormDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![å—æ§ç»„ä»¶](https://img-blog.csdnimg.cn/ce9074944ceb41dc98c90b877a09145e.gif#pic_center)

åœ¨ `react` ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ `onChange` äº‹ä»¶æ¥æ‰‹åŠ¨ä¿®æ”¹ `state` é‡Œé¢çš„å€¼ã€‚

### ï¼ˆ2ï¼‰input textarea select ç”¨ value

ä¸Šé¢æˆ‘ä»¬å·²ç»è®²è§£äº† `input` ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ `textarea` å’Œ `select` ã€‚

å…ˆæ¥çœ‹ `textarea` ç›¸å…³çš„ä»£ç ï¼š

```js
import React from 'react';

class FormDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      info: 'ä¸ªäººä¿¡æ¯',
      city: 'GuangDong',
      flag: true,
      gender: 'female',
    };
  }
  render() {
    // textarea - ä½¿ç”¨ value
    return (
      <div>
        <textarea value={this.state.info} onChange={this.onTextareaChange} />
        <p>{this.state.info}</p>
      </div>
    );
  }
  onTextareaChange = (e) => {
    this.setState({
      info: e.target.value,
    });
  };
}

export default FormDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ‰“å°æ•ˆæœæ˜¯ï¼š**

![textarea](https://img-blog.csdnimg.cn/167aca33cccb4e87a341514d5cc53fd8.gif#)

åŒæ ·åœ°ï¼Œ `textarea` ä¹Ÿæ˜¯ç”¨ `value` å’Œ `onChange` æ¥å¯¹**å€¼**è¿›è¡Œç»‘å®šã€‚

---

ç»§ç»­æ¥çœ‹ `select` ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';

class FormDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      info: 'ä¸ªäººä¿¡æ¯',
      city: 'GuangDong',
      flag: true,
      gender: 'female',
    };
  }
  render() {
    // textarea - ä½¿ç”¨ value
    return (
      <div>
        <textarea value={this.state.info} onChange={this.onTextareaChange} />
        <p>{this.state.info}</p>
      </div>
    );
  }
  onSelectChange = (e) => {
    this.setState({
      city: e.target.value,
    });
  };
}

export default FormDemo;
```

æ­¤æ—¶ï¼Œ**æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![select](https://img-blog.csdnimg.cn/af6a0cf9f0354c478f1fd5be00a6dc12.gif#)

ä¸ `input` å’Œ `textarea` ä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡æ“ä½œ `value` å’Œ `onChange` ï¼Œæ¥æ”¹å˜æœ€ç»ˆçš„å€¼ã€‚

### ï¼ˆ3ï¼‰checkbox radio ç”¨ checked

å…ˆæ¥çœ‹ `ckeckbox` ã€‚**ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';

class FormDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      info: 'ä¸ªäººä¿¡æ¯',
      city: 'GuangDong',
      flag: true,
      gender: 'female',
    };
  }
  render() {
    // checkbox
    return (
      <div>
        <input
          type='checkbox'
          checked={this.state.flag}
          onChange={this.onCheckboxChange}
        />
        <p>{this.state.flag.toString()}</p>
      </div>
    );
  }
  onCheckboxChange = () => {
    this.setState({
      flag: !this.state.flag,
    });
  };
}

export default FormDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![checkbox](https://img-blog.csdnimg.cn/1e01bedc3b4042ac9cf587f3506d2336.gif#)

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ `checkbox` é€šè¿‡æ“ä½œ `checked` å’Œ `onChange` ï¼Œæ¥æ”¹å˜ `state` çš„å€¼ã€‚

---

`radio` ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œ**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

class FormDemo extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      info: 'ä¸ªäººä¿¡æ¯',
      city: 'GuangDong',
      flag: true,
      gender: 'female',
    };
  }
  render() {
    // radio
    return (
      <div>
        male{' '}
        <input
          type='radio'
          name='gender'
          value='male'
          checked={this.state.gender === 'male'}
          onChange={this.onRadioChange}
        />
        female <input
          type='radio'
          name='gender'
          value='female'
          checked={this.state.gender === 'female'}
          onChange={this.onRadioChange}
        />
        <p>{this.state.gender}</p>
      </div>
    );
  }
  onRadioChange = (e) => {
    this.setState({
      gender: e.target.value,
    });
  };
}

export default FormDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœæ˜¯ï¼š**

![radio](https://img-blog.csdnimg.cn/8d5488b0bbe442e197ac40acda1091ce.gif#)

## 6ã€ç»„ä»¶ä½¿ç”¨

å¯¹äºçˆ¶å­ç»„ä»¶çš„ä½¿ç”¨æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼š`props` ä¼ é€’æ•°æ®ã€`props` ä¼ é€’å‡½æ•°å’Œ `props` ç±»å‹æ£€æŸ¥ã€‚

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';
import PropTypes from 'prop-types';

class Input extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      title: '',
    };
  }
  render() {
    return (
      <div>
        <input value={this.state.title} onChange={this.onTitleChange} />
        <button onClick={this.onSubmit}>æäº¤</button>
      </div>
    );
  }
  onTitleChange = (e) => {
    this.setState({
      title: e.target.value,
    });
  };
  onSubmit = () => {
    const { submitTitle } = this.props;
    submitTitle(this.state.title);

    this.setState({
      title: '',
    });
  };
}
// props ç±»å‹æ£€æŸ¥
Input.propTypes = {
  submitTitle: PropTypes.func.isRequired,
};

class List extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    const { list } = this.props;

    return (
      <ul>
        {list.map((item, index) => {
          return (
            <li key={item.id}>
              <span>{item.title}</span>
            </li>
          );
        })}
      </ul>
    );
  }
}
// props ç±»å‹æ£€æŸ¥
// é€šè¿‡propTypeså¯ä»¥æ¸…æ¥šåœ°çŸ¥é“listéœ€è¦ä¸€ä¸ªä»€ä¹ˆç±»å‹çš„æ•°æ®
List.propTypes = {
  list: PropTypes.arrayOf(PropTypes.object).isRequired,
};

class Footer extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    return (
      <p>
        {this.props.text}
        {this.props.length}
      </p>
    );
  }
  componentDidUpdate() {
    console.log('footer did update');
  }
  shouldComponentUpdate(nextProps, nextState) {
    if (
      nextProps.text !== this.props.text ||
      nextProps.length !== this.props.length
    ) {
      return true; // å¯ä»¥æ¸²æŸ“
    }
    return false; // ä¸é‡å¤æ¸²æŸ“
  }

  // React é»˜è®¤ï¼šçˆ¶ç»„ä»¶æœ‰æ›´æ–°ï¼Œå­ç»„ä»¶åˆ™æ— æ¡ä»¶ä¹Ÿæ›´æ–°ï¼ï¼ï¼
  // æ€§èƒ½ä¼˜åŒ–å¯¹äº React æ›´åŠ é‡è¦ï¼
  // SCU ä¸€å®šè¦æ¯æ¬¡éƒ½ç”¨å—ï¼Ÿâ€”â€” éœ€è¦çš„æ—¶å€™æ‰ä¼˜åŒ–ï¼ˆSCUå³shouldComponentUpdateï¼‰
}

// çˆ¶ç»„ä»¶
class TodoListDemo extends React.Component {
  constructor(props) {
    super(props);
    // çŠ¶æ€ï¼ˆæ•°æ®ï¼‰æå‡
    // listçš„æ•°æ®éœ€è¦æ”¾åœ¨çˆ¶ç»„ä»¶
    this.state = {
      list: [
        {
          id: 'id-1',
          title: 'æ ‡é¢˜1',
        },
        {
          id: 'id-2',
          title: 'æ ‡é¢˜2',
        },
        {
          id: 'id-3',
          title: 'æ ‡é¢˜3',
        },
      ],
      footerInfo: 'åº•éƒ¨æ–‡å­—',
    };
  }
  render() {
    return (
      <div>
        <Input submitTitle={this.onSubmitTitle} />
        <List list={this.state.list} />
        <Footer text={this.state.footerInfo} length={this.state.list.length} />
      </div>
    );
  }
  onSubmitTitle = (title) => {
    this.setState({
      list: this.state.list.concat({
        id: `id-${Date.now()}`,
        title,
      }),
    });
  };
}

export default TodoListDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![ç»„ä»¶ä½¿ç”¨-props](https://img-blog.csdnimg.cn/4b4396f40246469193064dee43314bc7.gif#)

ä¾æ®ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬æ¥å¯¹ `props` çš„å„ä¸ªç±»å‹è¿›è¡Œä»‹ç»ã€‚

### ï¼ˆ1ï¼‰props ä¼ é€’æ•°æ®

æœ€åä¸€ä¸ª `TodoListDemo` æ˜¯çˆ¶ç»„ä»¶ï¼Œå…¶ä»–éƒ½æ˜¯å­ç»„ä»¶ã€‚åœ¨ `Input` ç»„ä»¶å’Œ `List` ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°† `props` å±æ€§çš„å†…å®¹ï¼Œä»¥ `this.props.xxx` çš„æ–¹å¼ï¼Œä¼ é€’ç»™**çˆ¶ç»„ä»¶**ã€‚

### ï¼ˆ2ï¼‰props ä¼ é€’å‡½æ•°

`React` åœ¨ä¼ é€’å‡½æ•°è¿™ä¸€éƒ¨åˆ†å’Œ `vue` æ˜¯ä¸ä¸€æ ·çš„ã€‚å¯¹äº `vue` æ¥è¯´ï¼Œå¦‚æœæœ‰ä¸€ä¸ªçˆ¶ç»„ä»¶è¦ä¼ é€’å‡½æ•°ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å¦‚æœæƒ³è¦è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨äº‹ä»¶ä¼ é€’å’Œ `$emit` çš„æ–¹å¼æ¥è§£å†³ã€‚

å¤§å®¶å®šä½åˆ° `Input` ç»„ä»¶ä¸­ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°† `submitTitle` ä»¥å‡½æ•°çš„å½¢å¼ï¼Œä¼ é€’ç»™çˆ¶ç»„ä»¶ä¸­çš„ `onSubmitTitle` ã€‚

### ï¼ˆ3ï¼‰props ç±»å‹æ£€æŸ¥

å¤§å®¶å®šä½åˆ°ä¸¤å¤„ `props` ç±»å‹æ£€æŸ¥çš„åœ°æ–¹ã€‚ä½¿ç”¨ `react` ä¸­çš„ `PropTypes` ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å½“å‰æ‰€ä½¿ç”¨çš„å±æ€§è¿›è¡Œä¸€ä¸ªç±»å‹æ£€æŸ¥ã€‚æ¯”å¦‚è¯´ï¼š `submitTitle: PropTypes.func.isRequired` è¡¨æ˜çš„æ˜¯ï¼Œ `submitTitle` æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå¿…å¡«é¡¹ã€‚

å°±è¿™æ ·ï¼Œé€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†**å±æ€§ä¼ é€’**ã€**å±æ€§éªŒè¯**ä»¥åŠ**çˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ä¹‹é—´æ€ä¹ˆé€šè¿‡ä¼ äº‹ä»¶çš„å½¢å¼æ¥è¿›è¡Œé€šä¿¡**ã€‚

## 7ã€setState

### ï¼ˆ1ï¼‰ä¸å¯å˜å€¼

æ‰€è°“ä¸å¯å˜å€¼ï¼Œå³æ‰€è®¾ç½®çš„å€¼æ°¸ä¸æ”¹å˜ã€‚é‚£è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å»åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ï¼Œæ¥è®¾ç½® `state` çš„å€¼ã€‚

æ¥çœ‹å‡ ä¸ªè¦ç‚¹ï¼š

ç¬¬ä¸€ç‚¹ï¼š**state** è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ã€‚**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

// å‡½æ•°ç»„ä»¶ï¼Œé»˜è®¤æ²¡æœ‰ state
class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    // ç¬¬ä¸€ï¼Œstate è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰
    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
      </div>
    );
  }
}

export default StateDemo;
```

ç¬¬äºŒç‚¹ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ **state** ï¼Œè¦ä½¿ç”¨ä¸å¯å˜å€¼ã€‚**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

// å‡½æ•°ç»„ä»¶ï¼Œé»˜è®¤æ²¡æœ‰ state
class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    // ç¬¬ä¸€ï¼Œstate è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰
    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  increase = () => {
    // ç¬¬äºŒï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ stateï¼Œä½¿ç”¨ä¸å¯å˜å€¼
    // this.state.count++ // é”™è¯¯å†™æ³•ï¼Œä¼šç›´æ¥ä¿®æ”¹åŸæ¥çš„å€¼
    this.setState({
      count: this.state.count + 1, // ShouldComponentUpdate â†’ SCU
    });
  };
}

export default StateDemo;
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ `this.state({})` è¿™ç§å½¢å¼ï¼Œæ¥ä¿®æ”¹ `state` çš„å€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¾ˆå¤šå°ä¼™ä¼´ä¼šç›´æ¥ä½¿ç”¨ `this.state.count++` æ¥ä¿®æ”¹ `state` çš„å€¼ï¼Œè¿™åœ¨ `react` ä¸­æ˜¯éå¸¸ä¸å…è®¸çš„ã€‚å› æ­¤ï¼Œè¦æ³¨æ„è¿™ä¸ªè¦ç‚¹ã€‚

ç¬¬ä¸‰ç‚¹ï¼Œåœ¨ `react` ä¸­æ“ä½œ**æ•°ç»„**çš„å€¼ã€‚**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
// ä¸å¯å˜å€¼ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼Œçº¯å‡½æ•°ï¼‰ - æ•°ç»„
const list5Copy = this.state.list5.slice();
list5Copy.splice(2, 0, 'a'); // ä¸­é—´æ’å…¥/åˆ é™¤
this.setState({
  list1: this.state.list1.concat(100), // è¿½åŠ 
  list2: [...this.state.list2, 100], // è¿½åŠ 
  list3: this.state.list3.slice(0, 3), // æˆªå–
  list4: this.state.list4.filter((item) => item > 100), // ç­›é€‰
  list5: list5Copy, // å…¶ä»–æ“ä½œ
});
// æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.list è¿›è¡Œ push pop splice ç­‰ï¼Œè¿™æ ·è¿åä¸å¯å˜å€¼
```

ç¬¬å››ç‚¹ï¼Œåœ¨ `react` ä¸­æ“ä½œ**å¯¹è±¡**çš„å€¼ã€‚**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
// ä¸å¯å˜å€¼ - å¯¹è±¡
this.setState({
  obj1: Object.assign({}, this.state.obj1, { a: 100 }),
  obj2: { ...this.state.obj2, a: 100 },
});
// æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.obj è¿›è¡Œå±æ€§è®¾ç½®ï¼Œå³ this.state.obj.xxx è¿™æ ·çš„å½¢å¼ï¼Œè¿™ç§å½¢å¼ä¼šè¿åä¸å¯å˜å€¼
```

### ï¼ˆ2ï¼‰å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°

`react` ä¸­çš„ `state` ï¼Œæœ‰å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°ã€‚**æ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  increase = () => {
    // setState å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯åŒæ­¥æ›´æ–°ï¼‰
    this.setState(
      {
        count: this.state.count + 1,
      },
      () => {
        // è”æƒ³ Vue $nextTick - DOM
        console.log('count by callback', this.state.count); // å›è°ƒå‡½æ•°ä¸­å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„ state
      }
    );
    console.log('count', this.state.count); // å¼‚æ­¥çš„ï¼Œæ‹¿ä¸åˆ°æœ€æ–°å€¼
  };
}

export default StateDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![å¼‚æ­¥æ›´æ–°â‘ ](https://img-blog.csdnimg.cn/f5d75ad5f1c24c6587b7d953d111e123.gif#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œ`this.state` å‰åŠéƒ¨åˆ†å¹¶ä¸èƒ½åŒä¸€æ—¶é—´å¾—åˆ°æ›´æ–°ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼‚æ­¥æ“ä½œã€‚è€Œåé¢çš„ç®­å¤´å‡½æ•°ä¸­çš„å†…å®¹å¯ä»¥å¾—åˆ°**åŒæ­¥æ›´æ–°**ï¼Œæ‰€ä»¥åé¢å‡½æ•°çš„éƒ¨åˆ†æ˜¯**åŒæ­¥æ“ä½œ**ã€‚

---

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ `setTimeout` åœ¨ `setState` ä¸­æ˜¯**åŒæ­¥çš„**ã€‚**æ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  increase = () => {
    // setTimeout ä¸­ setState æ˜¯åŒæ­¥çš„
    setTimeout(() => {
      this.setState({
        count: this.state.count + 1,
      });
      console.log('count in setTimeout', this.state.count);
    }, 0);
  };
}

export default StateDemo;
```

æ­¤æ—¶ï¼Œ**æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![å¼‚æ­¥æ›´æ–°â‘¡](https://img-blog.csdnimg.cn/120804caad314254962f8d3d4458704c.gif#pic_center)

---

è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œå¦‚æœæ˜¯è‡ªå·±å®šä¹‰çš„ `DOM` äº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨ `setState` ä¸­æ˜¯åŒæ­¥çš„ï¼Œç”¨åœ¨ `componentDidMount` ä¸­ã€‚

å¦‚æœæ˜¯é”€æ¯äº‹ä»¶ï¼Œé‚£ä¹ˆç”¨åœ¨ `componentWillMount` ç”Ÿå‘½å‘¨æœŸä¸­ã€‚**ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';

class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  bodyClickHandler = () => {
    this.setState({
      count: this.state.count + 1,
    });
    console.log('count in body event', this.state.count);
  };
  componentDidMount() {
    // è‡ªå·±å®šä¹‰çš„ DOM äº‹ä»¶ï¼ŒsetState æ˜¯åŒæ­¥çš„
    document.body.addEventListener('click', this.bodyClickHandler);
  }
  componentWillUnmount() {
    // åŠæ—¶é”€æ¯è‡ªå®šä¹‰ DOM äº‹ä»¶
    document.body.removeEventListener('click', this.bodyClickHandler);
    // clearTimeout
  }
}

export default StateDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![å¼‚æ­¥æ›´æ–°â‘¢](https://img-blog.csdnimg.cn/a9bc6dc997da49459476a288c0eae005.gif#pic_center)

### ï¼ˆ3ï¼‰å¯èƒ½ä¼šè¢«åˆå¹¶

`setState` åœ¨ä¼ å…¥å¯¹è±¡æ—¶ï¼Œ**æ›´æ–°å‰**ä¼šè¢«åˆå¹¶ã€‚**æ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  increase = () => {
    // ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶ï¼ˆç±»ä¼¼ Object.assign ï¼‰ã€‚æ‰§è¡Œç»“æœåªä¸€æ¬¡ +1
    this.setState({
      count: this.state.count + 1,
    });
    this.setState({
      count: this.state.count + 1,
    });
    this.setState({
      count: this.state.count + 1,
    });
  };
}

export default StateDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶](https://img-blog.csdnimg.cn/8b0101fd34af407aa0f42be1b37b35b4.gif#pic_center)

æœ‰å°ä¼™ä¼´å¯èƒ½ä¼šè§‰å¾—ï¼Œä¸€ä¸‹å­å¤šä¸ªä¸‰ä¸ª `setState` ï¼Œé‚£ç»“æœåº”è¯¥æ˜¯ `+3` æ‰æ˜¯ã€‚ä½†å…¶å®ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç»“æœä¼šæŠŠä¸‰ä¸ªåˆå¹¶ä¸ºä¸€ä¸ªï¼Œæœ€ç»ˆ**åªæ‰§è¡Œä¸€æ¬¡**ã€‚

---

è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µï¼Œå¦‚æœä¼ å…¥çš„æ˜¯**å‡½**æ•°ï¼Œé‚£ä¹ˆç»“æœä¸ä¼šè¢«åˆå¹¶ã€‚**æ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class StateDemo extends React.Component {
  constructor(props) {
    super(props);

    this.state = {
      count: 0,
    };
  }
  render() {
    return (
      <div>
        <p>{this.state.count}</p>
        <button onClick={this.increase}>ç´¯åŠ </button>
      </div>
    );
  }
  increase = () => {
    // ä¼ å…¥å‡½æ•°ï¼Œä¸ä¼šè¢«åˆå¹¶ã€‚æ‰§è¡Œç»“æœæ˜¯ +3
    this.setState((prevState, props) => {
      return {
        count: prevState.count + 1,
      };
    });
    this.setState((prevState, props) => {
      return {
        count: prevState.count + 1,
      };
    });
    this.setState((prevState, props) => {
      return {
        count: prevState.count + 1,
      };
    });
  };
}

export default StateDemo;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![ä¼ å…¥å‡½æ•°ï¼Œç»“æœä¸ä¼šè¢«åˆå¹¶](https://img-blog.csdnimg.cn/253f42fb656a47c0a7a42519f1482e58.gif#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯**å‡½æ•°**ï¼Œé‚£ä¹ˆç»“æœä¸€ä¸‹å­å°±**æ‰§è¡Œä¸‰æ¬¡**äº†ã€‚

## 8ã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ

`react` çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œæœ‰**å•ç»„ä»¶å£°æ˜å‘¨æœŸ**å’Œ**çˆ¶å­ç»„ä»¶å£°æ˜å‘¨æœŸ**ã€‚å…¶ä¸­ï¼Œ**çˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ**ä¸ `Vue` ç±»ä¼¼ã€‚

è¿™é‡Œé™„ä¸Šä¸€ä¸ªç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ç½‘ç«™ï¼šhttps://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/

**ä¸‹é¢é™„ä¸Šç”Ÿå‘½å‘¨æœŸçš„å›¾ï¼š**

![reactçš„ç”Ÿå‘½å‘¨æœŸ](https://img-blog.csdnimg.cn/3475e5e45db54146978e5ba33b96df66.png#pic_center)

# ğŸ“– äºŒã€React é«˜çº§ç‰¹æ€§

## 1ã€å‡½æ•°ç»„ä»¶

æˆ‘ä»¬å…ˆæ¥äº†è§£ `class` ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶åˆ†åˆ«æ˜¯ä»€ä¹ˆæ ·çš„ã€‚å…ˆçœ‹ `class` ç»„ä»¶ï¼Œ**ä»£ç å¦‚ä¸‹ï¼š**

```js
// class ç»„ä»¶
class List extends React.Component {
  constructor(props) {
    super(props);
  }
  redner() {
    const { list } = this.props;

    return (
      <ul>
        {list.map((item, index) => {
          return (
            <li key={item.id}>
              <span>{item.title}</span>
            </li>
          );
        })}
      </ul>
    );
  }
}
```

**å‡½æ•°ç»„ä»¶**çš„å½¢å¼å¦‚ä¸‹ï¼š

```js
// å‡½æ•°ç»„ä»¶
function List(props) {
  const { list } = this.props;

  return (
    <ul>
      {list.map((item, idnex) => {
        return (
          <li key={item.id}>
            <span>{item.title}</span>
          </li>
        );
      })}
    </ul>
  );
}
```

ç°åœ¨æˆ‘ä»¬æ¥æ¢³ç†ä»¥ä¸‹ï¼Œ `class` ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«ã€‚æ‰€è°“å‡½æ•°ç»„ä»¶ï¼Œ**å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š**

- åªæ˜¯ä¸€ä¸ª**çº¯å‡½æ•°**ï¼Œå®ƒè¾“å…¥çš„æ˜¯ `props` ï¼Œè¾“å‡ºçš„æ˜¯ `JSX` ï¼›
- å‡½æ•°ç»„ä»¶**æ²¡æœ‰å®ä¾‹**ï¼Œ**æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸ**ï¼Œä¹Ÿ**æ²¡æœ‰ state** ï¼›
- å‡½æ•°ç»„ä»¶**ä¸èƒ½æ‰©å±•å…¶ä»–æ–¹æ³•**ã€‚

ç›¸ååœ°ï¼Œ `class` ç»„ä»¶å°±æ‹¥æœ‰å‡½æ•°ç»„ä»¶ç›¸å¼‚çš„ç‰¹ç‚¹ã€‚

## 2ã€éå—æ§ç»„ä»¶

åœ¨ä¸Šè¿°è¡¨å•æ¨¡å—ï¼Œæˆ‘ä»¬è°ˆè®ºåˆ°äº†å—æ§ç»„ä»¶ï¼Œé‚£æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥è°ˆè®º**éå—æ§ç»„ä»¶**ã€‚

æ‰€è°“**éå—æ§ç»„ä»¶**ï¼Œå°±æ˜¯ `input` é‡Œé¢çš„å€¼ï¼Œä¸å—åˆ° `state` çš„æ§åˆ¶ã€‚ä¸‹é¢æˆ‘ä»¬å…ˆæ¥çœ‹å‡ ç§åœºæ™¯ã€‚

### ï¼ˆ1ï¼‰input

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      flag: true,
    };
    this.nameInputRef = React.createRef(); // åˆ›å»º ref
  }
  render() {
    // input defaultValue
    return (
      <div>
        {/* ä½¿ç”¨ defaultValue è€Œä¸æ˜¯ value ï¼Œä½¿ç”¨ ref */}
        <input defaultValue={this.state.name} ref={this.nameInputRef} />
        {/* state å¹¶ä¸ä¼šéšç€æ”¹å˜ */}
        <span>state.name: {this.state.name}</span>
        <br />
        <button onClick={this.alertName}>alert name</button>
      </div>
    );
  }
  alertName = () => {
    const elem = this.nameInputRef.current; // é€šè¿‡ ref è·å– DOM èŠ‚ç‚¹
    alert(elem.value); // ä¸æ˜¯ this.state.name
  };
}

export default App;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![inputValue](https://img-blog.csdnimg.cn/4061ca8e070b46c0ad5bf8185eb48e54.gif#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœ**æ˜¯éå—æ§ç»„ä»¶**ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨ `defaultValue` å»æ§åˆ¶ç»„ä»¶çš„å€¼ã€‚ä¸”æœ€ç»ˆ `input` æ¡†é‡Œé¢çš„å†…å®¹ä¸è®ºæˆ‘ä»¬æ€ä¹ˆæ”¹å˜ï¼Œéƒ½ä¸ä¼šå½±å“åˆ° `state` çš„å€¼ã€‚

### ï¼ˆ2ï¼‰checkbox

å¯¹äºå¤é€‰æ¡† `checkbox` æ¥è¯´ï¼Œ**å…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š**

```js
import React from 'react';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      flag: true,
    };
  }
  render() {
    // checkbox defaultChecked
    return (
      <div>
        <input type='checkbox' defaultChecked={this.state.flag} />
        <p>state.name: {this.state.flag === true ? 'true' : 'false'}</p>
      </div>
    );
  }
}

export default App;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![checkbox](https://img-blog.csdnimg.cn/eaaf263c779c4ed7a554945989ffbe8e.gif#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¤é€‰æ¡†å¦‚æœå½“éå—æ§ç»„ä»¶æ¥ä½¿ç”¨çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆä½¿ç”¨ `defaultCkecked` æ¥å¯¹å€¼è¿›è¡Œæ§åˆ¶ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œæœ€ç»ˆä¸ç®¡ `checked` çš„å€¼å¦‚ä½•æ”¹å˜ï¼Œ `state` çš„å€¼éƒ½ä¸å—å½±å“ã€‚

### ï¼ˆ3ï¼‰file

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
      flag: true,
    };
    this.fileInputRef = React.createRef();
  }
  render() {
    // file
    return (
      <div>
        <input type='file' ref={this.fileInputRef} />
        <button onClick={this.alertFile}>alert file</button>
      </div>
    );
  }
  alertFile = () => {
    const elem = this.fileInputRef.current; // é€šè¿‡ ref è·å– DOM èŠ‚ç‚¹
    alert(elem.files[0].name);
  };
}

export default App;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![file](https://img-blog.csdnimg.cn/1ba7144a7cfe48f5a42868731a84ffe2.gif#pic_center)

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é€šè¿‡ `ref` å»è·å– `DOM` èŠ‚ç‚¹ï¼Œæ¥ç€å»è·å–åˆ°æ–‡ä»¶çš„åå­—ã€‚åƒ `file` è¿™ç§ç±»å‹çš„å›ºå®šï¼Œå€¼å¹¶ä¸ä¼šä¸€ç›´å›ºå®šçš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸€ä¸ª**éå—æ§ç»„ä»¶**ã€‚

### ï¼ˆ4ï¼‰æ€»ç»“æ¢³ç†

`setState` åªèƒ½å¤„ç†ç±»ä¼¼äºå‰ç«¯çš„æ˜¾ç¤ºå’Œæ¸²æŸ“ç›¸å…³çš„ï¼Œåƒæ–‡ä»¶ä¸Šä¼ è¿™ç§äº¤äº’ç±»å‹çš„å°±å¤„ç†ä¸äº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ¢³ç†ä¸‹**éå—æ§ç»„ä»¶çš„å‡ å¤§ä½¿ç”¨åœºæ™¯**ã€‚**å…·ä½“å¦‚ä¸‹ï¼š**

- å¿…é¡»æ‰‹åŠ¨æ“ä½œ `DOM` å…ƒç´ ï¼Œ `setState` å¹¶æ— æ³•æ‰‹åŠ¨æ“ä½œ `DOM` å…ƒç´ ï¼›
- æ–‡ä»¶ä¸Šä¼ ç±»å‹ `<input type=file>` ï¼›
- æŸäº›å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œéœ€è¦ä¼ å…¥ `DOM` å…ƒç´ ã€‚

å—æ§ç»„ä»¶ vs éå—æ§ç»„ä»¶çš„**åŒºåˆ«å¦‚ä¸‹ï¼š**

- ä¼˜å…ˆä½¿ç”¨**å—æ§ç»„ä»¶**ï¼Œç¬¦åˆ `React` è®¾è®¡åŸåˆ™ï¼›
- å¿…é¡»æ“ä½œ `DOM` æ—¶ï¼Œå†ä½¿ç”¨**éå—æ§ç»„ä»¶**ã€‚

## 3ã€Protals

### ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆè¦ç”¨ Protals ï¼Ÿ

ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç»„ä»¶é»˜è®¤ä¼šæŒ‰ç…§**æ—¢å®šå±‚æ¬¡**åµŒå¥—æ¸²æŸ“ã€‚**ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š**

```html
<div id="root">
  <div>
    <div>
      <div class="model">Modalå†…å®¹</div>
    </div>
  </div>
</div>
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·ä¸æ–­åµŒå¥—ï¼Œä½†é‡Œé¢å´åªæœ‰ä¸€å±‚åŒºåŸŸçš„å†…å®¹æ˜¯æœ‰ç”¨çš„ã€‚ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œæ˜¯éå¸¸ä¸å¥½çš„ã€‚é‚£æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…æ˜¯ï¼Œ**å¦‚ä½•è®©ç»„ä»¶æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ä»¥å¤–**å‘¢ï¼Ÿ

è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ° `Protals` ã€‚

### ï¼ˆ2ï¼‰å¦‚ä½•ä½¿ç”¨

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';
import ReactDOM from 'react-dom';
import './style.css';

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {};
  }
  render() {
    // æ­£å¸¸æ¸²æŸ“
    // return <div className="modal">
    //     {this.props.children} {/* vue slot */}
    // </div>

    // ä½¿ç”¨ Portals æ¸²æŸ“åˆ° body ä¸Šã€‚
    // fixed å…ƒç´ è¦æ”¾åœ¨ body ä¸Šï¼Œæœ‰æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ã€‚
    return ReactDOM.createPortal(
      <div className='modal'>{this.props.children}</div>,
      document.body // DOM èŠ‚ç‚¹
    );
  }
}

export default App;
```

**style.css ä»£ç å¦‚ä¸‹ï¼š**

```js
.modal {
    position: fixed;
    width: 300px;
    height: 100px;
    top: 100px;
    left: 50%;
    margin-left: -150px;
    background-color: #000;
    /* opacity: .2; */
    color: #fff;
    text-align: center;
}
```

æ­¤æ—¶ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æµè§ˆå™¨èŠ‚ç‚¹çš„æ¸²æŸ“æ•ˆæœã€‚**å…·ä½“å¦‚ä¸‹ï¼š**

![Protals](https://img-blog.csdnimg.cn/dfd9a88d62b14d59ab4a02666741dea9.png#pic_center)

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨ `ReactDOM.createPortal()` ï¼Œæ¥åˆ›å»º `Portals` ã€‚æœ€ç»ˆ `modals` èŠ‚ç‚¹æˆåŠŸè„±ç¦»å¼€**çˆ¶ç»„ä»¶**ï¼Œå¹¶æ¸²æŸ“åˆ°ç»„ä»¶å¤–éƒ¨ã€‚

### ï¼ˆ3ï¼‰ä½¿ç”¨åœºæ™¯

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸€äº› `Protals` å¸¸è§çš„åœºæ™¯ã€‚

`protals` å¸¸ç”¨äºè§£å†³ä¸€äº› `css` å…¼å®¹æ€§é—®é¢˜ã€‚é€šå¸¸ä½¿ç”¨åœºæ™¯æœ‰ï¼š

- `overflow:hidden;` è§¦å‘ `bfc` ï¼›
- çˆ¶ç»„ä»¶ `z-index` å€¼å¤ªå°ï¼›
- `position:fixed` éœ€è¦æ”¾åœ¨ `body` ç¬¬ä¸€å±‚çº§ã€‚

## 4ã€context

### ï¼ˆ1ï¼‰ä½¿ç”¨åœºæ™¯

æœ‰æ—¶å€™æˆ‘ä»¬ç»å¸¸ä¼šæœ‰ä¸€äº›åœºæ™¯å‡ºç°åˆ‡æ¢çš„é¢‘ç‡å¾ˆé¢‘ç¹ï¼Œæ¯”å¦‚**è¯­è¨€åˆ‡æ¢**ã€æˆ–è€…æ˜¯**ä¸»é¢˜åˆ‡æ¢**ï¼Œé‚£å¦‚ä½•æŠŠå¯¹åº”çš„åˆ‡æ¢ä¿¡æ¯ç»™æœ‰æ•ˆåœ°ä¼ é€’ç»™æ¯ä¸ªç»„ä»¶å‘¢ï¼Ÿ

ä½¿ç”¨ `props` ï¼Œåˆæœ‰ç‚¹ç¹çï¼›ä½¿ç”¨ `redux` ï¼Œåˆå¤ªå°é¢˜å¤§åšäº†ã€‚

å› æ­¤ï¼Œè¿™ä¸ªéœ€è¦æˆ‘ä»¬å¯ä»¥ç”¨ `react` ä¸­çš„ `context` ã€‚

### ï¼ˆ2ï¼‰ä¸¾ä¾‹é˜è¿°

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import React from 'react';

// åˆ›å»º Context å¡«å…¥é»˜è®¤å€¼ï¼ˆä»»ä½•ä¸€ä¸ª js å˜é‡ï¼‰
const ThemeContext = React.createContext('light');

// åº•å±‚ç»„ä»¶ - å‡½æ•°æ˜¯ç»„ä»¶
function ThemeLink(props) {
  // const theme = this.context // ä¼šæŠ¥é”™ã€‚å‡½æ•°å¼ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œå³æ²¡æœ‰ this

  // å‡½æ•°å¼ç»„ä»¶å¯ä»¥ä½¿ç”¨ Consumer
  return (
    <ThemeContext.Consumer>
      {(value) => <p>link's theme is {value}</p>}
    </ThemeContext.Consumer>
  );
}

// åº•å±‚ç»„ä»¶ - class ç»„ä»¶
class ThemedButton extends React.Component {
  // æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚
  // static contextType = ThemeContext // ä¹Ÿå¯ä»¥ç”¨ ThemedButton.contextType = ThemeContext
  render() {
    const theme = this.context; // React ä¼šå¾€ä¸Šæ‰¾åˆ°æœ€è¿‘çš„ theme Providerï¼Œç„¶åä½¿ç”¨å®ƒçš„å€¼ã€‚
    return (
      <div>
        <p>button's theme is {theme}</p>
      </div>
    );
  }
}
ThemedButton.contextType = ThemeContext; // æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚

// ä¸­é—´çš„ç»„ä»¶å†ä¹Ÿä¸å¿…æŒ‡æ˜å¾€ä¸‹ä¼ é€’ theme äº†ã€‚
function Toolbar(props) {
  return (
    <div>
      <ThemedButton />
      <ThemeLink />
    </div>
  );
}

class App extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      theme: 'light',
    };
  }
  render() {
    return (
      <ThemeContext.Provider value={this.state.theme}>
        <Toolbar />
        <hr />
        <button onClick={this.changeTheme}>change theme</button>
      </ThemeContext.Provider>
    );
  }
  changeTheme = () => {
    this.setState({
      theme: this.state.theme === 'light' ? 'dark' : 'light',
    });
  };
}

export default App;
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š**

![Context](https://img-blog.csdnimg.cn/cb4ed720010e44f78ac88a2f0be8d547.gif#pic_center)

åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬åšåˆ°äº†ä¸»é¢˜çš„åˆ‡æ¢ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹ä¸Šè¿°çš„ä»£ç ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª `Context` ï¼Œä¹Ÿå°±æ˜¯ `ThemeContext` ï¼Œå¹¶ä¼ å…¥äº† `light` å€¼ã€‚

å…¶æ¬¡ï¼Œæ ¸å¿ƒåœ¨ `<Toolbar />` ç»„ä»¶ã€‚ `Toolbar` ç°æœ‰ç»„ä»¶ä¸º `ThemedButton` å’Œ `ThemeLink` ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬å…ˆæŒ‡å®š `ThemedButton` çš„ `contextType` å»è¯»å–å½“å‰çš„ `ThemeContext` ï¼Œé‚£ä¹ˆå°±å–åˆ°äº†é»˜è®¤å€¼ `light` ã€‚

æ¥ç€ï¼Œæ¥åˆ°äº† `ThemeLink` ç»„ä»¶ã€‚ `ThemeLink` æ˜¯ä¸€ä¸ª**å‡½æ•°å¼ç»„ä»¶**ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ `ThemeContext.Consumer` æ¥å¯¹å…¶è¿›è¡Œä¼ å€¼ã€‚

ä¸Šé¢ä¸¤ä¸ªç»„ä»¶çš„å€¼éƒ½å–åˆ°äº†ï¼Œä½†é‚£åªæ˜¯ `ThemeContext` çš„åˆå§‹å€¼ã€‚å–åˆ°å€¼äº†ä¹‹åå‘¢ï¼Œæˆ‘ä»¬è¿˜è¦ä¿®æ”¹å€¼ï¼Œ `React` ä¼šå¾€ä¸Šæ‰¾åˆ°æœ€è¿‘çš„ `ThemeContext.Provider` ï¼Œé€šè¿‡ `value={this.state.theme}` è¿™ç§æ–¹å¼ï¼Œå»ä¿®æ”¹å’Œä½¿ç”¨ `ThemeContext` æœ€ç»ˆä½¿ç”¨çš„å€¼ ã€‚

## 5ã€å¼‚æ­¥ç»„ä»¶ï¼ˆæ‡’åŠ è½½ï¼‰

åœ¨é¡¹ç›®å¼€å‘æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šä¸å¯é¿å…çš„å»åŠ è½½ä¸€äº›å¤§ç»„ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°**å¼‚æ­¥åŠ è½½**ã€‚åœ¨ `vue` ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ `import()` æ¥åŠ è½½å¼‚æ­¥ç»„ä»¶ï¼Œä½†åœ¨ `react` å°±ä¸è¿™ä¹ˆä½¿ç”¨äº†ã€‚

`React` é€šå¸¸ä½¿ç”¨ `React.lazy` å’Œ `React.Suspense` æ¥åŠ è½½å¤§ç»„ä»¶ã€‚

**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

const ContextDemo = React.lazy(() => import('./ContextDemo'));

class App extends React.Component {
  constructor(props) {
    super(props);
  }
  render() {
    return (
      <div>
        <p>å¼•å…¥ä¸€ä¸ªåŠ¨æ€ç»„ä»¶</p>
        <hr />
        <React.Suspense fallback={<div>Loading...</div>}>
          <ContextDemo />
        </React.Suspense>
      </div>
    );

    // 1. å¼ºåˆ¶åˆ·æ–°ï¼Œå¯çœ‹åˆ° loading ï¼ˆçœ‹ä¸åˆ°å°±é™åˆ¶ä¸€ä¸‹ chrome çš„ç½‘é€Ÿï¼ŒPerformanceçš„networkï¼‰
    // 2. çœ‹ network çš„ js åŠ è½½
  }
}

export default App;
```

é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ `import` å»å¯¼å…¥æˆ‘ä»¬è¦åŠ è½½çš„ç»„ä»¶ã€‚ä¹‹åä½¿ç”¨ `React.lazy` å»å°†è¿™ä¸ªç»„ä»¶ç»™è¿›è¡Œæ³¨å†Œï¼Œä¹Ÿå°±æ˜¯ `ContextDemo` ã€‚æœ€åä½¿ç”¨ `React.Suspense` æ¥åŠ è½½ `ContextDemo` ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†è¯¥å¼‚æ­¥ç»„ä»¶çš„åŠ è½½ã€‚

## 6ã€æ€§èƒ½ä¼˜åŒ–

### ï¼ˆ1ï¼‰shouldComponentUpdateï¼ˆç®€ç§° SCUï¼‰

**å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸€æ®µä»£ç ï¼š**

```js
shouldComponentUpdate(nextProps, nextState) {
    if (nextState.count !== this.state.count
       	|| nextProps.text !== this.props.length) {
        return true // å¯ä»¥æ¸²æŸ“
    }
    return false // ä¸é‡å¤æ¸²æŸ“
}
```

åœ¨ `React` ä¸­ï¼Œé»˜è®¤çš„æ˜¯ï¼Œå½“çˆ¶ç»„ä»¶æœ‰æ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿæ— æ¡ä»¶æ›´æ–°ã€‚é‚£å¦‚æœæ¯å›éƒ½è§¦å‘æ›´æ–°ï¼Œè‚¯å®šä¸å¤ªå¥½ã€‚

å› æ­¤ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨åˆ° `shouldComponentUpdate` ï¼Œåˆ¤æ–­å½“å±æ€§æœ‰å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå¯ä»¥è§¦å‘æ¸²æŸ“ã€‚å½“å±æ€§ä¸å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¹Ÿå°±æ˜¯å‰åä¸¤æ¬¡çš„å€¼ç›¸åŒæ—¶ï¼Œå°±ä¸è§¦å‘æ¸²æŸ“ã€‚

é‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ éœ€è¦**æ€è€ƒä¸€ä¸ªé—®é¢˜**ï¼š `SCU` ä¸€å®šè¦æ¯æ¬¡éƒ½ç”¨å—ï¼Ÿç­”æ¡ˆå…¶å®**ä¸æ˜¯è‚¯å®šçš„**ã€‚

æˆ‘ä»¬ä¼šå»ç”¨ `SCU` ï¼Œä»æŸç§å±‚é¢ä¸Šæ¥è®²å°±æ˜¯**ä¸ºäº†ä¼˜åŒ–**ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¾æ®å½“å‰çš„å¼€å‘åœºæ™¯ï¼Œæœ‰éœ€è¦çš„æ—¶å€™å†å»ä¼˜åŒ–ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ `SCU` çš„ä½¿ç”¨æ–¹å¼ï¼Œ**å…·ä½“å¦‚ä¸‹ï¼š**

- `SCU` **é»˜è®¤**è¿”å› `true` ï¼Œå³ `React` é»˜è®¤é‡æ–°æ¸²æŸ“æ‰€æœ‰å­ç»„ä»¶ï¼›
- å¿…é¡»é…åˆ **â€œä¸å¯å˜å€¼â€** ä¸€èµ·ä½¿ç”¨ï¼›
- å¯å…ˆä¸ç”¨ `SCU` ï¼Œæœ‰æ€§èƒ½é—®é¢˜æ—¶å†è€ƒè™‘ä½¿ç”¨ã€‚

### ï¼ˆ2ï¼‰PureComponent å’Œ React.memo

`PureComponent` åœ¨ `react` ä¸­çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š

```js
class List extends React.PureComponent {
  constructor(props) {
    super(props);
  }
  render() {
    const { list } = this.props;

    return (
      <ul>
        {list.map((item, index) => {
          return (
            <li key={item.id}>
              <span>{item.title}</span>
            </li>
          );
        })}
      </ul>
    );
  }
  shouldComponentUpdate() {
    /*æµ…æ¯”è¾ƒ*/
  }
}
```

å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº† `PureComponent` ï¼Œé‚£ä¹ˆ `SCU` ä¼šè¿›è¡Œ**æµ…å±‚æ¯”è¾ƒ**ï¼Œä¹Ÿå°±æ˜¯ä¸€å±‚ä¸€å±‚çš„æ¯”è¾ƒä¸‹å»ã€‚

---

ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ `memo` ã€‚ `memo` ï¼Œé¡¾åæ€ä¹‰æ˜¯**å¤‡å¿˜å½•**çš„æ„æ€ã€‚åœ¨ `React` ä¸­çš„**ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š**

```js
function MyComponent(props) {
  /* ä½¿ç”¨props æ¸²æŸ“ */
}

function areEqual(prevProps, nextProps) {
  /*
    å¦‚æœæŠŠ nextPropsä¼ å…¥renderæ–¹æ³•çš„è¿”å›ç»“æœ ä¸
     prePropsä¼ å…¥renderæ–¹æ³•çš„è¿”å›ç»“æœ ä¸€è‡´çš„è¯ï¼Œåˆ™è¿”å›trueï¼Œ
    å¦åˆ™è¿”å›false
    */
}
export default React.memo(MyComponent, areEqual);
```

`memo` ï¼Œå¯ä»¥è¯´æ˜¯å‡½æ•°ç»„ä»¶ä¸­çš„ `PureComponent` ã€‚åŒæ—¶ï¼Œä½¿ç”¨ `React.memo()` çš„å½¢å¼ï¼Œå°†æˆ‘ä»¬çš„**å‡½æ•°ç»„ä»¶**å’Œ `areEqual` çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åè¿”å›ä¸€ä¸ª**æ–°çš„å‡½æ•°**ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ `React` ä¸­ï¼Œ**æµ…æ¯”è¾ƒå·²ç»ä½¿ç”¨äºå¤§éƒ¨åˆ†æƒ…å†µ**ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ**å°½é‡ä¸è¦åšæ·±åº¦æ¯”è¾ƒ**ã€‚

### ï¼ˆ3ï¼‰ä¸å¯å˜å€¼

åœ¨ `React` ä¸­ï¼Œç”¨äºåšä¸å¯å˜å€¼çš„æœ‰ä¸€ä¸ªåº“ï¼š `Immutable.js` ã€‚è¿™ä¸ªåº“**æœ‰ä»¥ä¸‹å‡ å¤§ç‰¹ç‚¹ï¼š**

- å½»åº•æ‹¥æŠ±â€œä¸å¯å˜å€¼â€

- åŸºäºå…±äº«æ•°æ®ï¼ˆä¸æ˜¯æ·±æ‹·è´ï¼‰ï¼Œé€Ÿåº¦å¥½
- æœ‰ä¸€å®šçš„å­¦ä¹ å’Œè¿ç§»æˆæœ¬ï¼ŒæŒ‰éœ€ä½¿ç”¨

**ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä½¿ç”¨ä¾‹å­ï¼š**

```js
const map1 = Immutable.Map({ a: 1, b: 2, c: 3 });
const map2 = map1.set('b', 50);
map1.get('b'); // 2
map2.get('b'); // 50
```

åŸºæœ¬ä¸Šç°åœ¨åœ¨å¼€å‘ä¸­éƒ½ç”¨è¿™ä¸ªåº“æ¥å¤„ç†**ä¸å¯å˜å€¼**çš„é—®é¢˜ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£**æŒ‰éœ€ä½¿ç”¨**å³å¯ã€‚

## 7ã€å…³äºç»„ä»¶å…¬å…±é€»è¾‘çš„æŠ½ç¦»

åœ¨ `React` ä¸­ï¼Œå¯¹äºç»„ä»¶å…¬å…±é€»è¾‘çš„æŠ½ç¦»ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼è¦äº†è§£ã€‚**å…·ä½“å¦‚ä¸‹ï¼š**

- `mixin` ï¼Œå·²è¢« `React` å¼ƒç”¨
- é«˜é˜¶ç»„ä»¶ `HOC`
- Render Props

ä¸‹é¢å°†è®²è§£é«˜é˜¶ç»„ä»¶ `HOC` å’Œ `Render Props` ã€‚

### ï¼ˆ1ï¼‰é«˜é˜¶ç»„ä»¶ HOC

**å…ˆçœ‹ä¸€æ®µä»£ç ï¼š**

```js
// é«˜é˜¶ç»„ä»¶ä¸æ˜¯ä¸€ç§åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼
// 1.ä¼ å…¥ä¸€ä¸ªç»„ä»¶ Component
const HOCFactory = (Component) => {
    class HOC extends React.Component {
        // åœ¨æ­¤å®šä¹‰å¤šä¸ªç»„ä»¶çš„å…¬å…±é€»è¾‘
        render() {
            // 2.è¿”å›æ‹¼æ¥çš„ç»“æœ
            return <Component {this.props} />
        }
    }
    return HOC
}
const EnhancedComponent1 = HOCFactory(WrappedComponent1)
const EnhancedComponent2 = HOCFactory(WrappedComponent2)
```

é«˜é˜¶ç»„ä»¶ `HOC` æ˜¯**ä¼ å…¥**ä¸€ä¸ªç»„ä»¶ï¼Œ**è¿”å›**ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè§ä¸Šæ–¹ä»£ç çš„ `1å’Œ2` ã€‚

---

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œ**å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';

// é«˜é˜¶ç»„ä»¶
const withMouse = (Component) => {
  class withMouseComponent extends React.Component {
    constructor(props) {
      super(props);
      this.state = { x: 0, y: 0 };
    }

    handleMouseMove = (event) => {
      this.setState({
        x: event.clientX,
        y: event.clientY,
      });
    };

    render() {
      return (
        <div style={{ height: '500px' }} onMouseMove={this.handleMouseMove}>
          {/* 1. é€ä¼ æ‰€æœ‰ props 2. å¢åŠ  mouse å±æ€§ */}
          <Component {...this.props} mouse={this.state} />
        </div>
      );
    }
  }
  return withMouseComponent;
};

const App = (props) => {
  const { x, y } = props.mouse; // æ¥æ”¶ mouse å±æ€§
  return (
    <div style={{ height: '500px' }}>
      <h1>
        The mouse position is ({x}, {y})
      </h1>
    </div>
  );
};

export default withMouse(App); // è¿”å›é«˜é˜¶å‡½æ•°
```

**æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºç»“æœä¸ºï¼š**

![é«˜é˜¶ç»„ä»¶HOC](https://img-blog.csdnimg.cn/276b1f2d1e8443bb966d4f879b069e38.gif#pic_center)

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨ å®šä¹‰äº†é«˜é˜¶ç»„ä»¶ `withMouse` ï¼Œä¹‹åå®ƒé€šè¿‡ `<Component {...this.props} mouse={this.state}/>` è¿™ç§å½¢å¼ï¼Œå°†å‚æ•° **props** å’Œ **props çš„ mouse å±æ€§**ç»™é€ä¼ å‡ºæ¥ï¼Œä¾›å­ç»„ä»¶ `App` ä½¿ç”¨ã€‚

---

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ `react` ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é«˜é˜¶ç»„ä»¶æ˜¯ `redux connect` ã€‚**ç”¨ä¸€æ®µä»£ç æ¥æ¼”ç¤ºï¼š**

```js
import { connect } from 'react-redux';

// connect æ˜¯é«˜é˜¶ç»„ä»¶
const VisibleTodoList = connect(mapStateToProps, mapDispatchToProps)(TodoList);

export default VisibleTodoList;
```

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ `connect` çš„æºç ï¼Œ**å…·ä½“å¦‚ä¸‹ï¼š**

```js
export const connect =
  (mapStateToProps, mapDispatchToProps) => (WrappedComponent) => {
    class Connect extends Component {
      constructor() {
        super();
        this.state = {
          allProps: {},
        };
      }
      /* ä¸­é—´çœç•¥ N è¡Œä»£ç  */
      render() {
        return <WrappedComponent {...this.state.allProps} />;
      }
    }
    return Connect;
  };
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œ `Connect` ä¹Ÿæ˜¯åŒæ ·åœ°ï¼Œä¼ å…¥ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªç»„ä»¶ã€‚

### ï¼ˆ2ï¼‰Render Props

**å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
// Render Props çš„æ ¸å¿ƒæ€æƒ³
// 1.é€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼Œå°†classç»„ä»¶çš„stateä½œä¸ºpropsï¼Œä¼ é€’ç»™çº¯å‡½æ•°ç»„ä»¶
class Factory extends React.Component {
  constructor() {
    tihs.state = {
      /* state å³å¤šä¸ªç»„ä»¶çš„å…¬å…±é€»è¾‘çš„æ•°æ® */
    };
  }
  /* 2.ä¿®æ”¹ state */
  render() {
    return <div>{this.props.render(this.state)}</div>;
  }
}

const App = () => {
  // 3.åœ¨è¿™é‡Œä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ŒåŒæ—¶å°†é«˜é˜¶ç»„ä»¶ä¸­çš„renderå±æ€§ä¼ é€’è¿›æ¥
  <Factory
    render={
      /* render æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ */
      (props) => (
        <p>
          {props.a}
          {props.b} â€¦
        </p>
      )
    }
  />;
};

export default App;
```

åœ¨ä¸Šé¢çš„é«˜é˜¶ç»„ä»¶ `HOC` ä¸­ï¼Œæœ€ç»ˆè¿”å›çš„ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ã€‚ä½†åœ¨ `Render Props` ä¸­ï¼Œæˆ‘ä»¬æŠŠ `Factory` åŒ…è£¹åœ¨å®šä¹‰çš„ `App` ç»„ä»¶ä¸­ï¼Œæœ€ç»ˆå†æŠŠ `App` è¿”å›ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ `Vue` ä¸­æœ‰ç±»ä¼¼äºé«˜é˜¶ç»„ä»¶çš„ç”¨æ³•ï¼Œä½†æ²¡æœ‰åƒ `Render Props` ç±»ä¼¼çš„ç”¨æ³•ï¼Œè¿™ä¸€ç‚¹éœ€è¦ç¨å¾®ç•™æ„ä¸€ä¸‹ã€‚

---

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';
import PropTypes from 'prop-types';

class Mouse extends React.Component {
  constructor(props) {
    super(props);
    this.state = { x: 0, y: 0 };
  }

  handleMouseMove = (event) => {
    this.setState({
      x: event.clientX,
      y: event.clientY,
    });
  };

  render() {
    return (
      <div style={{ height: '500px' }} onMouseMove={this.handleMouseMove}>
        {/* å°†å½“å‰ state ä½œä¸º props ï¼Œä¼ é€’ç»™ render ï¼ˆrender æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ï¼‰ */}
        {this.props.render(this.state)}
      </div>
    );
  }
}
Mouse.propTypes = {
  render: PropTypes.func.isRequired, // å¿…é¡»æ¥æ”¶ä¸€ä¸ª render å±æ€§ï¼Œè€Œä¸”æ˜¯å‡½æ•°
};

const App = (props) => (
  <div style={{ height: '500px' }}>
    <Mouse
      render={
        /* render æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ */
        ({ x, y }) => (
          <h1>
            The mouse position is ({x}, {y})
          </h1>
        )
      }
    />
  </div>
);

/**
 * å³ï¼Œå®šä¹‰äº† Mouse ç»„ä»¶ï¼Œåªæœ‰è·å– x y çš„èƒ½åŠ›ã€‚
 * è‡³äº Mouse ç»„ä»¶å¦‚ä½•æ¸²æŸ“ï¼ŒApp è¯´äº†ç®—ï¼Œé€šè¿‡ render prop çš„æ–¹å¼å‘Šè¯‰ Mouse ã€‚
 */

export default App;
```

æ­¤æ—¶ï¼Œæµè§ˆå™¨çš„**æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š**

![Render Props](https://img-blog.csdnimg.cn/5f63b736f6784c8a8c50b9258e95bada.gif#pic_center)

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡ `this.props.render(this.state)` è¿™ç§å½¢å¼ï¼Œå°† `Mouse` ç»„ä»¶ä¸­çš„å±æ€§ä¼ é€’ç»™ `App` ï¼Œå¹¶è®© `App` æˆåŠŸä½¿ç”¨åˆ° `Mouse` çš„å±æ€§å€¼ã€‚

### ï¼ˆ3ï¼‰HOC vs Render Props

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸‹ `HOC` å’Œ `Render Props` çš„åŒºåˆ«ï¼Œ**å…·ä½“å¦‚ä¸‹ï¼š**

- **HOC**ï¼šæ¨¡å¼ç®€å•ï¼Œä½†ä¼šå¢åŠ **ç»„ä»¶å±‚çº§**
- **Render Props**ï¼šä»£ç ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬è¾ƒé«˜
- å„æœ‰å„çš„ä¼˜ç¼ºç‚¹ï¼Œæ ¹æ®å®é™…åœºæ™¯**æŒ‰éœ€ä½¿ç”¨**å³å¯

# ğŸ“š ä¸‰ã€Redux å’Œ React-router

## 1ã€Redux

### ï¼ˆ1ï¼‰Redux æ¦‚å¿µç®€è¿°

å¯¹äº `react` æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªéè§†å›¾å±‚çš„è½»é‡çº§æ¡†æ¶ï¼Œå¦‚æœè¦ç”¨å®ƒæ¥ä¼ é€’æ•°æ®çš„è¯ï¼Œåˆ™è¦å…ˆçˆ¶ä¼ å­ï¼Œç„¶åå†æ…¢æ…¢åœ°ä¸€å±‚ä¸€å±‚å¾€ä¸Šä¼ é€’ã€‚

ä½†å¦‚æœç”¨ `redux` çš„è¯ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦**æŸä¸ªç»„ä»¶çš„æ•°æ®**ï¼Œé‚£è¿™ä¸ªç»„ä»¶çš„æ•°æ®åˆ™ä¼šé€šè¿‡ `redux` æ¥å­˜æ”¾åˆ° `store` ä¸­è¿›è¡Œç®¡ç†ã€‚ä¹‹åå‘¢ï¼Œé€šè¿‡ `store` ï¼Œå†æ¥å°†æ•°æ®ä¸€æ­¥æ­¥åœ°å¾€ä¸‹é¢çš„ç»„ä»¶è¿›è¡Œä¼ é€’ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è§† `Redux` ä¸º `Reducer` å’Œ `Flux` çš„ç»“åˆã€‚

### ï¼ˆ2ï¼‰Redux çš„å·¥ä½œæµç¨‹

`Redux` ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ª**æ•°æ®å±‚**çš„æ¡†æ¶ï¼Œå®ƒæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åœ¨äº† `store` ä¹‹ä¸­ã€‚**æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ å›¾ï¼š**

![Reduxçš„å·¥ä½œæµç¨‹](https://img-blog.csdnimg.cn/img_convert/d85d3ecf4dbdfcedae11f70378161b06.png)

å¤§å®¶å¯ä»¥çœ‹åˆ°ä¸­é—´çš„ `store` ï¼Œå®ƒé‡Œé¢å°±å­˜æ”¾ç€**æ‰€æœ‰çš„æ•°æ®**ã€‚ç»§ç»­çœ‹ `store` å‘ä¸‹çš„ç®­å¤´ï¼Œç„¶åå‘¢ï¼Œæ¯ä¸ªç»„ä»¶éƒ½è¦å‘ `store` é‡Œé¢å»æ‹¿æ•°æ®ã€‚

æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥æ¢³ç†æ•´å¼ å›¾ï¼Œ**å…·ä½“å¦‚ä¸‹ï¼š**

- â‘  æ•´å¼ å›¾ä¸Šæœ‰ä¸€ä¸ª `store` ï¼Œå®ƒå­˜æ”¾ç€æ‰€æœ‰çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯**å­˜å‚¨æ•°æ®çš„å…¬å…±åŒºåŸŸ**ï¼›
- â‘¡ æ¯ä¸ªç»„ä»¶ï¼Œéƒ½è¦ä» `store` é‡Œé¢æ‹¿æ•°æ®ï¼›
- â‘¢ å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œæ¨¡æ‹Ÿæˆ‘ä»¬è¦åœ¨å›¾ä¹¦é¦†é‡Œé¢å€Ÿä¹¦ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠ `react Component` ç†è§£ä¸ºå€Ÿä¹¦äººï¼Œä¹‹åå‘¢ï¼Œå€Ÿä¹¦äººè¦å»æ‰¾å›¾ä¹¦é¦†ç®¡ç†å‘˜æ‰èƒ½å€Ÿåˆ°è¿™æœ¬ä¹¦ã€‚è€Œå€Ÿä¹¦è¿™ä¸ªè¿‡ç¨‹ä¸­æ•°æ®çš„ä¼ é€’ï¼Œå°±å¯ä»¥æŠŠå®ƒè§†ä¸ºæ˜¯ `Action Creators` ï¼Œå¯ä»¥ç†è§£ä¸º **â€œä½ æƒ³è¦å€Ÿä»€ä¹ˆä¹¦â€** è¿™å¥è¯ã€‚
- â‘£ `Action Creatures` å»åˆ° `store` ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æŠŠ `store` å½“åšæ˜¯**å›¾ä¹¦é¦†ç®¡ç†å‘˜**ï¼Œä½†æ˜¯ï¼Œå›¾ä¹¦é¦†ç®¡ç†å‘˜æ˜¯æ²¡æœ‰åŠæ³•è®°ä½æ‰€æœ‰å›¾ä¹¦çš„æ•°æ®æƒ…å†µçš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®ƒéƒ½éœ€è¦ä¸€ä¸ªè®°å½•æœ¬ï¼Œä½ æƒ³è¦å€Ÿä»€ä¹ˆæ ·çš„ä¹¦ï¼Œé‚£ä¹ˆå¥¹å°±å…ˆæŸ¥ä¸€ä¸‹ï¼›åˆæˆ–è€…ä½ æƒ³è¦è¿˜ä»€ä¹ˆä¹¦ï¼Œå¥¹ä¹Ÿè¦æŸ¥ä¸€ä¸‹ï¼Œéœ€è¦æ”¾å›ä»€ä¹ˆä½ç½®ä¸Šã€‚
- â‘¤ è¿™ä¸ªæ—¶å€™å°±éœ€è¦è·Ÿ `reducers` å»é€šä¿¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ `reducers` è§†ä¸ºæ˜¯ä¸€ä¸ª**è®°å½•æœ¬**ï¼Œå›¾ä¹¦é¦†ç®¡ç†å‘˜ç”¨è¿™ä¸ª**è®°å½•æœ¬**æ¥è®°å½•éœ€è¦çš„æ•°æ®ã€‚ç®¡ç†å‘˜ `store` é€šè¿‡ `reducer` çŸ¥é“äº†åº”è¯¥ç»™å€Ÿä¹¦äºº `Components` ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚

### ï¼ˆ2ï¼‰react-redux

`React-redux` ä¸­è¦äº†è§£çš„å‡ ä¸ªç‚¹æ˜¯ `Provider` ã€ `Connect` ã€ `mapStateToProps` å’Œ `mapDisptchToProps` ã€‚

**æ¥çœ‹ä»¥ä¸‹ä»£ç ï¼š**

```js
import React from 'react';
import { Provider } from 'react-redux';
import { createStore } from 'redux';
import todoApp from './reducers';
import App from './components/App';

let store = createStore(todoApp);

export default function () {
  return (
    <Provider store={store}>
      <App />
    </Provider>
  );
}
```

`react-redux` æä¾›äº† `Provider` çš„èƒ½åŠ›ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°æœ€åéƒ¨åˆ†çš„ä»£ç ï¼Œ `Provider` å°† `<App />` åŒ…è£¹èµ·æ¥ï¼Œå…¶å®ä¹Ÿå°±æ˜¯è¯´ä¸ºå®ƒåŒ…è£¹çš„æ‰€æœ‰ç»„ä»¶æä¾› `store` èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ `Provider` å‘æŒ¥çš„ä½œç”¨ã€‚

**å†æ¥çœ‹ä¸€æ®µä»£ç ï¼š**

```js
import { connect } from 'react-redux';
import { toggleTodo } from '../actions';
import TodoList from '../components/TodoList';

// ä¸åŒç±»å‹çš„ todo åˆ—è¡¨
const getVisibleTodos = (todos, filter) => {
  switch (filter) {
    case 'SHOW_ALL':
      return todos;
    case 'SHOW_COMPLETED':
      return todos.filter((t) => t.completed);
    case 'SHOW_ACTIVE':
      return todos.filter((t) => !t.completed);
  }
};

const mapStateToProps = (state) => {
  // state å³ vuex çš„æ€»çŠ¶æ€ï¼Œåœ¨ reducer/index.js ä¸­å®šä¹‰
  return {
    // æ ¹æ®å®ŒæˆçŠ¶æ€ï¼Œç­›é€‰æ•°æ®
    todos: getVisibleTodos(state.todos, state.visibilityFilter),
  };
};

const mapDispatchToProps = (dispatch) => {
  return {
    // åˆ‡æ¢å®ŒæˆçŠ¶æ€
    onTodoClick: (id) => {
      dispatch(toggleTodo(id));
    },
  };
};

// connect é«˜é˜¶ç»„ä»¶ï¼Œå°† state å’Œ dispatch æ³¨å…¥åˆ°ç»„ä»¶ props ä¸­
const VisibleTodoList = connect(mapStateToProps, mapDispatchToProps)(TodoList);

export default VisibleTodoList;
```

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ `connect` å°† `state` å’Œ `dispatch` ç»™æ³¨å…¥åˆ°ç»„ä»¶çš„ `props` ä¸­ï¼Œå°†å±æ€§ä¼ é€’ç»™åˆ° `TodoList` ç»„ä»¶ã€‚

### ï¼ˆ3ï¼‰å¼‚æ­¥ action

`redux` ä¸­çš„**åŒæ­¥** `action` å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

```js
// åŒæ­¥ action
export const addTodo = (text) => {
  // è¿”å› action å¯¹è±¡
  return {
    type: 'ADD_TODO',
    id: nextTodoId++,
    text,
  };
};
```

`redux` ä¸­çš„**å¼‚æ­¥** `action` å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

```js
// å¼‚æ­¥ action
export const addTodoAsync = (text) => {
  // è¿”å›å‡½æ•°ï¼Œå…¶ä¸­æœ‰ dispatch å‚æ•°
  return (dispatch) => {
    // ajax å¼‚æ­¥è·å–æ•°æ®
    fetch(url).thne((res) => {
      // æ‰§è¡Œå¼‚æ­¥ action
      dispatch(addTodo(res.text));
    });
  };
};
```

### ï¼ˆ4ï¼‰Redux æ•°æ®æµå›¾

`Redux` çš„å•é¡¹æ•°æ®æµå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://img-blog.csdnimg.cn/7df2d40cde164f41999e588ddd15e8fa.png#pic_center)

å…³äº `Redux` æ›´è¯¦ç»†å†…å®¹ï¼Œå¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š[Redux ä»å…¥é—¨åˆ°è¿›é˜¶ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼](https://juejin.cn/post/7023236065620131876)

## 2ã€React-router

### ï¼ˆ1ï¼‰è·¯ç”±æ¨¡å¼

`React-router` å’Œ `vue-router` ä¸€æ ·ï¼Œéƒ½æ˜¯**ä¸¤ç§æ¨¡å¼**ã€‚**å…·ä½“å¦‚ä¸‹ï¼š**

- `hash` æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼Œå¦‚ `http://abc.com/#/user/10`
- `H5 history` æ¨¡å¼ï¼Œå¦‚ `http://abc.com/user/20`
- åè€…éœ€è¦ `server` ç«¯æ”¯æŒï¼Œå› æ­¤æ— ç‰¹æ®Šéœ€æ±‚å¯é€‰æ‹©å‰è€…

**hash æ¨¡å¼çš„è·¯ç”±é…ç½®å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š**

```js
import React from 'react';
import { HashRouter as Router, Switch, Route } from 'react-router-dom';

function RouterComponent() {
  return (
    <Router>
      <Switch>
        <Route exact path='/'>
          <Home />
        </Route>
        <Route exact path='/project/:id'>
          <Project />
        </Route>
        <Route path='*'>
          <NotFound />
        </Route>
      </Switch>
    </Router>
  );
}
```

**History æ¨¡å¼çš„è·¯ç”±é…ç½®å¦‚ä¸‹ï¼š**

```js
import React from 'react';
import { BrowserRouter as Router, Switch, Route } from 'react-router-dom';

function RouterComponent() {
  return (
    <Router>
      <Switch>
        <Route exact path='/'>
          <Home />
        </Route>
        <Route exact path='/project/:id'>
          <Project />
        </Route>
        <Route path='*'>
          <NotFound />
        </Route>
      </Switch>
    </Router>
  );
}
```

æ³¨æ„ï¼Œ`hash` å’Œ `history` çš„åŒºåˆ«åœ¨äº **import** ä¸­çš„ `HashRouter` å’Œ `BrowserRouter` ã€‚

å…³äº `hash` å’Œ `history` ç›¸å…³çš„å†…å®¹ï¼Œè¿›ä¸€æ­¥äº†è§£å¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š[æµ…è°ˆå‰ç«¯è·¯ç”±åŸç† hash å’Œ history](https://juejin.cn/post/6993840419041706014)

### ï¼ˆ2ï¼‰è·¯ç”±é…ç½®

#### â… . åŠ¨æ€è·¯ç”±

å‡è®¾ç°åœ¨æœ‰çˆ¶ç»„ä»¶ `RouterComponent` ï¼Œ**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
function RouterComponent() {
  return (
    <Router>
      <Switch>
        <Route exact path='/'>
          <Home />
        </Route>
        <Route exact path='/project/:id'>
          <Project />
        </Route>
        <Route path='*'>
          <NotFound />
        </Route>
      </Switch>
    </Router>
  );
}
```

å…¶ä¸­ï¼Œåœ¨è¿™ä¸ªç»„ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ª `Project` ç»„ä»¶ï¼Œéœ€è¦è¿›è¡ŒåŠ¨æ€ä¼ å‚ã€‚

---

ç»§ç»­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å­ç»„ä»¶ `Project` ç»„ä»¶æ—¶å¦‚ä½•è¿›è¡Œ**åŠ¨æ€ä¼ å‚**çš„ã€‚**å…·ä½“ä»£ç å¦‚ä¸‹ï¼š**

```js
import React from 'react';
import { Link, useParams } from 'react-router-dom';

function Project() {
  // è·å– url å‚æ•°ï¼Œå¦‚ '/project/100'
  const { id } = useParams();
  console.log('url param id', id);

  return (
    <div>
      <Link to='/'>é¦–é¡µ</Link>
    </div>
  );
}
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ `React` ä¸­ï¼Œé€šè¿‡ `const { id } = useParams()` è¿™æ ·çš„å½¢å¼ï¼Œæ¥è¿›è¡ŒåŠ¨æ€ä¼ å‚ã€‚

---

è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µæ˜¯**è·³è½¬è·¯ç”±**ã€‚**è¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š**

```js
import React from 'react';
import { useHistory } from 'react-router-dom';

function Trash() {
  let history = useHistory();
  function handleClick() {
    history.push('/');
  }
  return (
    <div>
      <Button type='primary' onClick={handleClick}>
        å›åˆ°é¦–é¡µ
      </Button>
    </div>
  );
}
```

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨ `useHistory` ï¼Œè®©ç‚¹å‡»äº‹ä»¶è·³è½¬åˆ°é¦–é¡µä¸­ã€‚

#### â…¡. æ‡’åŠ è½½

```js
import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';
import React, { Suspence, lazy } from 'react';

const Home = lazy(() => import('./routes/Home'));
const About lazy(() => import('./routes/About'));

const App = () => {
    <Router>
    	<Suspense fallback={<div>Loadingâ€¦â€¦</div>}>
        	<Switch>
        		<Route exact path="/" component={Home}/>
                 <Route path="/about" component={About}/>
        	</Switch>
        </Suspense>
    </Router>
}
```

åœ¨ `React` ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ `lazy()` åŒ…è£¹ï¼Œå¯¹é¡µé¢çš„å†…å®¹è¿›è¡Œæ‡’åŠ è½½ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µæ˜¯ï¼ŒåŠ è½½ç±»ä¼¼äºé¦–é¡µåˆæ¬¡åŠ è½½é¡µé¢ `Loading` çš„é‚£ç§æ•ˆæœï¼Œåœ¨ `react` ä¸­å¯ä»¥ä½¿ç”¨ `<Suspense>` æ¥è§£å†³ã€‚

# ğŸ—ï¸ å››ã€ç»“æŸè¯­

åœ¨ä¸Šé¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²è§£äº† `react` çš„åŸºæœ¬ä½¿ç”¨ä»¥åŠé«˜çº§ç‰¹æ€§ã€‚åŒæ—¶ï¼Œè¿˜è®²è§£äº† `react` çš„å‘¨è¾¹æ’ä»¶ï¼Œ `Redux` å’Œ `React-router` ã€‚

å‰ç«¯åœ¨åš `react` çš„é¡¹ç›®æ—¶ï¼Œæ€»æ˜¯è„±ç¦»ä¸å¼€ä»¥ä¸Šæ–‡ç« æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºåŸºæœ¬ä½¿ç”¨çš„å†…å®¹ç”¨çš„è¾ƒå¤šï¼Œè€Œé«˜çº§ç‰¹æ€§çš„ä½¿ç”¨åœºæ™¯ç›¸å¯¹ä¼šå°‘ä¸€äº›ã€‚

å¸Œæœ›é€šè¿‡ä¸Šæ–‡çš„è®²è§£ï¼Œå°ä¼™ä¼´ä»¬æœ‰æ‰€æ”¶è· ğŸ¥‚

> - å…³æ³¨å…¬ä¼—å· **æ˜ŸæœŸä¸€ç ”ç©¶å®¤** ï¼Œç¬¬ä¸€æ—¶é—´å…³æ³¨å­¦ä¹ å¹²è´§ï¼Œæ›´å¤š **ã€Œoffer æ¥äº†ã€** é¢è¯•ä¸“æ å¾…ä½ è§£é”~
> - å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œè®°å¾—**ç•™ä¸ªè„šå° jio**å†èµ°å“Ÿ~
> - æˆ‘ä»¬ä¸‹æœŸè§ï¼ğŸ”‘ğŸ”‘ğŸ”‘

å°é¢

ä¸€æ–‡è¯¦è§£ react çš„åŸºæœ¬ä½¿ç”¨ã€é«˜çº§ç‰¹æ€§å’Œå‘¨è¾¹æ’ä»¶
â° åºè¨€
ğŸ“ ä¸€ã€React çš„åŸºæœ¬ä½¿ç”¨
1ã€JSX åŸºæœ¬ä½¿ç”¨
ï¼ˆ1ï¼‰å˜é‡ã€è¡¨è¾¾å¼
ï¼ˆ2ï¼‰class å’Œ style
ï¼ˆ3ï¼‰å­å…ƒç´ å’Œç»„ä»¶
ï¼ˆ4ï¼‰åŸç”Ÿ html
2ã€æ¡ä»¶åˆ¤æ–­
ï¼ˆ1ï¼‰if else
ï¼ˆ2ï¼‰ä¸‰å…ƒè¡¨è¾¾å¼
ï¼ˆ3ï¼‰é€»è¾‘è¿ç®—ç¬¦ && ||
3ã€æ¸²æŸ“åˆ—è¡¨
ï¼ˆ1ï¼‰map å’Œ key
4ã€React çš„äº‹ä»¶
ï¼ˆ1ï¼‰bind this
ï¼ˆ2ï¼‰å…³äº event å‚æ•°
ï¼ˆ3ï¼‰ä¼ é€’è‡ªå®šä¹‰å‚æ•°
ï¼ˆ4ï¼‰æ³¨æ„ç‚¹
5ã€è¡¨å•
ï¼ˆ1ï¼‰å—æ§ç»„ä»¶
ï¼ˆ2ï¼‰input textarea select ç”¨ value
ï¼ˆ3ï¼‰checkbox radio ç”¨ checked
6ã€ç»„ä»¶ä½¿ç”¨
ï¼ˆ1ï¼‰props ä¼ é€’æ•°æ®
ï¼ˆ2ï¼‰props ä¼ é€’å‡½æ•°
ï¼ˆ3ï¼‰props ç±»å‹æ£€æŸ¥
7ã€setState
ï¼ˆ1ï¼‰ä¸å¯å˜å€¼
ï¼ˆ2ï¼‰å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°
ï¼ˆ3ï¼‰å¯èƒ½ä¼šè¢«åˆå¹¶
8ã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
ğŸ“– äºŒã€React é«˜çº§ç‰¹æ€§
1ã€å‡½æ•°ç»„ä»¶
2ã€éå—æ§ç»„ä»¶
ï¼ˆ1ï¼‰input
ï¼ˆ2ï¼‰checkbox
ï¼ˆ3ï¼‰file
ï¼ˆ4ï¼‰æ€»ç»“æ¢³ç†
3ã€Protals
ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆè¦ç”¨ Protals ï¼Ÿ
ï¼ˆ2ï¼‰å¦‚ä½•ä½¿ç”¨
ï¼ˆ3ï¼‰ä½¿ç”¨åœºæ™¯
4ã€context
ï¼ˆ1ï¼‰ä½¿ç”¨åœºæ™¯
ï¼ˆ2ï¼‰ä¸¾ä¾‹é˜è¿°
5ã€å¼‚æ­¥ç»„ä»¶ï¼ˆæ‡’åŠ è½½ï¼‰
6ã€æ€§èƒ½ä¼˜åŒ–
ï¼ˆ1ï¼‰shouldComponentUpdateï¼ˆç®€ç§° SCUï¼‰
ï¼ˆ2ï¼‰PureComponent å’Œ React.memo
ï¼ˆ3ï¼‰ä¸å¯å˜å€¼
7ã€å…³äºç»„ä»¶å…¬å…±é€»è¾‘çš„æŠ½ç¦»
ï¼ˆ1ï¼‰é«˜é˜¶ç»„ä»¶ HOC
ï¼ˆ2ï¼‰Render Props
ï¼ˆ3ï¼‰HOC vs Render Props
ğŸ“š ä¸‰ã€Redux å’Œ React-router
1ã€Redux
ï¼ˆ1ï¼‰Redux æ¦‚å¿µç®€è¿°
ï¼ˆ2ï¼‰Redux çš„å·¥ä½œæµç¨‹
ï¼ˆ2ï¼‰react-redux
ï¼ˆ3ï¼‰å¼‚æ­¥ action
ï¼ˆ4ï¼‰Redux æ•°æ®æµå›¾
2ã€React-router
ï¼ˆ1ï¼‰è·¯ç”±æ¨¡å¼
ï¼ˆ2ï¼‰è·¯ç”±é…ç½®
â… . åŠ¨æ€è·¯ç”±
â…¡. æ‡’åŠ è½½
ğŸ—ï¸ å››ã€ç»“æŸè¯­
â° åºè¨€
å¯¹äºåˆšå­¦ä¹  react çš„å°ä¼™ä¼´æ¥è¯´ï¼Œæ€»æ˜¯ä»åŸºç¡€å¼€å§‹å­¦ä¹ ï¼Œå‘¨ä¸€è‡ªç„¶ä¹Ÿä¸ä¾‹å¤–æã€‚é‚£åœ¨ä¸‹é¢çš„æ–‡ç« ä¸­ï¼Œå°†è®²è§£ react çš„åŸºæœ¬ä½¿ç”¨å’Œé«˜çº§ç‰¹æ€§ï¼Œæ›´æœ‰å‘¨è¾¹æ’ä»¶ Redux å’Œ React-router å¾…ä½ æ¥æ¢å¯»ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œèåˆå¤§é‡æ¡ˆä¾‹ ğŸŒ° å’ŒåŠ¨å›¾ ğŸ•¹ï¸ è¿›è¡Œå±•ç¤ºã€‚å¯ä»¥æŠŠå®ƒå½“æˆæ˜¯ react çš„å…¥é—¨å®åº“ï¼Œæœ‰ä¸æ‡‚çš„è¯­æ³•çŸ¥è¯†ç‚¹æ—¶æˆ–è®¸åœ¨è¿™é‡Œå¯ä»¥å¯»æ‰¾åˆ°ä½ çš„ç­”æ¡ˆå¹¶ä¸”é€šè¿‡ä¾‹å­è¿ç”¨èµ·æ¥ã€‚

å®ï¼ŒåºŸè¯ä¸å¤šè¯´ï¼Œä¸‹é¢æ¥å¼€å§‹æ¢ç´¢ react çš„å¥¥ç§˜å§ ğŸ‘

ğŸ“ ä¸€ã€React çš„åŸºæœ¬ä½¿ç”¨
1ã€JSX åŸºæœ¬ä½¿ç”¨
ï¼ˆ1ï¼‰å˜é‡ã€è¡¨è¾¾å¼
åœ¨ react ä¸­ï¼Œæœ€åŸºç¡€çš„å†…å®¹ä¾¿æ˜¯å˜é‡å’Œè¡¨è¾¾å¼ï¼Œå…·ä½“å½¢å¼å¦‚ä¸‹ï¼š

ç¬¬ä¸€ç§ç±»å‹ï¼šè·å–å˜é‡ã€æ’å€¼

import React from 'react'

class JSXBaseDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
imgUrl: 'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
flag: true
}
}
render() {
// è·å–å˜é‡ æ’å€¼
const pElem = <p>{this.state.name}</p>
return pElem
}
}

export default JSXBaseDemo

æ³¨æ„ï¼Œ react ä¸­æ’å€¼çš„å½¢å¼æ˜¯å•ä¸ªèŠ±æ‹¬å· {} çš„å½¢å¼ã€‚æœ€ç»ˆæµè§ˆå™¨æ˜¾ç¤ºçš„æ•ˆæœå¦‚ä¸‹ï¼š

ç¬¬äºŒç§ç±»å‹ï¼šè¡¨è¾¾å¼

import React from 'react'

class JSXBaseDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
imgUrl: 'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
flag: true
}
}
render() {
// è¡¨è¾¾å¼
const exprElem = <p>{this.state.flag ? 'yes' : 'no'}</p>
return exprElem
}
}

export default JSXBaseDemo

react ä¸­ä¹Ÿæ”¯æŒç›´æ¥åœ¨æ’å€¼é‡Œé¢ä½¿ç”¨è¡¨è¾¾å¼ï¼Œå¦‚ä¸Šè¿°ä»£ç ä¸­çš„ this.state.flag ? 'yes' : 'no' ã€‚æœ€ç»ˆæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°

ï¼ˆ2ï¼‰class å’Œ style
é€šå¸¸æƒ…å†µä¸‹ï¼Œå¦‚æœæˆ‘ä»¬è¦ç»™æŸä¸€ä¸ªæ ‡ç­¾è®¾ç½®ç±»åï¼Œé‚£ä¹ˆä¼šç»™è¯¥æ ‡ç­¾åŠ ä¸Šä¸€ä¸ª class ã€‚è€Œåœ¨ react ä¸­ï¼Œå¦‚æœæƒ³è¦ç»™ä¸€ä¸ªæ ‡ç­¾åŠ ä¸Šä¸€ä¸ªç±»ï¼Œé‚£ä¹ˆéœ€è¦ç»™å…¶åŠ ä¸Š className ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'
import './style.css'
import List from '../List'

class JSXBaseDemo extends React.Component {
render() {
// class
const classElem = <p className="title">è®¾ç½® css class</p>

        // style
        const styleData = { fontSize: '30px',  color: 'blue' }
        const styleElem1 = <p style={styleData}>è®¾ç½® style</p>
        // å†…è”å†™æ³•ï¼Œæ³¨æ„ {{ å’Œ }}
        const styleElem2 = <p style={{ fontSize: '30px',  color: 'blue' }}>è®¾ç½® style</p>

    	// è¿”å›ç»“æœ
    	return [ classElem, styleElem1, styleElem2 ]
    }

}

export default JSXBaseDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

class å’Œ style

åŒæ—¶éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ react ä¸­ï¼Œå¦‚æœè¦åœ¨æ ‡ç­¾é‡Œé¢å†™å†…è”æ ·å¼ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨åŒèŠ±æ‹¬å· {{}} æ¥è¡¨ç¤ºã€‚

ï¼ˆ3ï¼‰å­å…ƒç´ å’Œç»„ä»¶
ç¬¬ä¸€ç§ç±»å‹ï¼šå­å…ƒç´ 

å¯¹äºå­å…ƒç´ æ¥è¯´ï¼Œå®ƒå¯ä»¥åœ¨æ ‡ç­¾é‡Œé¢è¿›è¡Œä½¿ç”¨ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

class JSXBaseDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
imgUrl: 'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
flag: true
}
}
render() {
// å­å…ƒç´ 
const imgElem = <div>
<p>æˆ‘çš„å¤´åƒ</p>
<img src="xxxx.png"/>
<img src={this.state.imgUrl}/>
</div>
return imgElem
}
}

export default JSXBaseDemo

æœ€ç»ˆï¼Œæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

å­å…ƒç´ 

ç¬¬äºŒç§ç±»å‹ï¼šåŠ è½½ç»„ä»¶

å¦‚æœè¦åœ¨ React ä¸­åŠ è½½ä¸€ä¸ªç»„ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå¤„ç†ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'
import './style.css'
import List from '../List'

class JSXBaseDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜é‡‘ï¼šæ˜ŸæœŸä¸€ç ”ç©¶å®¤',
imgUrl: 'https://p3-passport.byteacctimg.com/img/user-avatar/cc88f43a329099d65898aff670ea1171~300x300.image',
flag: true
}
}
render() {
// åŠ è½½ç»„ä»¶
const componentElem = <div>
<p>JSX ä¸­åŠ è½½ä¸€ä¸ªç»„ä»¶</p>
<hr/>
<List/>
</div>
return componentElem
}
}

export default JSXBaseDemo

List.js ç»„ä»¶çš„ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'

class List extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'React',
list: ['a', 'b', 'c']
}
}
render() {
return <div>
<p onClick={this.changeName.bind(this)}>{this.state.name}</p>
<ul>{
this.state.list.map((item, index) => {
return <li key={index}>{item}</li>
})
}</ul>
<button onClick={this.addItem.bind(this)}>æ·»åŠ ä¸€é¡¹</button>
</div>
}
changeName() {
this.setState({
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤'
})
}
addItem() {
this.setState({
list: this.state.list.concat(`${Date.now()}`) // ä½¿ç”¨ä¸å¯å˜å€¼
})
}
}

export default List
æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

ç”±æ­¤ï¼Œæˆ‘ä»¬å°±å°†ä¸€ä¸ªç»„ä»¶æ³¨å…¥åˆ°ç»„ä»¶å½“ä¸­ã€‚

ï¼ˆ4ï¼‰åŸç”Ÿ html
ç»§ç»­ï¼Œæˆ‘ä»¬æ¥çœ‹åŸç”Ÿ html åœ¨ react ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚å…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š

import React from 'react'

class JSXBaseDemo extends React.Component {
render() {
// åŸç”Ÿ html
const rawHtml = '<span>å¯Œæ–‡æœ¬å†…å®¹<i>æ–œä½“</i><b>åŠ ç²—</b></span>'
const rawHtmlData = {
// æŠŠ rawHtml èµ‹å€¼ç»™ **html
**html: rawHtml // æ³¨æ„ï¼Œå¿…é¡»æ˜¯è¿™ç§æ ¼å¼
}
const rawHtmlElem = <div>
<p dangerouslySetInnerHTML={rawHtmlData}></p>
<p>{rawHtml}</p>
</div>
return rawHtmlElem
}
}

export default JSXBaseDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

åŸç”Ÿ html

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœè¦åœ¨ react ä¸­ä½¿ç”¨åŸç”Ÿ html ï¼Œé‚£ä¹ˆå¿…é¡»ä½¿ç”¨ const rawHtmlData = { \_\_html: rawHtml } è¿™ç§å½¢å¼ï¼Œæ‰èƒ½å°†åŸç”Ÿ html ä»£ç ç»™è§£æå‡ºæ¥ã€‚å¦åˆ™çš„è¯ï¼Œ react æ˜¯æ— æ³•æ­£å¸¸å°†åŸç”Ÿ html è§£æå‡ºæ¥çš„ã€‚

2ã€æ¡ä»¶åˆ¤æ–­
ï¼ˆ1ï¼‰if else
å…ˆçœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼š

import React from 'react'
import './style.css'

class ConditionDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
theme: 'black'
}
}
render() {
const blackBtn = <button className="btn-black">black btn</button>
const whiteBtn = <button className="btn-white">white btn</button>

        // if else
        if (this.state.theme === 'black') {
            return blackBtn
        } else {
            return whiteBtn
        }
    }

}

export default ConditionDemo

style.css çš„ä»£ç å¦‚ä¸‹ï¼š

.title {
font-size: 30px;
color: red;
}

.btn-white {
color: #333;
}
.btn-black {
background-color: #666;
color: #fff;;
}

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå½“æˆ‘ä»¬ theme è®¾ç½®ä¸º black æ—¶ï¼Œæœ€ç»ˆæ˜¾ç¤ºçš„æ•ˆæœå°±æ˜¯é»‘è‰²ã€‚å¦‚æœæˆ‘ä»¬æŠŠ theme è®¾ç½®ä¸ºå…¶ä»–çŠ¶æ€ï¼Œé‚£ä¹ˆæœ€ç»ˆæ˜¾ç¤ºçš„æ•ˆæœå°±æ˜¯ç™½è‰²ã€‚

ï¼ˆ2ï¼‰ä¸‰å…ƒè¡¨è¾¾å¼
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'
import './style.css'

class ConditionDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
theme: 'black'
}
}
render() {

        const blackBtn = <button className="btn-black">black btn</button>
        const whiteBtn = <button className="btn-white">white btn</button>

        // ä¸‰å…ƒè¿ç®—ç¬¦
        return <div>
             { this.state.theme === 'black' ? blackBtn : whiteBtn }
        </div>
    }

}

export default ConditionDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

ä¸‰å…ƒè¡¨è¾¾å¼

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ä¸‰å…ƒè¡¨è¾¾å¼ this.state.theme === 'black' ? blackBtn : whiteBtn çš„æ–¹å¼æ¥å¯¹ä¸€äº›æ¡ä»¶è¿›è¡Œåˆ¤æ–­ã€‚

ï¼ˆ3ï¼‰é€»è¾‘è¿ç®—ç¬¦ && ||
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'
import './style.css'

class ConditionDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
theme: 'black'
}
}
render() {

        const blackBtn = <button className="btn-black">black btn</button>
        const whiteBtn = <button className="btn-white">white btn</button>

        // &&
        return <div>
            { this.state.theme === 'black' && blackBtn }
        </div>
    }

}

export default ConditionDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºç»“æœä¹Ÿæ˜¯å’Œä¸Šè¿°ä¸€æ ·çš„ã€‚å…·ä½“å¦‚ä¸‹ï¼š

é€»è¾‘è¿ç®—ç¬¦

this.state.theme === 'black' && blackBtn è¿™å¥è¯çš„æ„æ€ä¸ºï¼Œå¦‚æœ this.state.theme çš„å€¼ä¸º black æ—¶ï¼Œé‚£ä¹ˆè¿”å› backBtn çš„ç»“æœã€‚

3ã€æ¸²æŸ“åˆ—è¡¨
ï¼ˆ1ï¼‰map å’Œ key
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class ListDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
list: [
{
id: 'id-1',
title: 'æ ‡é¢˜ 1'
},
{
id: 'id-2',
title: 'æ ‡é¢˜ 2'
},
{
id: 'id-3',
title: 'æ ‡é¢˜ 3'
}
]
}
}
render() {
return <ul>
{ /_ ç±»ä¼¼äº vue ä¸­çš„ v-for _/
this.state.list.map(
(item, index) => {
// è¿™é‡Œçš„ key å’Œ Vue çš„ key ç±»ä¼¼ï¼Œå¿…å¡«ï¼Œä¸èƒ½æ˜¯ index æˆ– random
return <li key={item.id}>
index {index}; id {item.id}; title {item.title}
</li>
}
)
}
</ul>
}
}

export default ListDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

æ¸²æŸ“åˆ—è¡¨

åœ¨ react ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ list.map æ¥æ¸²æŸ“åˆ—è¡¨ã€‚å…¶ä¸­ï¼Œ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ list.map() æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ç°åœ¨æˆ‘ä»¬å‡è®¾è¿™ä¸ªå‡½æ•°é‡Œé¢è¦éµå¾ªä¸€å¥—è§„åˆ™ list.map( item => item.id ) ã€‚

è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬è§† .map ä¸ºä¸€ä¸ªæ•°ç»„çš„é‡ç»„ï¼Œé‚£ä¹ˆé‡ç»„çš„è§„åˆ™å°±æ˜¯ item => item.id ã€‚åŒæ—¶ï¼Œ list.map è¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚

4ã€React çš„äº‹ä»¶
ï¼ˆ1ï¼‰bind this
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class EventDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'zhangsan'
}

        // ä¿®æ”¹æ–¹æ³•çš„ this æŒ‡å‘
        // ä½¿ç”¨è¿™ä¸ªå†™æ³•ï¼Œç»„ä»¶åˆå§‹åŒ–æ—¶ï¼Œåªæ‰§è¡Œä¸€æ¬¡bind
        this.clickHandler1 = this.clickHandler1.bind(this)
    }
    render() {
        // this - ä½¿ç”¨ bind
        return <p onClick={this.clickHandler1}>
            {this.state.name}
        </p>
    }
    clickHandler1() {
        // console.log('this....', this) // this é»˜è®¤æ˜¯ undefined
        this.setState({
            name: 'lisi'
        })
    }

}

export default EventDemo

æœ€ç»ˆæµè§ˆå™¨æ˜¾ç¤ºçš„æ•ˆæœä¸ºï¼š

bind this(1

åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ this.clickHandler1 = this.clickHandler1.bind(this) æ¥å¯¹ clickHandler1 è¿›è¡Œç»‘å®šã€‚

è¿˜æœ‰å¦å¤–ä¸€ç§å…³äº this çš„ç»‘å®šæ–¹æ³•ã€‚å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class EventDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'zhangsan'
}
}
render() {
// this - ä½¿ç”¨é™æ€æ–¹æ³•
return <p onClick={this.clickHandler2}>
clickHandler2 {this.state.name}
</p>
}
// é™æ€æ–¹æ³•ï¼Œthis æŒ‡å‘å½“å‰å®ä¾‹
clickHandler2 = () => {
this.setState({
name: 'lisi'
})
}
}

export default EventDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

bind this

å¯¹äºä¸Šé¢çš„è¿™ç§æ–¹å¼æ¥è¯´ï¼Œ clickHandler2 æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œæ­¤æ—¶å®ƒçš„ this ä¼šæŒ‡å‘å½“å‰çš„å®ä¾‹ã€‚

ï¼ˆ2ï¼‰å…³äº event å‚æ•°
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class EventDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'zhangsan'
}
}
render() {
// event
return <a href="https://imooc.com/" onClick={this.clickHandler3}>
click me
</a>
}
// è·å– event ï¼ˆé‡ç‚¹ï¼‰
clickHandler3 = (event) => {
event.preventDefault() // é˜»æ­¢é»˜è®¤è¡Œä¸º
event.stopPropagation() // é˜»æ­¢å†’æ³¡
console.log('target', event.target) // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
console.log('current target', event.currentTarget) // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå‡è±¡ï¼ï¼ï¼

        // æ³¨æ„ï¼Œevent å…¶å®æ˜¯ React å°è£…çš„ã€‚å¯ä»¥æŠŠ __proto__.constructor çœ‹æˆæ˜¯ SyntheticEvent ç»„åˆäº‹ä»¶
        console.log('event', event) // ä¸æ˜¯åŸç”Ÿçš„ Event ï¼ŒåŸç”Ÿçš„æ˜¯ MouseEvent
        console.log('event.__proto__.constructor', event.__proto__.constructor)

        // åŸç”Ÿ event å¦‚ä¸‹ã€‚å…¶ __proto__.constructor æ˜¯ MouseEvent
        console.log('nativeEvent', event.nativeEvent)
        console.log('nativeEvent target', event.nativeEvent.target)  // æŒ‡å‘å½“å‰å…ƒç´ ï¼Œå³å½“å‰å…ƒç´ è§¦å‘
        console.log('nativeEvent current target', event.nativeEvent.currentTarget) // æŒ‡å‘ document ï¼ï¼ï¼

    }

}

export default EventDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

event

ä¾æ®ä»¥ä¸Šå†…å®¹ï¼Œéœ€è¦æ³¨æ„çš„ç‚¹æ˜¯ï¼š

event æ˜¯åˆæˆäº‹ä»¶ SyntheticEvent ï¼Œå®ƒèƒ½å¤Ÿæ¨¡æ‹Ÿå‡ºæ¥ DOM äº‹ä»¶æ‰€æœ‰çš„èƒ½åŠ›ï¼›
event æ˜¯ React å°è£…å‡ºæ¥çš„ï¼Œè€Œ event.nativeEvent æ˜¯åŸç”Ÿäº‹ä»¶å¯¹è±¡ï¼›
æ‰€æœ‰çš„äº‹ä»¶ï¼Œéƒ½ä¼šè¢«æŒ‚è½½åˆ° document ä¸Šï¼›
React ä¸­çš„äº‹ä»¶ï¼Œå’Œ DOM äº‹ä»¶ä¸ä¸€æ ·ï¼Œå’Œ Vue äº‹ä»¶ä¹Ÿä¸ä¸€æ ·ã€‚
ï¼ˆ3ï¼‰ä¼ é€’è‡ªå®šä¹‰å‚æ•°
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class EventDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'zhangsan',
list: [
{
id: 'id-1',
title: 'æ ‡é¢˜ 1'
},
{
id: 'id-2',
title: 'æ ‡é¢˜ 2'
},
{
id: 'id-3',
title: 'æ ‡é¢˜ 3'
}
]
}
}
render() {
// ä¼ é€’å‚æ•° - ç”¨ bind(this, a, b)
return <ul>{this.state.list.map((item, index) => {
return <li key={item.id} onClick={this.clickHandler4.bind(this, item.id, item.title)}>
index {index}; title {item.title}
</li>
})}</ul>
}
// ä¼ é€’å‚æ•°
clickHandler4(id, title, event) {
console.log(id, title)
console.log('event', event) // æœ€åè¿½åŠ ä¸€ä¸ªå‚æ•°ï¼Œå³å¯æ¥æ”¶ event
}
}

export default EventDemo

æ­¤æ—¶ï¼Œæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

ä¼ é€’å‚æ•°

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡ä½¿ç”¨ this.clickHandler4.bind(this, item.id, item.title) è¿™ç§å½¢å¼æ¥å¯¹ react ä¸­çš„äº‹ä»¶è¿›è¡Œå‚æ•°ä¼ é€’ã€‚

ï¼ˆ4ï¼‰æ³¨æ„ç‚¹
React 16 å°†äº‹ä»¶ç»‘å®šåˆ° document ä¸Šï¼›
React 17 å°†äº‹ä»¶ç»‘å®šåˆ° root ç»„ä»¶ä¸Šï¼›
è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼šæœ‰åˆ©äºå¤šä¸ª React ç‰ˆæœ¬å¹¶å­˜ï¼Œä¾‹å¦‚å¾®å‰ç«¯ã€‚
å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

react16 å’Œ 17 ä¸­äº‹ä»¶çš„ä¸åŒ

5ã€è¡¨å•
ï¼ˆ1ï¼‰å—æ§ç»„ä»¶
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class FormDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
info: 'ä¸ªäººä¿¡æ¯',
city: 'GuangDong',
flag: true,
gender: 'female'
}
}
render() {

        // å—æ§ç»„ä»¶
        return <div>
            <p>{this.state.name}</p>
            <label htmlFor="inputName">å§“åï¼š</label> {/* ç”¨ htmlFor ä»£æ›¿ for */}
            <input id="inputName" value={this.state.name} onChange={this.onInputChange}/>
        </div>
    }
    onInputChange = (e) => {
        this.setState({
            name: e.target.value
        })
    }

}

export default FormDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

åœ¨ react ä¸­ï¼Œé€šè¿‡ä½¿ç”¨ onChange äº‹ä»¶æ¥æ‰‹åŠ¨ä¿®æ”¹ state é‡Œé¢çš„å€¼ã€‚

ï¼ˆ2ï¼‰input textarea select ç”¨ value
ä¸Šé¢æˆ‘ä»¬å·²ç»è®²è§£äº† input ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ textarea å’Œ select ã€‚

å…ˆæ¥çœ‹ textarea ç›¸å…³çš„ä»£ç ï¼š

import React from 'react'

class FormDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
info: 'ä¸ªäººä¿¡æ¯',
city: 'GuangDong',
flag: true,
gender: 'female'
}
}
render() {

        // textarea - ä½¿ç”¨ value
        return <div>
            <textarea value={this.state.info} onChange={this.onTextareaChange}/>
            <p>{this.state.info}</p>
        </div>
    }
    onTextareaChange = (e) => {
        this.setState({
            info: e.target.value
        })
    }

}

export default FormDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ‰“å°æ•ˆæœæ˜¯ï¼š

textarea

åŒæ ·åœ°ï¼Œ textarea ä¹Ÿæ˜¯ç”¨ value å’Œ onChange æ¥å¯¹å€¼è¿›è¡Œç»‘å®šã€‚

ç»§ç»­æ¥çœ‹ select ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'

class FormDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
info: 'ä¸ªäººä¿¡æ¯',
city: 'GuangDong',
flag: true,
gender: 'female'
}
}
render() {

        // textarea - ä½¿ç”¨ value
        return <div>
            <textarea value={this.state.info} onChange={this.onTextareaChange}/>
            <p>{this.state.info}</p>
        </div>
    }
    onSelectChange = (e) => {
        this.setState({
            city: e.target.value
        })
    }

}

export default FormDemo

æ­¤æ—¶ï¼Œæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

select

ä¸ input å’Œ textarea ä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡æ“ä½œ value å’Œ onChange ï¼Œæ¥æ”¹å˜æœ€ç»ˆçš„å€¼ã€‚

ï¼ˆ3ï¼‰checkbox radio ç”¨ checked
å…ˆæ¥çœ‹ ckeckbox ã€‚ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'

class FormDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
info: 'ä¸ªäººä¿¡æ¯',
city: 'GuangDong',
flag: true,
gender: 'female'
}
}
render() {

        // checkbox
        return <div>
            <input type="checkbox" checked={this.state.flag} onChange={this.onCheckboxChange}/>
            <p>{this.state.flag.toString()}</p>
        </div>
    }
    onCheckboxChange = () => {
        this.setState({
            flag: !this.state.flag
        })
    }

}

export default FormDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

checkbox

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ checkbox é€šè¿‡æ“ä½œ checked å’Œ onChange ï¼Œæ¥æ”¹å˜ state çš„å€¼ã€‚

radio ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

class FormDemo extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
info: 'ä¸ªäººä¿¡æ¯',
city: 'GuangDong',
flag: true,
gender: 'female'
}
}
render() {

        // radio
        return <div>
            male <input type="radio" name="gender" value="male" checked={this.state.gender === 'male'} onChange={this.onRadioChange}/>
            female <input type="radio" name="gender" value="female" checked={this.state.gender === 'female'} onChange={this.onRadioChange}/>
            <p>{this.state.gender}</p>
        </div>
    }
    onRadioChange = (e) => {
        this.setState({
            gender: e.target.value
        })
    }

}

export default FormDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœæ˜¯ï¼š

radio

6ã€ç»„ä»¶ä½¿ç”¨
å¯¹äºçˆ¶å­ç»„ä»¶çš„ä½¿ç”¨æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç™½ä¸‰ä¸ªçŸ¥è¯†ç‚¹ï¼šprops ä¼ é€’æ•°æ®ã€props ä¼ é€’å‡½æ•°å’Œ props ç±»å‹æ£€æŸ¥ã€‚

å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'
import PropTypes from 'prop-types'

class Input extends React.Component {
constructor(props) {
super(props)
this.state = {
title: ''
}
}
render() {
return <div>
<input value={this.state.title} onChange={this.onTitleChange}/>
<button onClick={this.onSubmit}>æäº¤</button>
</div>
}
onTitleChange = (e) => {
this.setState({
title: e.target.value
})
}
onSubmit = () => {
const { submitTitle } = this.props
submitTitle(this.state.title)

        this.setState({
            title: ''
        })
    }

}
// props ç±»å‹æ£€æŸ¥
Input.propTypes = {
submitTitle: PropTypes.func.isRequired
}

class List extends React.Component {
constructor(props) {
super(props)
}
render() {
const { list } = this.props

        return <ul>{list.map((item, index) => {
            return <li key={item.id}>
                <span>{item.title}</span>
            </li>
        })}</ul>
    }

}
// props ç±»å‹æ£€æŸ¥
// é€šè¿‡ propTypes å¯ä»¥æ¸…æ¥šåœ°çŸ¥é“ list éœ€è¦ä¸€ä¸ªä»€ä¹ˆç±»å‹çš„æ•°æ®
List.propTypes = {
list: PropTypes.arrayOf(PropTypes.object).isRequired
}

class Footer extends React.Component {
constructor(props) {
super(props)
}
render() {
return <p>
{this.props.text}
{this.props.length}
</p>
}
componentDidUpdate() {
console.log('footer did update')
}
shouldComponentUpdate(nextProps, nextState) {
if (nextProps.text !== this.props.text
|| nextProps.length !== this.props.length) {
return true // å¯ä»¥æ¸²æŸ“
}
return false // ä¸é‡å¤æ¸²æŸ“
}

    // React é»˜è®¤ï¼šçˆ¶ç»„ä»¶æœ‰æ›´æ–°ï¼Œå­ç»„ä»¶åˆ™æ— æ¡ä»¶ä¹Ÿæ›´æ–°ï¼ï¼ï¼
    // æ€§èƒ½ä¼˜åŒ–å¯¹äº React æ›´åŠ é‡è¦ï¼
    // SCU ä¸€å®šè¦æ¯æ¬¡éƒ½ç”¨å—ï¼Ÿâ€”â€” éœ€è¦çš„æ—¶å€™æ‰ä¼˜åŒ–ï¼ˆSCUå³shouldComponentUpdateï¼‰

}

// çˆ¶ç»„ä»¶
class TodoListDemo extends React.Component {
constructor(props) {
super(props)
// çŠ¶æ€ï¼ˆæ•°æ®ï¼‰æå‡
// list çš„æ•°æ®éœ€è¦æ”¾åœ¨çˆ¶ç»„ä»¶
this.state = {
list: [
{
id: 'id-1',
title: 'æ ‡é¢˜ 1'
},
{
id: 'id-2',
title: 'æ ‡é¢˜ 2'
},
{
id: 'id-3',
title: 'æ ‡é¢˜ 3'
}
],
footerInfo: 'åº•éƒ¨æ–‡å­—'
}
}
render() {
return <div>
<Input submitTitle={this.onSubmitTitle}/>
<List list={this.state.list}/>
<Footer text={this.state.footerInfo} length={this.state.list.length}/>
</div>
}
onSubmitTitle = (title) => {
this.setState({
list: this.state.list.concat({
id: `id-${Date.now()}`,
title
})
})
}
}

export default TodoListDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

ç»„ä»¶ä½¿ç”¨-props

ä¾æ®ä»¥ä¸Šä»£ç ï¼Œæˆ‘ä»¬æ¥å¯¹ props çš„å„ä¸ªç±»å‹è¿›è¡Œä»‹ç»ã€‚

ï¼ˆ1ï¼‰props ä¼ é€’æ•°æ®
æœ€åä¸€ä¸ª TodoListDemo æ˜¯çˆ¶ç»„ä»¶ï¼Œå…¶ä»–éƒ½æ˜¯å­ç»„ä»¶ã€‚åœ¨ Input ç»„ä»¶å’Œ List ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å°† props å±æ€§çš„å†…å®¹ï¼Œä»¥ this.props.xxx çš„æ–¹å¼ï¼Œä¼ é€’ç»™çˆ¶ç»„ä»¶ã€‚

ï¼ˆ2ï¼‰props ä¼ é€’å‡½æ•°
React åœ¨ä¼ é€’å‡½æ•°è¿™ä¸€éƒ¨åˆ†å’Œ vue æ˜¯ä¸ä¸€æ ·çš„ã€‚å¯¹äº vue æ¥è¯´ï¼Œå¦‚æœæœ‰ä¸€ä¸ªçˆ¶ç»„ä»¶è¦ä¼ é€’å‡½æ•°ç»™å­ç»„ä»¶ï¼Œå­ç»„ä»¶å¦‚æœæƒ³è¦è§¦å‘è¿™ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨äº‹ä»¶ä¼ é€’å’Œ $emit çš„æ–¹å¼æ¥è§£å†³ã€‚

å¤§å®¶å®šä½åˆ° Input ç»„ä»¶ä¸­ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å°† submitTitle ä»¥å‡½æ•°çš„å½¢å¼ï¼Œä¼ é€’ç»™çˆ¶ç»„ä»¶ä¸­çš„ onSubmitTitle ã€‚

ï¼ˆ3ï¼‰props ç±»å‹æ£€æŸ¥
å¤§å®¶å®šä½åˆ°ä¸¤å¤„ props ç±»å‹æ£€æŸ¥çš„åœ°æ–¹ã€‚ä½¿ç”¨ react ä¸­çš„ PropTypes ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å½“å‰æ‰€ä½¿ç”¨çš„å±æ€§è¿›è¡Œä¸€ä¸ªç±»å‹æ£€æŸ¥ã€‚æ¯”å¦‚è¯´ï¼š submitTitle: PropTypes.func.isRequired è¡¨æ˜çš„æ˜¯ï¼Œ submitTitle æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”æ˜¯ä¸€ä¸ªå¿…å¡«é¡¹ã€‚

å°±è¿™æ ·ï¼Œé€šè¿‡ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å­¦ä¹ äº†å±æ€§ä¼ é€’ã€å±æ€§éªŒè¯ä»¥åŠçˆ¶ç»„ä»¶å’Œå­ç»„ä»¶ä¹‹é—´æ€ä¹ˆé€šè¿‡ä¼ äº‹ä»¶çš„å½¢å¼æ¥è¿›è¡Œé€šä¿¡ã€‚

7ã€setState
ï¼ˆ1ï¼‰ä¸å¯å˜å€¼
æ‰€è°“ä¸å¯å˜å€¼ï¼Œå³æ‰€è®¾ç½®çš„å€¼æ°¸ä¸æ”¹å˜ã€‚é‚£è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦å»åˆ›å»ºä¸€ä¸ªå‰¯æœ¬ï¼Œæ¥è®¾ç½® state çš„å€¼ã€‚

æ¥çœ‹å‡ ä¸ªè¦ç‚¹ï¼š

ç¬¬ä¸€ç‚¹ï¼šstate è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

// å‡½æ•°ç»„ä»¶ï¼Œé»˜è®¤æ²¡æœ‰ state
class StateDemo extends React.Component {
constructor(props) {
super(props)

        // ç¬¬ä¸€ï¼Œstate è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰
        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        </div>
    }

}

export default StateDemo

ç¬¬äºŒç‚¹ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ state ï¼Œè¦ä½¿ç”¨ä¸å¯å˜å€¼ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

// å‡½æ•°ç»„ä»¶ï¼Œé»˜è®¤æ²¡æœ‰ state
class StateDemo extends React.Component {
constructor(props) {
super(props)

        // ç¬¬ä¸€ï¼Œstate è¦åœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰
        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    increase= () => {
        // ç¬¬äºŒï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ stateï¼Œä½¿ç”¨ä¸å¯å˜å€¼
        // this.state.count++ // é”™è¯¯å†™æ³•ï¼Œä¼šç›´æ¥ä¿®æ”¹åŸæ¥çš„å€¼
        this.setState({
            count: this.state.count + 1 // ShouldComponentUpdate â†’ SCU
        })
    }

}

export default StateDemo

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ this.state({}) è¿™ç§å½¢å¼ï¼Œæ¥ä¿®æ”¹ state çš„å€¼ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¾ˆå¤šå°ä¼™ä¼´ä¼šç›´æ¥ä½¿ç”¨ this.state.count++ æ¥ä¿®æ”¹ state çš„å€¼ï¼Œè¿™åœ¨ react ä¸­æ˜¯éå¸¸ä¸å…è®¸çš„ã€‚å› æ­¤ï¼Œè¦æ³¨æ„è¿™ä¸ªè¦ç‚¹ã€‚

ç¬¬ä¸‰ç‚¹ï¼Œåœ¨ react ä¸­æ“ä½œæ•°ç»„çš„å€¼ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

// ä¸å¯å˜å€¼ï¼ˆå‡½æ•°å¼ç¼–ç¨‹ï¼Œçº¯å‡½æ•°ï¼‰ - æ•°ç»„
const list5Copy = this.state.list5.slice()
list5Copy.splice(2, 0, 'a') // ä¸­é—´æ’å…¥/åˆ é™¤
this.setState({
list1: this.state.list1.concat(100), // è¿½åŠ 
list2: [...this.state.list2, 100], // è¿½åŠ 
list3: this.state.list3.slice(0, 3), // æˆªå–
list4: this.state.list4.filter(item => item > 100), // ç­›é€‰
list5: list5Copy // å…¶ä»–æ“ä½œ
})
// æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.list è¿›è¡Œ push pop splice ç­‰ï¼Œè¿™æ ·è¿åä¸å¯å˜å€¼
ç¬¬å››ç‚¹ï¼Œåœ¨ react ä¸­æ“ä½œå¯¹è±¡çš„å€¼ã€‚å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

// ä¸å¯å˜å€¼ - å¯¹è±¡
this.setState({
obj1: Object.assign({}, this.state.obj1, {a: 100}),
obj2: {...this.state.obj2, a: 100}
})
// æ³¨æ„ï¼Œä¸èƒ½ç›´æ¥å¯¹ this.state.obj è¿›è¡Œå±æ€§è®¾ç½®ï¼Œå³ this.state.obj.xxx è¿™æ ·çš„å½¢å¼ï¼Œè¿™ç§å½¢å¼ä¼šè¿åä¸å¯å˜å€¼
ï¼ˆ2ï¼‰å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°
react ä¸­çš„ state ï¼Œæœ‰å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°ã€‚æ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class StateDemo extends React.Component {
constructor(props) {
super(props)

        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    increase= () => {
        // setState å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°ï¼ˆä¹Ÿæœ‰å¯èƒ½æ˜¯åŒæ­¥æ›´æ–°ï¼‰
        this.setState({
            count: this.state.count + 1
        }, () => {
            // è”æƒ³ Vue $nextTick - DOM
            console.log('count by callback', this.state.count) // å›è°ƒå‡½æ•°ä¸­å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„ state
        })
        console.log('count', this.state.count) // å¼‚æ­¥çš„ï¼Œæ‹¿ä¸åˆ°æœ€æ–°å€¼
    }

}

export default StateDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

å¼‚æ­¥æ›´æ–° â‘ 

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œthis.state å‰åŠéƒ¨åˆ†å¹¶ä¸èƒ½åŒä¸€æ—¶é—´å¾—åˆ°æ›´æ–°ï¼Œæ‰€ä»¥å®ƒæ˜¯å¼‚æ­¥æ“ä½œã€‚è€Œåé¢çš„ç®­å¤´å‡½æ•°ä¸­çš„å†…å®¹å¯ä»¥å¾—åˆ°åŒæ­¥æ›´æ–°ï¼Œæ‰€ä»¥åé¢å‡½æ•°çš„éƒ¨åˆ†æ˜¯åŒæ­¥æ“ä½œã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œ setTimeout åœ¨ setState ä¸­æ˜¯åŒæ­¥çš„ã€‚æ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class StateDemo extends React.Component {
constructor(props) {
super(props)

        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    increase= () => {
        // setTimeout ä¸­ setState æ˜¯åŒæ­¥çš„
        setTimeout(() => {
            this.setState({
                count: this.state.count + 1
            })
            console.log('count in setTimeout', this.state.count)
        }, 0)
    }

}

export default StateDemo

æ­¤æ—¶ï¼Œæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

å¼‚æ­¥æ›´æ–° â‘¡

è¿˜æœ‰ä¸€ä¸ªè¦æ³¨æ„çš„ç‚¹æ˜¯ï¼Œå¦‚æœæ˜¯è‡ªå·±å®šä¹‰çš„ DOM äº‹ä»¶ï¼Œé‚£ä¹ˆåœ¨ setState ä¸­æ˜¯åŒæ­¥çš„ï¼Œç”¨åœ¨ componentDidMount ä¸­ã€‚

å¦‚æœæ˜¯é”€æ¯äº‹ä»¶ï¼Œé‚£ä¹ˆç”¨åœ¨ componentWillMount ç”Ÿå‘½å‘¨æœŸä¸­ã€‚ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'

class StateDemo extends React.Component {
constructor(props) {
super(props)

        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    bodyClickHandler = () => {
        this.setState({
            count: this.state.count + 1
        })
        console.log('count in body event', this.state.count)
    }
    componentDidMount() {
        // è‡ªå·±å®šä¹‰çš„ DOM äº‹ä»¶ï¼ŒsetState æ˜¯åŒæ­¥çš„
        document.body.addEventListener('click', this.bodyClickHandler)
    }
    componentWillUnmount() {
        // åŠæ—¶é”€æ¯è‡ªå®šä¹‰ DOM äº‹ä»¶
        document.body.removeEventListener('click', this.bodyClickHandler)
        // clearTimeout
    }

}

export default StateDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

å¼‚æ­¥æ›´æ–° â‘¢

ï¼ˆ3ï¼‰å¯èƒ½ä¼šè¢«åˆå¹¶
setState åœ¨ä¼ å…¥å¯¹è±¡æ—¶ï¼Œæ›´æ–°å‰ä¼šè¢«åˆå¹¶ã€‚æ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class StateDemo extends React.Component {
constructor(props) {
super(props)

        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    increase= () => {
        // ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶ï¼ˆç±»ä¼¼ Object.assign ï¼‰ã€‚æ‰§è¡Œç»“æœåªä¸€æ¬¡ +1
        this.setState({
            count: this.state.count + 1
        })
        this.setState({
            count: this.state.count + 1
        })
        this.setState({
            count: this.state.count + 1
        })
    }

}

export default StateDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

ä¼ å…¥å¯¹è±¡ï¼Œä¼šè¢«åˆå¹¶

æœ‰å°ä¼™ä¼´å¯èƒ½ä¼šè§‰å¾—ï¼Œä¸€ä¸‹å­å¤šä¸ªä¸‰ä¸ª setState ï¼Œé‚£ç»“æœåº”è¯¥æ˜¯ +3 æ‰æ˜¯ã€‚ä½†å…¶å®ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯å¯¹è±¡ï¼Œé‚£ä¹ˆç»“æœä¼šæŠŠä¸‰ä¸ªåˆå¹¶ä¸ºä¸€ä¸ªï¼Œæœ€ç»ˆåªæ‰§è¡Œä¸€æ¬¡ã€‚

è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µï¼Œå¦‚æœä¼ å…¥çš„æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆç»“æœä¸ä¼šè¢«åˆå¹¶ã€‚æ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class StateDemo extends React.Component {
constructor(props) {
super(props)

        this.state = {
            count: 0
        }
    }
    render() {
        return <div>
            <p>{this.state.count}</p>
        	<button onClick={this.increase}>ç´¯åŠ </button>
        </div>
    }
    increase= () => {
        // ä¼ å…¥å‡½æ•°ï¼Œä¸ä¼šè¢«åˆå¹¶ã€‚æ‰§è¡Œç»“æœæ˜¯ +3
        this.setState((prevState, props) => {
            return {
                count: prevState.count + 1
            }
        })
        this.setState((prevState, props) => {
            return {
                count: prevState.count + 1
            }
        })
        this.setState((prevState, props) => {
            return {
                count: prevState.count + 1
            }
        })
    }

}

export default StateDemo

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

ä¼ å…¥å‡½æ•°ï¼Œç»“æœä¸ä¼šè¢«åˆå¹¶

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¼ å…¥çš„æ˜¯å‡½æ•°ï¼Œé‚£ä¹ˆç»“æœä¸€ä¸‹å­å°±æ‰§è¡Œä¸‰æ¬¡äº†ã€‚

8ã€ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
react çš„ç»„ä»¶ç”Ÿå‘½å‘¨æœŸï¼Œæœ‰å•ç»„ä»¶å£°æ˜å‘¨æœŸå’Œçˆ¶å­ç»„ä»¶å£°æ˜å‘¨æœŸã€‚å…¶ä¸­ï¼Œçˆ¶å­ç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸ Vue ç±»ä¼¼ã€‚

è¿™é‡Œé™„ä¸Šä¸€ä¸ªç”Ÿå‘½å‘¨æœŸç›¸å…³çš„ç½‘ç«™ï¼šhttps://projects.wojtekmaj.pl/react-lifecycle-methods-diagram/

ä¸‹é¢é™„ä¸Šç”Ÿå‘½å‘¨æœŸçš„å›¾ï¼š

react çš„ç”Ÿå‘½å‘¨æœŸ

ğŸ“– äºŒã€React é«˜çº§ç‰¹æ€§
1ã€å‡½æ•°ç»„ä»¶
æˆ‘ä»¬å…ˆæ¥äº†è§£ class ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶åˆ†åˆ«æ˜¯ä»€ä¹ˆæ ·çš„ã€‚å…ˆçœ‹ class ç»„ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š

// class ç»„ä»¶
class List extends React.Component {
constructor(props) {
super(props)
}
redner() {
const { list } = this.props

        return <ul>{list.map((item, index) => {
            return <li key={item.id}>
                	<span>{item.title}</span>
                </li>
        })}</ul>
    }

}
å‡½æ•°ç»„ä»¶çš„å½¢å¼å¦‚ä¸‹ï¼š

// å‡½æ•°ç»„ä»¶
function List(props) {
const { list } = this.props

    return <ul>{list.map((item, idnex) => {
        return <li key={item.id}>
            	<span>{item.title}</span>
            </li>
    })}</ul>

}
ç°åœ¨æˆ‘ä»¬æ¥æ¢³ç†ä»¥ä¸‹ï¼Œ class ç»„ä»¶å’Œå‡½æ•°ç»„ä»¶ä¸¤è€…ä¹‹é—´çš„åŒºåˆ«ã€‚æ‰€è°“å‡½æ•°ç»„ä»¶ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

åªæ˜¯ä¸€ä¸ªçº¯å‡½æ•°ï¼Œå®ƒè¾“å…¥çš„æ˜¯ props ï¼Œè¾“å‡ºçš„æ˜¯ JSX ï¼›
å‡½æ•°ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œæ²¡æœ‰ç”Ÿå‘½å‘¨æœŸï¼Œä¹Ÿæ²¡æœ‰ state ï¼›
å‡½æ•°ç»„ä»¶ä¸èƒ½æ‰©å±•å…¶ä»–æ–¹æ³•ã€‚
ç›¸ååœ°ï¼Œ class ç»„ä»¶å°±æ‹¥æœ‰å‡½æ•°ç»„ä»¶ç›¸å¼‚çš„ç‰¹ç‚¹ã€‚

2ã€éå—æ§ç»„ä»¶
åœ¨ä¸Šè¿°è¡¨å•æ¨¡å—ï¼Œæˆ‘ä»¬è°ˆè®ºåˆ°äº†å—æ§ç»„ä»¶ï¼Œé‚£æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°±æ¥è°ˆè®ºéå—æ§ç»„ä»¶ã€‚

æ‰€è°“éå—æ§ç»„ä»¶ï¼Œå°±æ˜¯ input é‡Œé¢çš„å€¼ï¼Œä¸å—åˆ° state çš„æ§åˆ¶ã€‚ä¸‹é¢æˆ‘ä»¬å…ˆæ¥çœ‹å‡ ç§åœºæ™¯ã€‚

ï¼ˆ1ï¼‰input
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class App extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
flag: true,
}
this.nameInputRef = React.createRef() // åˆ›å»º ref
}
render() {
// input defaultValue
return <div>
{/_ ä½¿ç”¨ defaultValue è€Œä¸æ˜¯ value ï¼Œä½¿ç”¨ ref _/}
<input defaultValue={this.state.name} ref={this.nameInputRef}/>
{/_ state å¹¶ä¸ä¼šéšç€æ”¹å˜ _/}
<span>state.name: {this.state.name}</span>
<br/>
<button onClick={this.alertName}>alert name</button>
</div>

    }
    alertName = () => {
        const elem = this.nameInputRef.current // é€šè¿‡ ref è·å– DOM èŠ‚ç‚¹
        alert(elem.value) // ä¸æ˜¯ this.state.name
    }

}

export default App

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

inputValue

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœæ˜¯éå—æ§ç»„ä»¶ï¼Œé‚£ä¹ˆéœ€è¦ä½¿ç”¨ defaultValue å»æ§åˆ¶ç»„ä»¶çš„å€¼ã€‚ä¸”æœ€ç»ˆ input æ¡†é‡Œé¢çš„å†…å®¹ä¸è®ºæˆ‘ä»¬æ€ä¹ˆæ”¹å˜ï¼Œéƒ½ä¸ä¼šå½±å“åˆ° state çš„å€¼ã€‚

ï¼ˆ2ï¼‰checkbox
å¯¹äºå¤é€‰æ¡† checkbox æ¥è¯´ï¼Œå…ˆçœ‹ä»¥ä¸‹ä»£ç ï¼š

import React from 'react'

class App extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
flag: true,
}
}
render() {
// checkbox defaultChecked
return <div>
<input
                type="checkbox"
                defaultChecked={this.state.flag}
            />
<p>state.name: { this.state.flag === true ? 'true' : 'false' }</p>
</div>
}
}

export default App

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

checkbox

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œå¤é€‰æ¡†å¦‚æœå½“éå—æ§ç»„ä»¶æ¥ä½¿ç”¨çš„ä½¿ç”¨ï¼Œé‚£ä¹ˆä½¿ç”¨ defaultCkecked æ¥å¯¹å€¼è¿›è¡Œæ§åˆ¶ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿçœ‹åˆ°äº†ï¼Œæœ€ç»ˆä¸ç®¡ checked çš„å€¼å¦‚ä½•æ”¹å˜ï¼Œ state çš„å€¼éƒ½ä¸å—å½±å“ã€‚

ï¼ˆ3ï¼‰file
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

class App extends React.Component {
constructor(props) {
super(props)
this.state = {
name: 'æ˜ŸæœŸä¸€ç ”ç©¶å®¤',
flag: true,
}
this.fileInputRef = React.createRef()
}
render() {
// file
return <div>
<input type="file" ref={this.fileInputRef}/>
<button onClick={this.alertFile}>alert file</button>
</div>
}
alertFile = () => {
const elem = this.fileInputRef.current // é€šè¿‡ ref è·å– DOM èŠ‚ç‚¹
alert(elem.files[0].name)
}
}

export default App

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

file

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨é€šè¿‡ ref å»è·å– DOM èŠ‚ç‚¹ï¼Œæ¥ç€å»è·å–åˆ°æ–‡ä»¶çš„åå­—ã€‚åƒ file è¿™ç§ç±»å‹çš„å›ºå®šï¼Œå€¼å¹¶ä¸ä¼šä¸€ç›´å›ºå®šçš„ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯ä¸€ä¸ªéå—æ§ç»„ä»¶ã€‚

ï¼ˆ4ï¼‰æ€»ç»“æ¢³ç†
setState åªèƒ½å¤„ç†ç±»ä¼¼äºå‰ç«¯çš„æ˜¾ç¤ºå’Œæ¸²æŸ“ç›¸å…³çš„ï¼Œåƒæ–‡ä»¶ä¸Šä¼ è¿™ç§äº¤äº’ç±»å‹çš„å°±å¤„ç†ä¸äº†ã€‚ä¸‹é¢æˆ‘ä»¬æ¥æ¢³ç†ä¸‹éå—æ§ç»„ä»¶çš„å‡ å¤§ä½¿ç”¨åœºæ™¯ã€‚å…·ä½“å¦‚ä¸‹ï¼š

å¿…é¡»æ‰‹åŠ¨æ“ä½œ DOM å…ƒç´ ï¼Œ setState å¹¶æ— æ³•æ‰‹åŠ¨æ“ä½œ DOM å…ƒç´ ï¼›
æ–‡ä»¶ä¸Šä¼ ç±»å‹ <input type=file> ï¼›
æŸäº›å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œéœ€è¦ä¼ å…¥ DOM å…ƒç´ ã€‚
å—æ§ç»„ä»¶ vs éå—æ§ç»„ä»¶çš„åŒºåˆ«å¦‚ä¸‹ï¼š

ä¼˜å…ˆä½¿ç”¨å—æ§ç»„ä»¶ï¼Œç¬¦åˆ React è®¾è®¡åŸåˆ™ï¼›
å¿…é¡»æ“ä½œ DOM æ—¶ï¼Œå†ä½¿ç”¨éå—æ§ç»„ä»¶ã€‚
3ã€Protals
ï¼ˆ1ï¼‰ä¸ºä»€ä¹ˆè¦ç”¨ Protals ï¼Ÿ
ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç»„ä»¶é»˜è®¤ä¼šæŒ‰ç…§æ—¢å®šå±‚æ¬¡åµŒå¥—æ¸²æŸ“ã€‚ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š

<div id="root">
    <div>
        <div>
            <div class="model">Modalå†…å®¹</div>
        </div>
    </div>
</div>
å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œè¿™æ ·ä¸æ–­åµŒå¥—ï¼Œä½†é‡Œé¢å´åªæœ‰ä¸€å±‚åŒºåŸŸçš„å†…å®¹æ˜¯æœ‰ç”¨çš„ã€‚ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼Œæ˜¯éå¸¸ä¸å¥½çš„ã€‚é‚£æˆ‘ä»¬æƒ³åšçš„äº‹æƒ…æ˜¯ï¼Œå¦‚ä½•è®©ç»„ä»¶æ¸²æŸ“åˆ°çˆ¶ç»„ä»¶ä»¥å¤–å‘¢ï¼Ÿ

è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ° Protals ã€‚

ï¼ˆ2ï¼‰å¦‚ä½•ä½¿ç”¨
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'
import ReactDOM from 'react-dom'
import './style.css'

class App extends React.Component {
constructor(props) {
super(props)
this.state = {
}
}
render() {
// æ­£å¸¸æ¸²æŸ“
// return <div className="modal">
// {this.props.children} {/_ vue slot _/}
// </div>

        // ä½¿ç”¨ Portals æ¸²æŸ“åˆ° body ä¸Šã€‚
        // fixed å…ƒç´ è¦æ”¾åœ¨ body ä¸Šï¼Œæœ‰æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ã€‚
        return ReactDOM.createPortal(
            <div className="modal">{this.props.children}</div>,
            document.body // DOM èŠ‚ç‚¹
        )
    }

}

export default App

style.css ä»£ç å¦‚ä¸‹ï¼š

.modal {
position: fixed;
width: 300px;
height: 100px;
top: 100px;
left: 50%;
margin-left: -150px;
background-color: #000;
/_ opacity: .2; _/
color: #fff;
text-align: center;
}
æ­¤æ—¶ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æµè§ˆå™¨èŠ‚ç‚¹çš„æ¸²æŸ“æ•ˆæœã€‚å…·ä½“å¦‚ä¸‹ï¼š

Protals

å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨ ReactDOM.createPortal() ï¼Œæ¥åˆ›å»º Portals ã€‚æœ€ç»ˆ modals èŠ‚ç‚¹æˆåŠŸè„±ç¦»å¼€çˆ¶ç»„ä»¶ï¼Œå¹¶æ¸²æŸ“åˆ°ç»„ä»¶å¤–éƒ¨ã€‚

ï¼ˆ3ï¼‰ä½¿ç”¨åœºæ™¯
ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸€äº› Protals å¸¸è§çš„åœºæ™¯ã€‚

protals å¸¸ç”¨äºè§£å†³ä¸€äº› css å…¼å®¹æ€§é—®é¢˜ã€‚é€šå¸¸ä½¿ç”¨åœºæ™¯æœ‰ï¼š

overflow:hidden; è§¦å‘ bfc ï¼›
çˆ¶ç»„ä»¶ z-index å€¼å¤ªå°ï¼›
position:fixed éœ€è¦æ”¾åœ¨ body ç¬¬ä¸€å±‚çº§ã€‚
4ã€context
ï¼ˆ1ï¼‰ä½¿ç”¨åœºæ™¯
æœ‰æ—¶å€™æˆ‘ä»¬ç»å¸¸ä¼šæœ‰ä¸€äº›åœºæ™¯å‡ºç°åˆ‡æ¢çš„é¢‘ç‡å¾ˆé¢‘ç¹ï¼Œæ¯”å¦‚è¯­è¨€åˆ‡æ¢ã€æˆ–è€…æ˜¯ä¸»é¢˜åˆ‡æ¢ï¼Œé‚£å¦‚ä½•æŠŠå¯¹åº”çš„åˆ‡æ¢ä¿¡æ¯ç»™æœ‰æ•ˆåœ°ä¼ é€’ç»™æ¯ä¸ªç»„ä»¶å‘¢ï¼Ÿ

ä½¿ç”¨ props ï¼Œåˆæœ‰ç‚¹ç¹çï¼›ä½¿ç”¨ redux ï¼Œåˆå¤ªå°é¢˜å¤§åšäº†ã€‚

å› æ­¤ï¼Œè¿™ä¸ªéœ€è¦æˆ‘ä»¬å¯ä»¥ç”¨ react ä¸­çš„ context ã€‚

ï¼ˆ2ï¼‰ä¸¾ä¾‹é˜è¿°
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

import React from 'react'

// åˆ›å»º Context å¡«å…¥é»˜è®¤å€¼ï¼ˆä»»ä½•ä¸€ä¸ª js å˜é‡ï¼‰
const ThemeContext = React.createContext('light')

// åº•å±‚ç»„ä»¶ - å‡½æ•°æ˜¯ç»„ä»¶
function ThemeLink (props) {
// const theme = this.context // ä¼šæŠ¥é”™ã€‚å‡½æ•°å¼ç»„ä»¶æ²¡æœ‰å®ä¾‹ï¼Œå³æ²¡æœ‰ this

    // å‡½æ•°å¼ç»„ä»¶å¯ä»¥ä½¿ç”¨ Consumer
    return <ThemeContext.Consumer>
        { value => <p>link's theme is {value}</p> }
    </ThemeContext.Consumer>

}

// åº•å±‚ç»„ä»¶ - class ç»„ä»¶
class ThemedButton extends React.Component {
// æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚
// static contextType = ThemeContext // ä¹Ÿå¯ä»¥ç”¨ ThemedButton.contextType = ThemeContext
render() {
const theme = this.context // React ä¼šå¾€ä¸Šæ‰¾åˆ°æœ€è¿‘çš„ theme Providerï¼Œç„¶åä½¿ç”¨å®ƒçš„å€¼ã€‚
return <div>
<p>button's theme is {theme}</p>
</div>
}
}
ThemedButton.contextType = ThemeContext // æŒ‡å®š contextType è¯»å–å½“å‰çš„ theme contextã€‚

// ä¸­é—´çš„ç»„ä»¶å†ä¹Ÿä¸å¿…æŒ‡æ˜å¾€ä¸‹ä¼ é€’ theme äº†ã€‚
function Toolbar(props) {
return (
<div>
<ThemedButton />
<ThemeLink />
</div>
)
}

class App extends React.Component {
constructor(props) {
super(props)
this.state = {
theme: 'light'
}
}
render() {
return <ThemeContext.Provider value={this.state.theme}>
<Toolbar />
<hr/>
<button onClick={this.changeTheme}>change theme</button>
</ThemeContext.Provider>
}
changeTheme = () => {
this.setState({
theme: this.state.theme === 'light' ? 'dark' : 'light'
})
}
}

export default App

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœä¸ºï¼š

Context

åœ¨ä¸Šå›¾ä¸­ï¼Œæˆ‘ä»¬åšåˆ°äº†ä¸»é¢˜çš„åˆ‡æ¢ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æ¥åˆ†æä¸‹ä¸Šè¿°çš„ä»£ç ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ª Context ï¼Œä¹Ÿå°±æ˜¯ ThemeContext ï¼Œå¹¶ä¼ å…¥äº† light å€¼ã€‚

å…¶æ¬¡ï¼Œæ ¸å¿ƒåœ¨ <Toolbar /> ç»„ä»¶ã€‚ Toolbar ç°æœ‰ç»„ä»¶ä¸º ThemedButton å’Œ ThemeLink ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬å…ˆæŒ‡å®š ThemedButton çš„ contextType å»è¯»å–å½“å‰çš„ ThemeContext ï¼Œé‚£ä¹ˆå°±å–åˆ°äº†é»˜è®¤å€¼ light ã€‚

æ¥ç€ï¼Œæ¥åˆ°äº† ThemeLink ç»„ä»¶ã€‚ ThemeLink æ˜¯ä¸€ä¸ªå‡½æ•°å¼ç»„ä»¶ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨ ThemeContext.Consumer æ¥å¯¹å…¶è¿›è¡Œä¼ å€¼ã€‚

ä¸Šé¢ä¸¤ä¸ªç»„ä»¶çš„å€¼éƒ½å–åˆ°äº†ï¼Œä½†é‚£åªæ˜¯ ThemeContext çš„åˆå§‹å€¼ã€‚å–åˆ°å€¼äº†ä¹‹åå‘¢ï¼Œæˆ‘ä»¬è¿˜è¦ä¿®æ”¹å€¼ï¼Œ React ä¼šå¾€ä¸Šæ‰¾åˆ°æœ€è¿‘çš„ ThemeContext.Provider ï¼Œé€šè¿‡ value={this.state.theme} è¿™ç§æ–¹å¼ï¼Œå»ä¿®æ”¹å’Œä½¿ç”¨ ThemeContext æœ€ç»ˆä½¿ç”¨çš„å€¼ ã€‚

5ã€å¼‚æ­¥ç»„ä»¶ï¼ˆæ‡’åŠ è½½ï¼‰
åœ¨é¡¹ç›®å¼€å‘æ—¶ï¼Œæˆ‘ä»¬æ€»æ˜¯ä¼šä¸å¯é¿å…çš„å»åŠ è½½ä¸€äº›å¤§ç»„ä»¶ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°å¼‚æ­¥åŠ è½½ã€‚åœ¨ vue ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä½¿ç”¨ import() æ¥åŠ è½½å¼‚æ­¥ç»„ä»¶ï¼Œä½†åœ¨ react å°±ä¸è¿™ä¹ˆä½¿ç”¨äº†ã€‚

React é€šå¸¸ä½¿ç”¨ React.lazy å’Œ React.Suspense æ¥åŠ è½½å¤§ç»„ä»¶ã€‚

å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

const ContextDemo = React.lazy(() => import('./ContextDemo'))

class App extends React.Component {
constructor(props) {
super(props)
}
render() {
return <div>
<p>å¼•å…¥ä¸€ä¸ªåŠ¨æ€ç»„ä»¶</p>
<hr />
<React.Suspense fallback={<div>Loading...</div>}>
<ContextDemo/>
</React.Suspense>
</div>

        // 1. å¼ºåˆ¶åˆ·æ–°ï¼Œå¯çœ‹åˆ° loading ï¼ˆçœ‹ä¸åˆ°å°±é™åˆ¶ä¸€ä¸‹ chrome çš„ç½‘é€Ÿï¼ŒPerformanceçš„networkï¼‰
        // 2. çœ‹ network çš„ js åŠ è½½
    }

}

export default App

é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨ import å»å¯¼å…¥æˆ‘ä»¬è¦åŠ è½½çš„ç»„ä»¶ã€‚ä¹‹åä½¿ç”¨ React.lazy å»å°†è¿™ä¸ªç»„ä»¶ç»™è¿›è¡Œæ³¨å†Œï¼Œä¹Ÿå°±æ˜¯ ContextDemo ã€‚æœ€åä½¿ç”¨ React.Suspense æ¥åŠ è½½ ContextDemo ã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†è¯¥å¼‚æ­¥ç»„ä»¶çš„åŠ è½½ã€‚

6ã€æ€§èƒ½ä¼˜åŒ–
ï¼ˆ1ï¼‰shouldComponentUpdateï¼ˆç®€ç§° SCUï¼‰
å…ˆæ¥çœ‹ä¸‹é¢è¿™ä¸€æ®µä»£ç ï¼š

shouldComponentUpdate(nextProps, nextState) {
if (nextState.count !== this.state.count
|| nextProps.text !== this.props.length) {
return true // å¯ä»¥æ¸²æŸ“
}
return false // ä¸é‡å¤æ¸²æŸ“
}
åœ¨ React ä¸­ï¼Œé»˜è®¤çš„æ˜¯ï¼Œå½“çˆ¶ç»„ä»¶æœ‰æ›´æ–°ï¼Œå­ç»„ä»¶ä¹Ÿæ— æ¡ä»¶æ›´æ–°ã€‚é‚£å¦‚æœæ¯å›éƒ½è§¦å‘æ›´æ–°ï¼Œè‚¯å®šä¸å¤ªå¥½ã€‚

å› æ­¤ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬éœ€è¦ç”¨åˆ° shouldComponentUpdate ï¼Œåˆ¤æ–­å½“å±æ€§æœ‰å‘ç”Ÿæ”¹å˜æ—¶ï¼Œå¯ä»¥è§¦å‘æ¸²æŸ“ã€‚å½“å±æ€§ä¸å‘ç”Ÿæ”¹å˜æ—¶ï¼Œä¹Ÿå°±æ˜¯å‰åä¸¤æ¬¡çš„å€¼ç›¸åŒæ—¶ï¼Œå°±ä¸è§¦å‘æ¸²æŸ“ã€‚

é‚£è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ éœ€è¦æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š SCU ä¸€å®šè¦æ¯æ¬¡éƒ½ç”¨å—ï¼Ÿç­”æ¡ˆå…¶å®ä¸æ˜¯è‚¯å®šçš„ã€‚

æˆ‘ä»¬ä¼šå»ç”¨ SCU ï¼Œä»æŸç§å±‚é¢ä¸Šæ¥è®²å°±æ˜¯ä¸ºäº†ä¼˜åŒ–ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ä¾æ®å½“å‰çš„å¼€å‘åœºæ™¯ï¼Œæœ‰éœ€è¦çš„æ—¶å€™å†å»ä¼˜åŒ–ã€‚

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ€»ç»“ä¸€ä¸‹ SCU çš„ä½¿ç”¨æ–¹å¼ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

SCU é»˜è®¤è¿”å› true ï¼Œå³ React é»˜è®¤é‡æ–°æ¸²æŸ“æ‰€æœ‰å­ç»„ä»¶ï¼›
å¿…é¡»é…åˆ â€œä¸å¯å˜å€¼â€ ä¸€èµ·ä½¿ç”¨ï¼›
å¯å…ˆä¸ç”¨ SCU ï¼Œæœ‰æ€§èƒ½é—®é¢˜æ—¶å†è€ƒè™‘ä½¿ç”¨ã€‚
ï¼ˆ2ï¼‰PureComponent å’Œ React.memo
PureComponent åœ¨ react ä¸­çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š

class List extends React.PureComponent {
constructor(props) {
super(props)
}
render() {
const { list } = this.props

        return <ul>{list.map((item, index) => {
            return <li key={item.id}>
                <span>{item.title}</span>
            </li>
        })}</ul>
    }
    shouldComponentUpdate() {/*æµ…æ¯”è¾ƒ*/}

}
å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº† PureComponent ï¼Œé‚£ä¹ˆ SCU ä¼šè¿›è¡Œæµ…å±‚æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯ä¸€å±‚ä¸€å±‚çš„æ¯”è¾ƒä¸‹å»ã€‚

ä¸‹é¢æˆ‘ä»¬æ¥çœ‹ memo ã€‚ memo ï¼Œé¡¾åæ€ä¹‰æ˜¯å¤‡å¿˜å½•çš„æ„æ€ã€‚åœ¨ React ä¸­çš„ä½¿ç”¨å½¢å¼å¦‚ä¸‹ï¼š

function MyComponent(props) {
/_ ä½¿ç”¨ props æ¸²æŸ“ _/
}

function areEqual(prevProps, nextProps) {
/_
å¦‚æœæŠŠ nextProps ä¼ å…¥ render æ–¹æ³•çš„è¿”å›ç»“æœ ä¸
preProps ä¼ å…¥ render æ–¹æ³•çš„è¿”å›ç»“æœ ä¸€è‡´çš„è¯ï¼Œåˆ™è¿”å› trueï¼Œ
å¦åˆ™è¿”å› false
_/
}
export default React.memo(MyComponent, areEqual);
memo ï¼Œå¯ä»¥è¯´æ˜¯å‡½æ•°ç»„ä»¶ä¸­çš„ PureComponent ã€‚åŒæ—¶ï¼Œä½¿ç”¨ React.memo() çš„å½¢å¼ï¼Œå°†æˆ‘ä»¬çš„å‡½æ•°ç»„ä»¶å’Œ areEqual çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œæœ€åè¿”å›ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ React ä¸­ï¼Œæµ…æ¯”è¾ƒå·²ç»ä½¿ç”¨äºå¤§éƒ¨åˆ†æƒ…å†µï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°½é‡ä¸è¦åšæ·±åº¦æ¯”è¾ƒã€‚

ï¼ˆ3ï¼‰ä¸å¯å˜å€¼
åœ¨ React ä¸­ï¼Œç”¨äºåšä¸å¯å˜å€¼çš„æœ‰ä¸€ä¸ªåº“ï¼š Immutable.js ã€‚è¿™ä¸ªåº“æœ‰ä»¥ä¸‹å‡ å¤§ç‰¹ç‚¹ï¼š

å½»åº•æ‹¥æŠ±â€œä¸å¯å˜å€¼â€

åŸºäºå…±äº«æ•°æ®ï¼ˆä¸æ˜¯æ·±æ‹·è´ï¼‰ï¼Œé€Ÿåº¦å¥½

æœ‰ä¸€å®šçš„å­¦ä¹ å’Œè¿ç§»æˆæœ¬ï¼ŒæŒ‰éœ€ä½¿ç”¨

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä½¿ç”¨ä¾‹å­ï¼š

const map1 = Immutable.Map({ a: 1, b: 2, c: 3 })
const map2 = map1.set('b', 50)
map1.get('b') // 2
map2.get('b') // 50
åŸºæœ¬ä¸Šç°åœ¨åœ¨å¼€å‘ä¸­éƒ½ç”¨è¿™ä¸ªåº“æ¥å¤„ç†ä¸å¯å˜å€¼çš„é—®é¢˜ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå¯ä»¥çœ‹å®˜æ–¹æ–‡æ¡£æŒ‰éœ€ä½¿ç”¨å³å¯ã€‚

7ã€å…³äºç»„ä»¶å…¬å…±é€»è¾‘çš„æŠ½ç¦»
åœ¨ React ä¸­ï¼Œå¯¹äºç»„ä»¶å…¬å…±é€»è¾‘çš„æŠ½ç¦»ä¸»è¦æœ‰ä¸‰ç§æ–¹å¼è¦äº†è§£ã€‚å…·ä½“å¦‚ä¸‹ï¼š

mixin ï¼Œå·²è¢« React å¼ƒç”¨
é«˜é˜¶ç»„ä»¶ HOC
Render Props
ä¸‹é¢å°†è®²è§£é«˜é˜¶ç»„ä»¶ HOC å’Œ Render Props ã€‚

ï¼ˆ1ï¼‰é«˜é˜¶ç»„ä»¶ HOC
å…ˆçœ‹ä¸€æ®µä»£ç ï¼š

// é«˜é˜¶ç»„ä»¶ä¸æ˜¯ä¸€ç§åŠŸèƒ½ï¼Œè€Œæ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼
// 1.ä¼ å…¥ä¸€ä¸ªç»„ä»¶ Component
const HOCFactory = (Component) => {
class HOC extends React.Component {
// åœ¨æ­¤å®šä¹‰å¤šä¸ªç»„ä»¶çš„å…¬å…±é€»è¾‘
render() {
// 2.è¿”å›æ‹¼æ¥çš„ç»“æœ
return <Component {this.props} />
}
}
return HOC
}
const EnhancedComponent1 = HOCFactory(WrappedComponent1)
const EnhancedComponent2 = HOCFactory(WrappedComponent2)
é«˜é˜¶ç»„ä»¶ HOC æ˜¯ä¼ å…¥ä¸€ä¸ªç»„ä»¶ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„ç»„ä»¶ï¼Œè§ä¸Šæ–¹ä»£ç çš„ 1 å’Œ 2 ã€‚

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'

// é«˜é˜¶ç»„ä»¶
const withMouse = (Component) => {
class withMouseComponent extends React.Component {
constructor(props) {
super(props)
this.state = { x: 0, y: 0 }
}

        handleMouseMove = (event) => {
            this.setState({
                x: event.clientX,
                y: event.clientY
            })
        }

        render() {
            return (
                <div style={{ height: '500px' }} onMouseMove={this.handleMouseMove}>
                    {/* 1. é€ä¼ æ‰€æœ‰ props 2. å¢åŠ  mouse å±æ€§ */}
                    <Component {...this.props} mouse={this.state}/>
                </div>
            )
        }
    }
    return withMouseComponent

}

const App = (props) => {
const { x, y } = props.mouse // æ¥æ”¶ mouse å±æ€§
return (
<div style={{ height: '500px' }}>
<h1>The mouse position is ({x}, {y})</h1>
</div>
)
}

export default withMouse(App) // è¿”å›é«˜é˜¶å‡½æ•°

æ­¤æ—¶æµè§ˆå™¨çš„æ˜¾ç¤ºç»“æœä¸ºï¼š

é«˜é˜¶ç»„ä»¶ HOC

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬ç”¨ å®šä¹‰äº†é«˜é˜¶ç»„ä»¶ withMouse ï¼Œä¹‹åå®ƒé€šè¿‡ <Component {...this.props} mouse={this.state}/> è¿™ç§å½¢å¼ï¼Œå°†å‚æ•° props å’Œ props çš„ mouse å±æ€§ç»™é€ä¼ å‡ºæ¥ï¼Œä¾›å­ç»„ä»¶ App ä½¿ç”¨ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ react ä¸­ï¼Œè¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„é«˜é˜¶ç»„ä»¶æ˜¯ redux connect ã€‚ç”¨ä¸€æ®µä»£ç æ¥æ¼”ç¤ºï¼š

import { connect } from 'react-redux';

// connect æ˜¯é«˜é˜¶ç»„ä»¶
const VisibleTodoList = connect(
mapStateToProps,
mapDispatchToProps
)(TodoList)

export default VisibleTodoList

ç°åœ¨ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹ connect çš„æºç ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

export const connect =(mapStateToProps, mapDispatchToProps) => (WrappedComponent) => {
class Connect extends Component {
constructor() {
super()
this.state = {
allProps: {}
}
}
/_ ä¸­é—´çœç•¥ N è¡Œä»£ç  _/
render () {
return <WrappedComponent {...this.state.allProps} />
}
}
return Connect
}
å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œ Connect ä¹Ÿæ˜¯åŒæ ·åœ°ï¼Œä¼ å…¥ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶è¿”å›ä¸€ä¸ªç»„ä»¶ã€‚

ï¼ˆ2ï¼‰Render Props
å…ˆæ¥çœ‹ä¸€æ®µä»£ç ï¼š

// Render Props çš„æ ¸å¿ƒæ€æƒ³
// 1.é€šè¿‡ä¸€ä¸ªå‡½æ•°ï¼Œå°† class ç»„ä»¶çš„ state ä½œä¸º propsï¼Œä¼ é€’ç»™çº¯å‡½æ•°ç»„ä»¶
class Factory extends React.Component {
constructor() {
tihs.state = {
/_ state å³å¤šä¸ªç»„ä»¶çš„å…¬å…±é€»è¾‘çš„æ•°æ® _/
}
}
/_ 2.ä¿®æ”¹ state _/
render() {
return <div>{this.props.render(this.state)}</div>
}
}

const App = () => {
// 3.åœ¨è¿™é‡Œä½¿ç”¨é«˜é˜¶ç»„ä»¶ï¼ŒåŒæ—¶å°†é«˜é˜¶ç»„ä»¶ä¸­çš„ render å±æ€§ä¼ é€’è¿›æ¥
<Factory render={
/_ render æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ _/
(props) => <p>{props.a}{props.b} â€¦</p>
} />
}

export default App;
åœ¨ä¸Šé¢çš„é«˜é˜¶ç»„ä»¶ HOC ä¸­ï¼Œæœ€ç»ˆè¿”å›çš„ç»“æœä¹Ÿæ˜¯ä¸€ä¸ªé«˜é˜¶ç»„ä»¶ã€‚ä½†åœ¨ Render Props ä¸­ï¼Œæˆ‘ä»¬æŠŠ Factory åŒ…è£¹åœ¨å®šä¹‰çš„ App ç»„ä»¶ä¸­ï¼Œæœ€ç»ˆå†æŠŠ App è¿”å›ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Vue ä¸­æœ‰ç±»ä¼¼äºé«˜é˜¶ç»„ä»¶çš„ç”¨æ³•ï¼Œä½†æ²¡æœ‰åƒ Render Props ç±»ä¼¼çš„ç”¨æ³•ï¼Œè¿™ä¸€ç‚¹éœ€è¦ç¨å¾®ç•™æ„ä¸€ä¸‹ã€‚

ä¸‹é¢æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'
import PropTypes from 'prop-types'

class Mouse extends React.Component {
constructor(props) {
super(props)
this.state = { x: 0, y: 0 }
}

    handleMouseMove = (event) => {
      this.setState({
        x: event.clientX,
        y: event.clientY
      })
    }

    render() {
      return (
        <div style={{ height: '500px' }} onMouseMove={this.handleMouseMove}>
            {/* å°†å½“å‰ state ä½œä¸º props ï¼Œä¼ é€’ç»™ render ï¼ˆrender æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ï¼‰ */}
            {this.props.render(this.state)}
        </div>
      )
    }

}
Mouse.propTypes = {
render: PropTypes.func.isRequired // å¿…é¡»æ¥æ”¶ä¸€ä¸ª render å±æ€§ï¼Œè€Œä¸”æ˜¯å‡½æ•°
}

const App = (props) => (
<div style={{ height: '500px' }}>
<Mouse render={
/_ render æ˜¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶ _/
({ x, y }) => <h1>The mouse position is ({x}, {y})</h1>
}/>

    </div>

)

/\*\*

- å³ï¼Œå®šä¹‰äº† Mouse ç»„ä»¶ï¼Œåªæœ‰è·å– x y çš„èƒ½åŠ›ã€‚
- è‡³äº Mouse ç»„ä»¶å¦‚ä½•æ¸²æŸ“ï¼ŒApp è¯´äº†ç®—ï¼Œé€šè¿‡ render prop çš„æ–¹å¼å‘Šè¯‰ Mouse ã€‚
  \*/

export default App

æ­¤æ—¶ï¼Œæµè§ˆå™¨çš„æ˜¾ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š

Render Props

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡ this.props.render(this.state) è¿™ç§å½¢å¼ï¼Œå°† Mouse ç»„ä»¶ä¸­çš„å±æ€§ä¼ é€’ç»™ App ï¼Œå¹¶è®© App æˆåŠŸä½¿ç”¨åˆ° Mouse çš„å±æ€§å€¼ã€‚

ï¼ˆ3ï¼‰HOC vs Render Props
ç°åœ¨ï¼Œæˆ‘ä»¬æ¥æ¢³ç†ä¸‹ HOC å’Œ Render Props çš„åŒºåˆ«ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

HOCï¼šæ¨¡å¼ç®€å•ï¼Œä½†ä¼šå¢åŠ ç»„ä»¶å±‚çº§
Render Propsï¼šä»£ç ç®€æ´ï¼Œå­¦ä¹ æˆæœ¬è¾ƒé«˜
å„æœ‰å„çš„ä¼˜ç¼ºç‚¹ï¼Œæ ¹æ®å®é™…åœºæ™¯æŒ‰éœ€ä½¿ç”¨å³å¯
ğŸ“š ä¸‰ã€Redux å’Œ React-router
1ã€Redux
ï¼ˆ1ï¼‰Redux æ¦‚å¿µç®€è¿°
å¯¹äº react æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªéè§†å›¾å±‚çš„è½»é‡çº§æ¡†æ¶ï¼Œå¦‚æœè¦ç”¨å®ƒæ¥ä¼ é€’æ•°æ®çš„è¯ï¼Œåˆ™è¦å…ˆçˆ¶ä¼ å­ï¼Œç„¶åå†æ…¢æ…¢åœ°ä¸€å±‚ä¸€å±‚å¾€ä¸Šä¼ é€’ã€‚

ä½†å¦‚æœç”¨ redux çš„è¯ï¼Œå‡è®¾æˆ‘ä»¬æƒ³è¦æŸä¸ªç»„ä»¶çš„æ•°æ®ï¼Œé‚£è¿™ä¸ªç»„ä»¶çš„æ•°æ®åˆ™ä¼šé€šè¿‡ redux æ¥å­˜æ”¾åˆ° store ä¸­è¿›è¡Œç®¡ç†ã€‚ä¹‹åå‘¢ï¼Œé€šè¿‡ store ï¼Œå†æ¥å°†æ•°æ®ä¸€æ­¥æ­¥åœ°å¾€ä¸‹é¢çš„ç»„ä»¶è¿›è¡Œä¼ é€’ã€‚

å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è§† Redux ä¸º Reducer å’Œ Flux çš„ç»“åˆã€‚

ï¼ˆ2ï¼‰Redux çš„å·¥ä½œæµç¨‹
Redux ï¼Œå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°æ®å±‚çš„æ¡†æ¶ï¼Œå®ƒæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½æ”¾åœ¨äº† store ä¹‹ä¸­ã€‚æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€å¼ å›¾ï¼š

Redux çš„å·¥ä½œæµç¨‹

å¤§å®¶å¯ä»¥çœ‹åˆ°ä¸­é—´çš„ store ï¼Œå®ƒé‡Œé¢å°±å­˜æ”¾ç€æ‰€æœ‰çš„æ•°æ®ã€‚ç»§ç»­çœ‹ store å‘ä¸‹çš„ç®­å¤´ï¼Œç„¶åå‘¢ï¼Œæ¯ä¸ªç»„ä»¶éƒ½è¦å‘ store é‡Œé¢å»æ‹¿æ•°æ®ã€‚

æˆ‘ä»¬ç”¨ä¸€ä¸ªä¾‹å­æ¥æ¢³ç†æ•´å¼ å›¾ï¼Œå…·ä½“å¦‚ä¸‹ï¼š

â‘  æ•´å¼ å›¾ä¸Šæœ‰ä¸€ä¸ª store ï¼Œå®ƒå­˜æ”¾ç€æ‰€æœ‰çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯å­˜å‚¨æ•°æ®çš„å…¬å…±åŒºåŸŸï¼›
â‘¡ æ¯ä¸ªç»„ä»¶ï¼Œéƒ½è¦ä» store é‡Œé¢æ‹¿æ•°æ®ï¼›
â‘¢ å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªåœºæ™¯ï¼Œæ¨¡æ‹Ÿæˆ‘ä»¬è¦åœ¨å›¾ä¹¦é¦†é‡Œé¢å€Ÿä¹¦ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠ react Component ç†è§£ä¸ºå€Ÿä¹¦äººï¼Œä¹‹åå‘¢ï¼Œå€Ÿä¹¦äººè¦å»æ‰¾å›¾ä¹¦é¦†ç®¡ç†å‘˜æ‰èƒ½å€Ÿåˆ°è¿™æœ¬ä¹¦ã€‚è€Œå€Ÿä¹¦è¿™ä¸ªè¿‡ç¨‹ä¸­æ•°æ®çš„ä¼ é€’ï¼Œå°±å¯ä»¥æŠŠå®ƒè§†ä¸ºæ˜¯ Action Creators ï¼Œå¯ä»¥ç†è§£ä¸º â€œä½ æƒ³è¦å€Ÿä»€ä¹ˆä¹¦â€ è¿™å¥è¯ã€‚
â‘£ Action Creatures å»åˆ° store ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æŠŠ store å½“åšæ˜¯å›¾ä¹¦é¦†ç®¡ç†å‘˜ï¼Œä½†æ˜¯ï¼Œå›¾ä¹¦é¦†ç®¡ç†å‘˜æ˜¯æ²¡æœ‰åŠæ³•è®°ä½æ‰€æœ‰å›¾ä¹¦çš„æ•°æ®æƒ…å†µçš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå®ƒéƒ½éœ€è¦ä¸€ä¸ªè®°å½•æœ¬ï¼Œä½ æƒ³è¦å€Ÿä»€ä¹ˆæ ·çš„ä¹¦ï¼Œé‚£ä¹ˆå¥¹å°±å…ˆæŸ¥ä¸€ä¸‹ï¼›åˆæˆ–è€…ä½ æƒ³è¦è¿˜ä»€ä¹ˆä¹¦ï¼Œå¥¹ä¹Ÿè¦æŸ¥ä¸€ä¸‹ï¼Œéœ€è¦æ”¾å›ä»€ä¹ˆä½ç½®ä¸Šã€‚
â‘¤ è¿™ä¸ªæ—¶å€™å°±éœ€è¦è·Ÿ reducers å»é€šä¿¡ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ reducers è§†ä¸ºæ˜¯ä¸€ä¸ªè®°å½•æœ¬ï¼Œå›¾ä¹¦é¦†ç®¡ç†å‘˜ç”¨è¿™ä¸ªè®°å½•æœ¬æ¥è®°å½•éœ€è¦çš„æ•°æ®ã€‚ç®¡ç†å‘˜ store é€šè¿‡ reducer çŸ¥é“äº†åº”è¯¥ç»™å€Ÿä¹¦äºº Components ä»€ä¹ˆæ ·çš„æ•°æ®ã€‚
ï¼ˆ2ï¼‰react-redux
React-redux ä¸­è¦äº†è§£çš„å‡ ä¸ªç‚¹æ˜¯ Provider ã€ Connect ã€ mapStateToProps å’Œ mapDisptchToProps ã€‚

æ¥çœ‹ä»¥ä¸‹ä»£ç ï¼š

import React from 'react'
import { Provider } from 'react-redux'
import { createStore } from 'redux'
import todoApp from './reducers'
import App from './components/App'

let store = createStore(todoApp)

export default function() {
return <Provider store={store}>
<App />
</Provider>
}
react-redux æä¾›äº† Provider çš„èƒ½åŠ›ï¼Œå¤§å®¶å¯ä»¥çœ‹åˆ°æœ€åéƒ¨åˆ†çš„ä»£ç ï¼Œ Provider å°† <App /> åŒ…è£¹èµ·æ¥ï¼Œå…¶å®ä¹Ÿå°±æ˜¯è¯´ä¸ºå®ƒåŒ…è£¹çš„æ‰€æœ‰ç»„ä»¶æä¾› store èƒ½åŠ›ï¼Œè¿™ä¹Ÿæ˜¯ Provider å‘æŒ¥çš„ä½œç”¨ã€‚

å†æ¥çœ‹ä¸€æ®µä»£ç ï¼š

import { connect } from 'react-redux'
import { toggleTodo } from '../actions'
import TodoList from '../components/TodoList'

// ä¸åŒç±»å‹çš„ todo åˆ—è¡¨
const getVisibleTodos = (todos, filter) => {
switch (filter) {
case 'SHOW_ALL':
return todos
case 'SHOW_COMPLETED':
return todos.filter(t => t.completed)
case 'SHOW_ACTIVE':
return todos.filter(t => !t.completed)
}
}

const mapStateToProps = state => {
// state å³ vuex çš„æ€»çŠ¶æ€ï¼Œåœ¨ reducer/index.js ä¸­å®šä¹‰
return {
// æ ¹æ®å®ŒæˆçŠ¶æ€ï¼Œç­›é€‰æ•°æ®
todos: getVisibleTodos(state.todos, state.visibilityFilter)
}
}

const mapDispatchToProps = dispatch => {
return {
// åˆ‡æ¢å®ŒæˆçŠ¶æ€
onTodoClick: id => {
dispatch(toggleTodo(id))
}
}
}

// connect é«˜é˜¶ç»„ä»¶ï¼Œå°† state å’Œ dispatch æ³¨å…¥åˆ°ç»„ä»¶ props ä¸­
const VisibleTodoList = connect(
mapStateToProps,
mapDispatchToProps
)(TodoList)

export default VisibleTodoList
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ connect å°† state å’Œ dispatch ç»™æ³¨å…¥åˆ°ç»„ä»¶çš„ props ä¸­ï¼Œå°†å±æ€§ä¼ é€’ç»™åˆ° TodoList ç»„ä»¶ã€‚

ï¼ˆ3ï¼‰å¼‚æ­¥ action
redux ä¸­çš„åŒæ­¥ action å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

// åŒæ­¥ action
export const addTodo = text => {
// è¿”å› action å¯¹è±¡
return {
type: 'ADD_TODO',
id: nextTodoId++,
text
}
}
redux ä¸­çš„å¼‚æ­¥ action å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

// å¼‚æ­¥ action
export const addTodoAsync = text => {
// è¿”å›å‡½æ•°ï¼Œå…¶ä¸­æœ‰ dispatch å‚æ•°
return (dispatch) => {
// ajax å¼‚æ­¥è·å–æ•°æ®
fetch(url).thne(res => {
// æ‰§è¡Œå¼‚æ­¥ action
dispatch(addTodo(res.text))
})
}
}
ï¼ˆ4ï¼‰Redux æ•°æ®æµå›¾
Redux çš„å•é¡¹æ•°æ®æµå›¾å¦‚ä¸‹æ‰€ç¤ºï¼š

åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°

å…³äº Redux æ›´è¯¦ç»†å†…å®¹ï¼Œå¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šRedux ä»å…¥é—¨åˆ°è¿›é˜¶ï¼Œçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†ï¼

2ã€React-router
ï¼ˆ1ï¼‰è·¯ç”±æ¨¡å¼
React-router å’Œ vue-router ä¸€æ ·ï¼Œéƒ½æ˜¯ä¸¤ç§æ¨¡å¼ã€‚å…·ä½“å¦‚ä¸‹ï¼š

hash æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰ï¼Œå¦‚ http://abc.com/#/user/10
H5 history æ¨¡å¼ï¼Œå¦‚ http://abc.com/user/20
åè€…éœ€è¦ server ç«¯æ”¯æŒï¼Œå› æ­¤æ— ç‰¹æ®Šéœ€æ±‚å¯é€‰æ‹©å‰è€…
hash æ¨¡å¼çš„è·¯ç”±é…ç½®å¦‚ä¸‹ä»£ç æ‰€ç¤ºï¼š

import React from 'react'
import {
HashRouter as Router,
Switch,
Route
} from 'react-router-dom'

function RouterComponent() {
return(
<Router>
<Switch>
<Route exact path="/">
<Home />
</Route>
<Route exact path="/project/:id">
<Project />
</Route>
<Route path="*">
<NotFound />
</Route>
</Switch>
</Router>
)
}
History æ¨¡å¼çš„è·¯ç”±é…ç½®å¦‚ä¸‹ï¼š

import React from 'react'
import {
BrowserRouter as Router,
Switch,
Route
} from 'react-router-dom'

function RouterComponent() {
return(
<Router>
<Switch>
<Route exact path="/">
<Home />
</Route>
<Route exact path="/project/:id">
<Project />
</Route>
<Route path="*">
<NotFound />
</Route>
</Switch>
</Router>
)
}
æ³¨æ„ï¼Œhash å’Œ history çš„åŒºåˆ«åœ¨äº import ä¸­çš„ HashRouter å’Œ BrowserRouter ã€‚

å…³äº hash å’Œ history ç›¸å…³çš„å†…å®¹ï¼Œè¿›ä¸€æ­¥äº†è§£å¯æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ï¼šæµ…è°ˆå‰ç«¯è·¯ç”±åŸç† hash å’Œ history

ï¼ˆ2ï¼‰è·¯ç”±é…ç½®
â… . åŠ¨æ€è·¯ç”±
å‡è®¾ç°åœ¨æœ‰çˆ¶ç»„ä»¶ RouterComponent ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ï¼š

function RouterComponent() {
return(
<Router>
<Switch>
<Route exact path="/">
<Home />
</Route>
<Route exact path="/project/:id">
<Project />
</Route>
<Route path="*">
<NotFound />
</Route>
</Switch>
</Router>
)
}
å…¶ä¸­ï¼Œåœ¨è¿™ä¸ªç»„ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ª Project ç»„ä»¶ï¼Œéœ€è¦è¿›è¡ŒåŠ¨æ€ä¼ å‚ã€‚

ç»§ç»­ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹å­ç»„ä»¶ Project ç»„ä»¶æ—¶å¦‚ä½•è¿›è¡ŒåŠ¨æ€ä¼ å‚çš„ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

import React from 'react'
import { Link, useParams } from 'react-router-dom'

function Project() {
// è·å– url å‚æ•°ï¼Œå¦‚ '/project/100'
const { id } = useParams()
console.log('url param id', id)

    return (
    	<div>
        	<Link to="/">é¦–é¡µ</Link>
        </div>
    )

}
å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ React ä¸­ï¼Œé€šè¿‡ const { id } = useParams() è¿™æ ·çš„å½¢å¼ï¼Œæ¥è¿›è¡ŒåŠ¨æ€ä¼ å‚ã€‚

è¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µæ˜¯è·³è½¬è·¯ç”±ã€‚è¯·çœ‹ä»¥ä¸‹ä»£ç ï¼š

import React from 'react'
import { useHistory } from 'react-router-dom'

function Trash() {
let history = useHistory()
function handleClick() {
history.push('/')
}
return (
<div>
<Button type="primary" onClick={handleClick}>å›åˆ°é¦–é¡µ</Button>
</div>
)
}
å¤§å®¶å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡ä½¿ç”¨ useHistory ï¼Œè®©ç‚¹å‡»äº‹ä»¶è·³è½¬åˆ°é¦–é¡µä¸­ã€‚

â…¡. æ‡’åŠ è½½
import { BrowserRouter as Router, Route, Switch } from 'react-router-dom';
import React, { Suspence, lazy } from 'react';

const Home = lazy(() => import('./routes/Home'));
const About lazy(() => import('./routes/About'));

const App = () => {
<Router>
<Suspense fallback={<div>Loadingâ€¦â€¦</div>}>
<Switch>
<Route exact path="/" component={Home}/>
<Route path="/about" component={About}/>
</Switch>
</Suspense>  
 </Router>
}
åœ¨ React ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ lazy() åŒ…è£¹ï¼Œå¯¹é¡µé¢çš„å†…å®¹è¿›è¡Œæ‡’åŠ è½½ã€‚å½“ç„¶ï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æƒ…å†µæ˜¯ï¼ŒåŠ è½½ç±»ä¼¼äºé¦–é¡µåˆæ¬¡åŠ è½½é¡µé¢ Loading çš„é‚£ç§æ•ˆæœï¼Œåœ¨ react ä¸­å¯ä»¥ä½¿ç”¨ <Suspense> æ¥è§£å†³ã€‚

ğŸ—ï¸ å››ã€ç»“æŸè¯­
åœ¨ä¸Šé¢çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®²è§£äº† react çš„åŸºæœ¬ä½¿ç”¨ä»¥åŠé«˜çº§ç‰¹æ€§ã€‚åŒæ—¶ï¼Œè¿˜è®²è§£äº† react çš„å‘¨è¾¹æ’ä»¶ï¼Œ Redux å’Œ React-router ã€‚

å‰ç«¯åœ¨åš react çš„é¡¹ç›®æ—¶ï¼Œæ€»æ˜¯è„±ç¦»ä¸å¼€ä»¥ä¸Šæ–‡ç« æ‰€æ¶‰åŠåˆ°çš„çŸ¥è¯†ç‚¹ï¼Œå”¯ä¸€çš„åŒºåˆ«åœ¨äºåŸºæœ¬ä½¿ç”¨çš„å†…å®¹ç”¨çš„è¾ƒå¤šï¼Œè€Œé«˜çº§ç‰¹æ€§çš„ä½¿ç”¨åœºæ™¯ç›¸å¯¹ä¼šå°‘ä¸€äº›ã€‚

å¸Œæœ›é€šè¿‡ä¸Šæ–‡çš„è®²è§£ï¼Œå°ä¼™ä¼´ä»¬æœ‰æ‰€æ”¶è· ğŸ¥‚

å…³æ³¨å…¬ä¼—å· æ˜ŸæœŸä¸€ç ”ç©¶å®¤ ï¼Œç¬¬ä¸€æ—¶é—´å…³æ³¨å­¦ä¹ å¹²è´§ï¼Œæ›´å¤š ã€Œoffer æ¥äº†ã€ é¢è¯•ä¸“æ å¾…ä½ è§£é”~
å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨ï¼Œè®°å¾—ç•™ä¸ªè„šå° jio å†èµ°å“Ÿ~
æˆ‘ä»¬ä¸‹æœŸè§ï¼ğŸ”‘ğŸ”‘ğŸ”‘
å‘æ–‡åŠ©æ‰‹
å‘æ–‡åŠ©æ‰‹ä¼šå¯¹æ ‡é¢˜æå‡ºä¼˜åŒ–å»ºè®®ï¼Œé¿å…å‡ºç°ä¸æ°å½“æ–‡å­—ä»è€Œå½±å“æ–‡ç« æ¨èã€‚ã€æ ‡é¢˜è§„èŒƒã€‘
Markdown 38054 å­—æ•° 2453 è¡Œæ•° å½“å‰è¡Œ 1, å½“å‰åˆ— 0HTML 33375 å­—æ•° 1663 æ®µè½è¯»å®Œè¶…è¿‡ 1 ä¸ªå°æ—¶ï¼Œå»ºè®®ä¼˜åŒ–æ–‡ç« 
æ–°å¢æŠ•ç¥¨åŠŸèƒ½
